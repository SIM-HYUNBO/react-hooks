SQL_NAME,SQL_SEQ,SQL_CONTENT
sqlserver_delete_TB_RMS_EQP_REQ_DOWN_CUST_INFO,1,"<![CDATA[
	
		DELETE RMSPLUS.TB_RMS_EQP_REQ_DOWN_CUST_INFO
		 WHERE TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND EQUIPMENT_ID=#{equipmentId}

]]>"
sqlserver_delete_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,1,"<![CDATA[

	
		DELETE RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO 
		 WHERE FUNCTION_NAME = #{functionName}
		   AND TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	
	
]]>"
sqlserver_delete_TB_RMS_EQP_REQ_PARAM_INFO,1,"<![CDATA[

	
		DELETE RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO 
		 WHERE FUNCTION_NAME = #{functionName}
		   AND TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	
	
]]>"
sqlserver_delete_TB_RMS_PURGE_TABLE_INFO,1,"<![CDATA[

	
		${sqlStmt}
	
	
]]>"
sqlserver_delete_TB_RMS_RCP_PARAM_UPLOAD_HIST,1,"<![CDATA[

	
		DELETE RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND EQUIPMENT_ID = #{equipmentId}
		   AND RECIPE_ID  = #{recipeId} 
	
	
]]>"
sqlserver_delete_TB_RMS_RCP_PARAM_UPLOAD_HIST,2,"<![CDATA[    

DELETE RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST  
 WHERE FACILITY_CODE = #{facilityCode}  
   AND UPLOAD_TYPE_CODE LIKE 'SV_COLLECT-%'   
   AND TRANSACTION_SERIAL_NO = #{transactionSerialNo}

]]>"
sqlserver_delete_TB_RMS_RECIPE_UPLOAD_HIST,1,"<![CDATA[

	
		DELETE RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND EQUIPMENT_ID = #{equipmentId}
		   AND UPLOAD_TYPE_CODE = #{uploadTypeCode}
		   AND RECIPE_ID  = #{recipeId} 
	
	
]]>"
sqlserver_delete_TB_RMS_RECIPE_UPLOAD_HIST,2,"<![CDATA[       
  
    DELETE RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST    
   WHERE FACILITY_CODE = #{facilityCode}
     AND UPLOAD_TYPE_CODE LIKE 'SV_COLLECT-%' 
     AND (
          TRANSACTION_SERIAL_NO = #{transactionSerialNo} 
          OR 
          (PROCESS_FLAG = 'P' AND TRANSACTION_DATE < DATEADD(MI,-10,GETDATE()))
         ) 

]]>
"
sqlserver_delete_TB_RMS_TEMP_SMS_USER,1,"<![CDATA[

	
		DELETE 
		  FROM RMSPLUS.TB_RMS_TEMP_SMS_USER
		 WHERE FUNCTION_NAME = #{functionName}
		   AND TRANSACTION_SERIAL_NO=#{transactionSerialNo}  
	
	
]]>"
sqlserver_insert_IFS_SMS_DATA_NJ,1,"<![CDATA[
  
    INSERT INTO RMSPLUS.IFS_SMS_DATA_NJ
     (IF_TYPE, IF_ID, INTIME, USERCODE, REQPHONE, 
      CALLNAME, CALLPHONE, SUBJECT, MSG)  
     SELECT 'I' AS IF_TYPE, 
            #{ifId} AS IF_ID, 
            CONVERT(VARCHAR(10), GETDATE(), 112) + REPLACE(CONVERT(VARCHAR(10), GETDATE(), 108), ':' ,'') AS INTIME
            'lgecom3' AS USERCODE, 
            #{sysPhoneNumber} AS REQPHONE, 
            UM.USER_NAME AS CALLNAME, 
            RMSPLUS.FN_GET_NUMBER(UM.MOBILE_PHONE_NO) AS CALLPHONE, 
            'RMS Mode Change' AS SUBJECT, 
            #{smsMsg} AS MSG
       FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE 
      INNER JOIN RMSPLUS.TB_RMS_MGR_GROUP_AUTH_INFO MP WITH(NOLOCK)
       ON (MP.MGR_GROUP_ID = VE.MGR_GROUP_ID)
      INNER JOIN RMSCMN.TB_EGN_USR_MST UM  WITH(NOLOCK)
       ON (MP.AUTHORITY_USER_ID = UM.USER_ID)
      WHERE VE.EQUIPMENT_ID = #{equipmentId}
      AND MP.MGR_AUTHORITY_CODE = 'ADM'
      AND UM.MOBILE_PHONE_NO IS NOT NULL
  
]]>"
sqlserver_insert_IFS_SMS_DATA_NJ,2,"<![CDATA[

    INSERT INTO RMSPLUS.IFS_SMS_DATA_NJ
     (IF_TYPE, IF_ID, INTIME, USERCODE, REQPHONE, 
      CALLNAME,  CALLPHONE, SUBJECT, MSG)  
     SELECT 'I' AS IF_TYPE, 
            #{ifId} AS IF_ID, 
            CONVERT(VARCHAR(10), GETDATE(), 112) + REPLACE(CONVERT(VARCHAR(10), GETDATE(), 108), ':' ,'') AS INTIME, 
            'lgecom3' AS USERCODE, 
            #{sysPhoneNumber} AS REQPHONE, 
            CCD.BUSINESS_USAGE_CODE_DESC AS CALLNAME, 
            RMSPLUS.FN_GET_NUMBER(US.PHONE_NO) AS CALLPHONE, 
            'RMS Disconnect' AS SUBJECT, 
            #{smsMsg} AS MSG
       FROM RMSPLUS.TB_RMS_CODE_ITEM_INFO CD WITH(NOLOCK) 
      INNER JOIN RMSCMN.TB_EGN_CODE_ITEM_INFO CCD WITH(NOLOCK)
       ON (CCD.FACILITY_CODE = CD.FACILITY_CODE 
      AND CCD.BUSINESS_USAGE_TYPE_CODE = CD.BUSINESS_USAGE_TYPE_CODE 
      AND CCD.BUSINESS_USAGE_CODE_ID = CD.BUSINESS_USAGE_CODE_ID) 
    INNER JOIN RMSCMN.TB_EGN_USR_MST US  WITH(NOLOCK)
       ON (US.USER_ID = CD.BUSINESS_USAGE_CODE_ID)
    WHERE CD.BUSINESS_USAGE_TYPE_CODE = 'SYS_ADMIN'
      AND CCD.USE_FLAG = 'Y'
      AND US.PHONE_NO IS NOT NULL

]]>"
sqlserver_insert_IFS_SMS_DATA_NJ,3,"<![CDATA[

    INSERT INTO RMSPLUS.IFS_SMS_DATA_NJ
      (IF_TYPE, IF_ID, INTIME, USERCODE, REQPHONE, 
       CALLNAME,  CALLPHONE, SUBJECT, MSG )  
     SELECT 'I' AS IF_TYPE, 
        #{ifId} AS IF_ID, 
        CONVERT(VARCHAR(10), GETDATE(), 112) + REPLACE(CONVERT(VARCHAR(10), GETDATE(), 108), ':' ,'') AS INTIME
        'lgecom3' AS USERCODE, 
        #{sysPhoneNumber} AS REQPHONE, 
        TSU.USER_NAME AS CALLNAME, 
        REPLACE(REPLACE(TSU.PHONE_NUMBER,'-',''),' ','') AS CALLPHONE, 
        'RMS NG ALARM' AS SUBJECT, 
        #{smsMsg} AS MSG
      FROM RMSPLUS.TB_RMS_TEMP_SMS_USER TSU WITH(NOLOCK)  
       WHERE FUNCTION_NAME = #{functionName}
         AND TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
         AND SMS_SEND_FLAG ='Y' 
         AND ALARM_TYPE_CODE IN ('SMS','ALL')
         AND ISNULL(PHONE_NUMBER,'') != ''  

]]>"
sqlserver_insert_SC_TRAN,1,"<![CDATA[

		INSERT INTO RMSPLUS.SC_TRAN
		 (TR_SENDDATE, TR_SENDSTAT, TR_MSGTYPE, TR_PHONE, TR_CALLBACK, TR_MSG, TR_ETC1, TR_ETC2)
		  SELECT #{transactionDate} AS TR_SENDDATE, 
                 '0' AS TR_SENDSTAT, 
                 '0' AS TR_MSGTYPE, 
                 RMSPLUS.FN_GET_NUMBER(UM.MOBILE_PHONE_NO) AS TR_PHONE, 
                 #{sysPhoneNumber} AS TR_CALLBACK, 
		         #{smsMsg} AS TR_MSG, 
                 'RMS Mode Change' AS TR_ETC1, 
                 UM.USER_NAME AS TR_ETC2
		    FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
		   INNER JOIN RMSPLUS.TB_RMS_MGR_GROUP_AUTH_INFO MP WITH(NOLOCK) 
			  ON (MP.MGR_GROUP_ID = VE.MGR_GROUP_ID)
		   INNER JOIN RMSCMN.TB_EGN_USR_MST UM WITH(NOLOCK) 
			  ON (MP.AUTHORITY_USER_ID = UM.USER_ID)
		   WHERE VE.EQUIPMENT_ID = #{equipmentId}
			 AND MP.MGR_AUTHORITY_CODE = 'ADM'
			 AND UM.MOBILE_PHONE_NO IS NOT NULL

]]>"
sqlserver_insert_SC_TRAN,2,"<![CDATA[

	
		INSERT INTO RMSPLUS.SC_TRAN
		 (TR_SENDDATE, TR_SENDSTAT, TR_MSGTYPE, TR_PHONE, TR_CALLBACK, 
		  TR_MSG, TR_ETC1, TR_ETC2)
		  SELECT #{transactionDate} AS TR_SENDDATE, '0' AS TR_SENDSTAT, '0' AS TR_MSGTYPE, RMSPLUS.FN_GET_NUMBER(US.PHONE_NO) AS TR_PHONE, #{sysPhoneNumber} AS TR_CALLBACK, 
			      #{smsMsg} AS TR_MSG, 'RMS Disconnect' AS TR_ETC1, CCD.BUSINESS_USAGE_CODE_DESC AS TR_ETC2
		    FROM RMSPLUS.TB_RMS_CODE_ITEM_INFO CD WITH(NOLOCK)
		   INNER JOIN RMSCMN.TB_EGN_CODE_ITEM_INFO CCD WITH(NOLOCK) 
			  ON (CCD.FACILITY_CODE = CD.FACILITY_CODE 
			      AND CCD.BUSINESS_USAGE_TYPE_CODE = CD.BUSINESS_USAGE_TYPE_CODE 
			      AND CCD.BUSINESS_USAGE_CODE_ID = CD.BUSINESS_USAGE_CODE_ID) 
		   INNER JOIN RMSCMN.TB_EGN_USR_MST US WITH(NOLOCK) 
			  ON (US.USER_ID = CD.BUSINESS_USAGE_CODE_ID)
		   WHERE CD.BUSINESS_USAGE_TYPE_CODE = 'SYS_ADMIN'
			 AND CCD.USE_FLAG = 'Y'
			 AND US.PHONE_NO IS NOT NULL
	
	
]]>"
sqlserver_insert_SC_TRAN,3,"<![CDATA[

		INSERT INTO RMSPLUS.SC_TRAN
		 (TR_SENDDATE, TR_ID, TR_SENDSTAT, TR_MSGTYPE, TR_PHONE, 
		  TR_CALLBACK, TR_MSG, TR_ETC1, TR_ETC2)
		  SELECT #{transactionDate} AS TR_SENDDATE, LEFT(#{validationSeqNo},16) AS TR_ID, '0' AS TR_SENDSTAT, '0' AS TR_MSGTYPE, REPLACE(REPLACE(TSU.PHONE_NUMBER,'-',''),' ','') AS TR_PHONE, 
		         #{sysPhoneNumber} AS TR_CALLBACK, #{smsMsg} AS TR_MSG, 'RMS NG ALARM' AS TR_ETC1, TSU.USER_NAME AS TR_ETC2
			FROM RMSPLUS.TB_RMS_TEMP_SMS_USER TSU WITH (NOLOCK)
		   WHERE TSU.FUNCTION_NAME = #{functionName}
		     AND TSU.TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
		   	 AND TSU.SMS_SEND_FLAG ='Y' 
			 AND TSU.ALARM_TYPE_CODE IN ('SMS','ALL')
			 AND ISNULL(TSU.PHONE_NUMBER,'') != ''
	
]]>"
sqlserver_insert_SC_TRAN_EXT,1,"<![CDATA[

  INSERT INTO RMSPLUS.SC_TRAN_EXT
   (TR_SENDDATE, TR_ID, TR_SENDSTAT, TR_MSGTYPE, TR_PHONE, 
    TR_CALLBACK, TR_MSG, TR_ETC1, TR_ETC2)
  SELECT #{transactionDate} AS TR_SENDDATE, #{validationSeqNo} AS TR_ID, '0' AS TR_SENDSTAT, '0' AS TR_MSGTYPE, REPLACE(REPLACE(TSU.PHONE_NUMBER,'-',''),' ','') AS TR_PHONE, 
            #{sysPhoneNumber} AS TR_CALLBACK, #{smsMsg} AS TR_MSG, 'RMS NG ALARM' AS TR_ETC1, TSU.USER_NAME AS TR_ETC2
   FROM RMSPLUS.TB_RMS_TEMP_SMS_USER TSU WITH(NOLOCK)  
  WHERE TSU.FUNCTION_NAME = #{functionName}
     AND TSU.TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
     AND TSU.SMS_SEND_FLAG ='Y' 
     AND TSU.ALARM_TYPE_CODE IN ('SMS','ALL')
     AND ISNULL(TSU.PHONE_NUMBER,'') != ''

]]>"
sqlserver_insert_TB_EGN_USER_QUERY_INFO,1,"<![CDATA[
	
	INSERT INTO RMSCMN.TB_EGN_USER_QUERY_INFO
	 (SQL_NAME, SQL_SEQ, SQL_CONTENT, CREATE_USER_ID, CREATE_DATE) 
        VALUES
         (#{sqlName}, #{sqlSeq}, #{sqlContent}, 'system', GETDATE())
	
]]>"
sqlserver_insert_TB_IF_SMS,1,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_IF_SMS
		 (SMS_TYPE, REQ_TIME, REQ_NAME, REQ_PHONE, CALL_NAME, 
		  CALL_PHONE, COUNTRY, SUBJECT, MSG, KIND)
		  SELECT 'RMS',
		         '00000000000000', 
		         'system', 
		         #{sysPhoneNumber}, 
		         UM.USER_NAME, 
		         RMSPLUS.FN_GET_NUMBER(UM.MOBILE_PHONE_NO) AS PHONE_NUMBER, '86','RMS Mode Change', #{smsMsg}, 'I'
		    FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
		   INNER JOIN RMSPLUS.TB_RMS_MGR_GROUP_AUTH_INFO MP WITH(NOLOCK) 
			  ON (MP.MGR_GROUP_ID = VE.MGR_GROUP_ID)
		   INNER JOIN RMSCMN.TB_EGN_USR_MST UM WITH(NOLOCK) 
			  ON (MP.AUTHORITY_USER_ID = UM.USER_ID)
		   WHERE VE.EQUIPMENT_ID = #{equipmentId}
			 AND MP.MGR_AUTHORITY_CODE = 'ADM'
			 AND UM.MOBILE_PHONE_NO IS NOT NULL
	
	
]]>"
sqlserver_insert_TB_IF_SMS,2,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_IF_SMS
		 (SMS_TYPE, REQ_TIME, REQ_NAME, REQ_PHONE, CALL_NAME, 
		  CALL_PHONE, COUNTRY, SUBJECT, MSG, KIND)
		  SELECT 'RMS','00000000000000', 'system', #{sysPhoneNumber}, CD.CODE_NAME, 
		         RMSPLUS.FN_GET_NUMBER(US.PHONE_NUMBER) AS PHONE_NUMBER, '86', 'RMS Disconnect', #{smsMsg} , 'I'
		    FROM RMSPLUS.TB_RMS_CODE_ITEM_INFO CD WITH(NOLOCK) 
		   INNER JOIN RMSCMN.TB_EGN_CODE_ITEM_INFO CCD WITH(NOLOCK) 
			  ON (CCD.FACILITY_CODE = CD.FACILITY_CODE 
		     AND CCD.BUSINESS_USAGE_TYPE_CODE = CD.BUSINESS_USAGE_TYPE_CODE 
		     AND CCD.BUSINESS_USAGE_CODE_ID = CD.BUSINESS_USAGE_CODE_ID)
		   INNER JOIN RMSCMN.TB_EGN_USR_MST US WITH(NOLOCK) 
			  ON (US.SSOID = CD.BUSINESS_USAGE_CODE_ID)
		   WHERE CD.BUSINESS_USAGE_TYPE_CODE = 'SYS_ADMIN'
			 AND CCD.USE_FLAG = 'Y'
			 AND US.PHONE_NUMBER IS NOT NULL
	
	
]]>"
sqlserver_insert_TB_IF_SMS,3,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_IF_SMS
		 (SMS_TYPE, REQ_TIME, REQ_NAME, REQ_PHONE, CALL_NAME, 
		  CALL_PHONE, COUNTRY, SUBJECT, MSG, KIND)
		  SELECT 'RMS','00000000000000', 'system', #{sysPhoneNumber}, TSU.USER_NAME, 
		         REPLACE(REPLACE(TSU.PHONE_NUMBER,'-',''),' ','') AS PHONE_NUMBER, '86','RMS NG ALARM', #{smsMsg}, 'I'
		    FROM RMSPLUS.TB_RMS_TEMP_SMS_USER TSU WITH(NOLOCK) 
		   WHERE FUNCTION_NAME = #{functionName}
		     AND TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
		     AND SMS_SEND_FLAG ='Y' 
		     AND ALARM_TYPE_CODE IN ('SMS','ALL')
		     AND ISNULL(PHONE_NUMBER,'') != ''
	
	
]]>"
sqlserver_insert_TB_RMS_EQP_REQ_DOWN_CUST_INFO,1,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_RMS_EQP_REQ_DOWN_CUST_INFO 
		 (TRANSACTION_SERIAL_NO, EQUIPMENT_ID, ATTRIBUTE_VALUE_1, ATTRIBUTE_VALUE_2, ATTRIBUTE_VALUE_3, 
		 ATTRIBUTE_VALUE_4, ATTRIBUTE_VALUE_5) 
		VALUES
		 (#{transactionSerialNo}, #{equipmentId}, #{custValue1}, #{custValue2}, #{custValue3}, 
		 #{custValue4}, #{custValue5})
	
	
]]>"
sqlserver_insert_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,1,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO 
		 (FUNCTION_NAME, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, PARAMETER_ID, EQUIPMENT_PARAMETER_ID, 
		  SPEC_TYPE_CODE, GRADE_CODE, EQUIPMENT_VALUE, PARAMETER_FLAG, USE_FLAG, 
		  DOWNLOAD_FLAG, RMS_USE_FLAG, LAST_VALUE_NO_APPLY_FLAG) 
		VALUES
		 (#{functionName}, #{transactionSerialNo}, #{equipmentId}, #{parameterId}, #{equipmentParameterId}, 
		  #{specTypeCode}, #{gradeCode}, #{eqpValue}, #{parameterFlag}, #{useFlag}, 
		  #{downloadFlag}, #{rmsOnFlag}, #{lastsvNoApplyFlag})
	
	
]]>"
sqlserver_insert_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,2,"<![CDATA[

		INSERT INTO RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO
			  (FUNCTION_NAME, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, PARAMETER_ID, EQUIPMENT_PARAMETER_ID, 
			   SPEC_TYPE_CODE, GRADE_CODE, EQUIPMENT_VALUE, PARAMETER_FLAG, USE_FLAG, 
			   DOWNLOAD_FLAG, RMS_USE_FLAG, LAST_VALUE_NO_APPLY_FLAG)
		SELECT DISTINCT #{functionName} AS FUNCTION_NAME, 
		       #{transactionSerialNo} AS TRANSACTION_SERIAL_NO, 
			   #{equipmentId}   AS EQUIPMENT_ID, 
		       ISNULL(EP.PARAMETER_ID, EP2.PARAMETER_ID) AS PARAMETER_ID, 
		       PL.EQUIPMENT_PARAMETER_ID AS EQUIPMENT_PARAMETER_ID ,
		       EP.SPEC_TYPE_CODE AS SPEC_TYPE_CODE,
		       ISNULL(EP.GRADE_CODE,'0') AS GRADE_CODE, 
		       PL.REQUEST_VALUE AS EQUIPMENT_VALUE,
		       PL.PARAMETER_FLAG AS PARAMETER_FLAG,
		       PL.PARAMETER_FLAG AS USE_FLAG,    
		       (CASE WHEN ISNULL(EP.GRADE_CODE, '1') = '3' 
		             THEN 'Y' 
		             ELSE 'N' 
		             END) AS DOWNLOAD_FLAG,  -- 1:DOWNLOAD, 0:DOWNLOAD ?ˆí•¨
		       ISNULL(EP.RMS_USE_FLAG, 'N') AS RMS_USE_FLAG,
			   ISNULL(EP.LAST_VALUE_NO_APPLY_FLAG, 'N') AS LAST_VALUE_NO_APPLY_FLAG  --?¤ë¹„ ìµœì¢…ê°?ë¯¸ì ?©ì¼ ê²½ìš° ?¤ìš´ë¡œë“œ ?œì™¸??
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
		  LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE = #{facilityCode} 
		   AND EP.EQUIPMENT_ID = #{equipmentId} 
		   AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
		   AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID
		   AND EP.USE_FLAG = 'Y') 
		  LEFT OUTER JOIN RMSPLUS.TB_RMS_EQUIPMENT_PARAM_INFO EP2 WITH(NOLOCK)
		    ON (EP2.FACILITY_CODE = #{facilityCode} 
		   AND EP2.EQUIPMENT_ID = #{equipmentId}
		   AND EP2.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID
		   AND EP2.USE_FLAG = 'Y')     
	     WHERE PL.FUNCTION_NAME=#{functionName}
	       AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	
]]>"
sqlserver_insert_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,3,"<![CDATA[
	
		INSERT INTO RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO
			 ( FUNCTION_NAME, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, PARAMETER_ID, EQUIPMENT_PARAMETER_ID, 
			   SPEC_TYPE_CODE, GRADE_CODE, EQUIPMENT_VALUE, PARAMETER_FLAG, USE_FLAG, 
			   DOWNLOAD_FLAG, RMS_USE_FLAG, LAST_VALUE_NO_APPLY_FLAG )
		SELECT DISTINCT #{functionName} AS FUNCTION_NAME, 
		       #{transactionSerialNo} AS TRANSACTION_SERIAL_NO, 
			   #{equipmentId}   AS EQUIPMENT_ID, 
		       ISNULL(EP.PARAMETER_ID, EP2.PARAMETER_ID) AS PARAMETER_ID, 
		       PL.EQUIPMENT_PARAMETER_ID AS EQUIPMENT_PARAMETER_ID ,
		       EP.SPEC_TYPE_CODE AS SPEC_TYPE_CODE,
		       ISNULL(EP.GRADE_CODE,'0') AS GRADE_CODE, 
		       PL.REQUEST_VALUE AS EQUIPMENT_VALUE,
		       PL.PARAMETER_FLAG AS PARAMETER_FLAG,
		       PL.PARAMETER_FLAG AS USE_FLAG,    
		       (CASE WHEN ISNULL(EP.GRADE_CODE, '1') = '3' 
		             THEN 'Y' 
		             ELSE 'N' 
		             END) AS DOWNLOAD_FLAG,  -- 1:DOWNLOAD, 0:DOWNLOAD ?ˆí•¨
		       ISNULL(EP.RMS_USE_FLAG, 'N') AS RMS_USE_FLAG,
			   ISNULL(EP.LAST_VALUE_NO_APPLY_FLAG, 'N') AS LAST_VALUE_NO_APPLY_FLAG  --?¤ë¹„ ìµœì¢…ê°?ë¯¸ì ?©ì¼ ê²½ìš° ?¤ìš´ë¡œë“œ ?œì™¸??
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
		  LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE = #{facilityCode} 
		   AND EP.EQUIPMENT_ID = #{equipmentId} 
		   AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
		   AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
		   AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID
		   AND EP.USE_FLAG = 'Y') 
		  LEFT OUTER JOIN RMSPLUS.TB_RMS_EQUIPMENT_PARAM_INFO EP2 WITH(NOLOCK)
		    ON (EP2.FACILITY_CODE = #{facilityCode} 
		   AND EP2.EQUIPMENT_ID = #{equipmentId}
		   AND EP2.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID
		   AND EP2.USE_FLAG = 'Y')          
	     WHERE PL.FUNCTION_NAME=#{functionName}
	       AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}

]]>"
sqlserver_insert_TB_RMS_EQP_REQ_PARAM_INFO,1,"<![CDATA[

INSERT INTO RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO     
 (FUNCTION_NAME, TRANSACTION_SERIAL_NO, EQUIPMENT_PARAMETER_ID, REQUEST_VALUE, PARAMETER_FLAG)    
VALUES (#{functionName}, #{transactionSerialNo}, #{equipmentParameterId}, 
         (SELECT CASE WHEN #{requestValue} = '' THEN NULL
		              WHEN 
						 (SELECT MIN(PM.DECIMAL_POINT_VALUE) AS DECIMAL_POINT_VALUE
							FROM RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK)
			 			   INNER JOIN  RMSPLUS.TB_RMS_EQUIPMENT_MST EM WITH(NOLOCK)
			  				  ON (EM.EQUIPMENT_ID = #{equipmentId}
							 AND EM.EQUIPMENT_GROUP_ID = PM.EQUIPMENT_GROUP_ID)
						   INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_PARAM_INFO EP WITH(NOLOCK)
							  ON (EP.EQUIPMENT_ID = EM.EQUIPMENT_ID
							 AND EP.PARAMETER_ID = PM.PARAMETER_ID   
							 AND  EP.EQUIPMENT_PARAMETER_ID = #{equipmentParameterId})
						   WHERE PM.DATA_TYPE_CODE = 'N') IS NULL  OR ISNUMERIC(#{requestValue}) = 0
						 THEN #{requestValue}
					  ELSE  
						(CONVERT(NVARCHAR(30), ROUND(#{requestValue}, 
 											  (SELECT MIN(PM.DECIMAL_POINT_VALUE) AS DECIMAL_POINT_VALUE
												 FROM RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK)
											    INNER JOIN  RMSPLUS.TB_RMS_EQUIPMENT_MST EM WITH(NOLOCK)
												   ON (EM.EQUIPMENT_ID = #{equipmentId}
												  AND EM.EQUIPMENT_GROUP_ID = PM.EQUIPMENT_GROUP_ID)
												INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_PARAM_INFO EP WITH(NOLOCK)
												   ON (EP.EQUIPMENT_ID = EM.EQUIPMENT_ID
                                                  AND EP.PARAMETER_ID = PM.PARAMETER_ID   
												  AND  EP.EQUIPMENT_PARAMETER_ID = #{equipmentParameterId})
												WHERE PM.DATA_TYPE_CODE = 'N')))) 
			    END), 
		 #{parameterFlag})

]]>"
sqlserver_insert_TB_RMS_EQP_REQ_PARAM_INFO,2,"<![CDATA[

	INSERT INTO RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO
            SELECT #{functionName} AS FUNCTION_NAME, 
		   #{transactionSerialNo} AS TRANSACTION_SERIAL_NO, 
		   EQUIPMENT_PARAMETER_ID, 
		   UPLOAD_VALUE AS REQUEST_VALUE, 
		   'Y' AS PARAMETER_FLAG      
              FROM RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST WITH(NOLOCK)
             WHERE FACILITY_CODE = #{facilityCode}
	       AND TRANSACTION_SERIAL_NO = #{collectNo}
	       AND EQUIPMENT_ID = #{equipmentId}

]]>"
sqlserver_insert_TB_RMS_EQUIPMENT_STATE_HIST,1,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_RMS_EQUIPMENT_STATE_HIST
		   (FACILITY_CODE, EQUIPMENT_ID, TRANSACTION_SERIAL_NO, OLD_STATE_CODE, NEW_STATE_CODE, 
		    CURRENT_FLAG, LAST_UPDATE_DATE)  
		   SELECT #{facilityCode}, #{equipmentId}, #{transactionSerialNo}, #{oldStateCode}, #{newStateCode}, 
		          #{currentFlag}, GETDATE() 
	
	
]]>"
sqlserver_insert_TB_RMS_MAIL_SEND_HIST,1,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_RMS_MAIL_SEND_HIST 
		(MAIL_TITLE_CONTENT, MAIL_BODY_CONTENT, HTML_FLAG, FROM_ADDRESS_VALUE, TO_ADDRESS_VALUE, 
		 CC_ADDRESS_VALUE, MAIL_TYPE_ID, MAIL_TYPE_CODE, PROCESS_CODE, EQUIPMENT_ID, 
		 SEND_FLAG, SEND_DATE, RETURN_MESSAGE_CONTENT, CREATION_USER_ID, CREATION_DATE, 
		 LAST_UPDATE_USER_ID , LAST_UPDATE_DATE)
		SELECT #{mailTitleContent}, #{mailBodyContent}, #{htmlFlag}, #{fromAddressValue}, EMAIL_ADDR, 
		       '', #{mailTypeId}, #{mailTypeCode}, #{processCode}, #{equipmentId}, 
		       'N', NULL, NULL, 'system', GETDATE(), 
		       'system', GETDATE()  
		  FROM RMSPLUS.TB_RMS_TEMP_SMS_USER TSU WITH(NOLOCK)  
		 WHERE FUNCTION_NAME = #{functionName}
		   AND TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND ALARM_TYPE_CODE IN ('MAIL', 'ALL')
	
	
]]>"
sqlserver_insert_TB_RMS_RCP_PARAM_UPLOAD_HIST,1,"<![CDATA[
	
		INSERT INTO RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST
			   (FACILITY_CODE, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, RECIPE_ID, EQUIPMENT_PARAMETER_ID, 
			    UPLOAD_TYPE_CODE, PARAMETER_ID, UPLOAD_VALUE, TRANSACTION_DATE, LAST_UPDATE_USER_ID, 
			    LAST_UPDATE_DATE)
		SELECT DISTINCT #{facilityCode}, #{transactionSerialNo}, #{equipmentId}, #{recipeId}, PL.EQUIPMENT_PARAMETER_ID, 
		       #{uploadTypeCode}, EP.PARAMETER_ID, PL.REQUEST_VALUE, #{transactionDate}, #{lastUpdateUserId}, 
		       #{lastUpdateDate} 
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
		  LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE=#{facilityCode} 
		   AND EP.EQUIPMENT_ID = #{equipmentId} 
		   AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID 
		   AND EP.USE_FLAG = 'Y')
	     WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.PARAMETER_FLAG = 'Y'	

]]>"
sqlserver_insert_TB_RMS_RCP_PARAM_UPLOAD_HIST,2,"<![CDATA[

		INSERT INTO RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST
			   (FACILITY_CODE, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, RECIPE_ID, RECIPE_VERSION, 
			    EQUIPMENT_PARAMETER_ID, UPLOAD_TYPE_CODE, PARAMETER_ID, UPLOAD_VALUE, TRANSACTION_DATE, 
			    LAST_UPDATE_USER_ID, LAST_UPDATE_DATE)
		SELECT #{facilityCode}, #{transactionSerialNo}, #{equipmentId}, #{recipeId}, 
		       (CASE WHEN EP.RECIPE_ID = NULL 
		             THEN NULL 
		             ELSE EP.RECIPE_VERSION 
		             END) AS RECIPE_VERSION, 
		       PL.EQUIPMENT_PARAMETER_ID, 
               #{uploadTypeCode}, 
               EP.PARAMETER_ID, 
               PL.REQUEST_VALUE, 
               #{transactionDate}, 
		       #{lastUpdateUserId}, 
               #{lastUpdateDate} 
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK) 
	 	  LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE=#{facilityCode} 
		   AND EP.EQUIPMENT_ID = #{equipmentId} 
		   AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID 
		   AND EP.EQUIPMENT_RECIPE_ID = #{equipmentRecipeId} 
		   AND EP.USE_FLAG = 'Y')
	         WHERE PL.FUNCTION_NAME = #{functionName}
	           AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	           AND PL.PARAMETER_FLAG = 'Y'

]]>"
sqlserver_insert_TB_RMS_RCP_PARAM_UPLOAD_HIST,3,"<![CDATA[
	
		INSERT INTO RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST 
			  (FACILITY_CODE, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, UPLOAD_TYPE_CODE, PARAMETER_ID, 
			   EQUIPMENT_PARAMETER_ID, RECIPE_ID, UPLOAD_VALUE, TRANSACTION_DATE, LAST_UPDATE_USER_ID, 
			   LAST_UPDATE_DATE)
		SELECT DISTINCT #{facilityCode} AS FACILITY_CODE, #{transactionSerialNo} AS TRANSACTION_SERIAL_NO, #{equipmentId} AS EQUIPMENT_ID, 
		       #{uploadTypeCode} AS UPLOAD_TYPE_CODE, EP.PARAMETER_ID AS PARAMETER_ID, PL.EQUIPMENT_PARAMETER_ID AS EQUIPMENT_PARAMETER_ID, 
		       #{recipeId} AS RECIPE_ID, RTRIM(LTRIM(PL.REQUEST_VALUE)) AS UPLOAD_VALUE, #{transactionDate} AS TRANSACTION_DATE, 
		       #{lastUpdateUserId} AS LAST_UPDATE_USER_ID, #{lastUpdateDate} AS LAST_UPDATE_DATE 
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
		  LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE = #{facilityCode} 
		   AND EP.EQUIPMENT_ID = #{equipmentId} 
		   AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID 
		   AND EP.USE_FLAG = 'Y')
		 WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.PARAMETER_FLAG = 'Y'
	
]]>"
sqlserver_insert_TB_RMS_RCP_PARAM_UPLOAD_HIST,4,"<![CDATA[

		INSERT INTO RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST
		 (FACILITY_CODE, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, EQUIPMENT_PARAMETER_ID, RECIPE_ID, RECIPE_VERSION,
		  UPLOAD_TYPE_CODE, PARAMETER_ID, UPLOAD_VALUE, TRANSACTION_DATE, LAST_UPDATE_USER_ID, 
		  LAST_UPDATE_DATE)
		SELECT #{facilityCode}, #{transactionSerialNo}, #{equipmentId}, PL.EQUIPMENT_PARAMETER_ID, #{recipeId}, #{recipeVersion},
		       #{uploadTypeCode}, ISNULL(EP.PARAMETER_ID, EP2.PARAMETER_ID), PL.REQUEST_VALUE, #{transactionDate}, #{lastUpdateUser}, 
		       #{lastUpdateDate}
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK) 
		  LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE = #{facilityCode}
		   AND EP.EQUIPMENT_ID = #{equipmentId}
		   AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
		   AND EP.PRODUCT_SPECIFICATION_VERSION =  #{productSpecificationVersion}
		   AND EP.RECIPE_ID = #{recipeId}
		   AND EP.RECIPE_VERSION =  #{recipeVersion}			        
		   AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID 
		   AND EP.USE_FLAG = 'Y')
		  LEFT OUTER JOIN RMSPLUS.TB_RMS_EQUIPMENT_PARAM_INFO EP2 WITH(NOLOCK)
		    ON (EP2.FACILITY_CODE = #{facilityCode}
		   AND EP2.EQUIPMENT_ID = #{equipmentId}
		   AND EP2.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID
		   AND EP2.USE_FLAG = 'Y')	       
		 WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.PARAMETER_FLAG = 'Y'
	
]]>"
sqlserver_insert_TB_RMS_RCP_PARAM_UPLOAD_HIST,5,"<![CDATA[

		
		INSERT INTO RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST
		 (FACILITY_CODE, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, EQUIPMENT_PARAMETER_ID, UPLOAD_TYPE_CODE, 
          RECIPE_ID, RECIPE_VERSION, PARAMETER_ID, UPLOAD_VALUE, OLD_VALUE, 
          PARAMETER_STEP_CODE, VALIDATION_RESULT_CODE, TRANSACTION_DATE, TRANSACTION_TYPE_CODE, LAST_UPDATE_USER_ID, 
          LAST_UPDATE_DATE)
        VALUES
 	     (
		  #{facilityCode}, #{transactionSerialNo}, #{equipmentId}, #{equipmentParameterId}, #{uploadTypeCode},
		  #{recipeId}, #{recipeVersion}, #{parameterId}, #{uploadValue}, #{oldValue},
		  #{parameterStepCode}, #{validationResultCode}, #{transactionDate}, #{transactionTypeCode}, #{lastUpdateUserId},
		  #{lastUpdateDate}
		 )	
	
	
]]>"
sqlserver_insert_TB_RMS_RCP_PARAM_UPLOAD_HIST,6,"<![CDATA[

	INSERT INTO RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST 
			  (FACILITY_CODE, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, UPLOAD_TYPE_CODE, PARAMETER_ID, 
			   EQUIPMENT_PARAMETER_ID, RECIPE_ID, UPLOAD_VALUE, TRANSACTION_DATE, LAST_UPDATE_USER_ID, 
			   LAST_UPDATE_DATE)
		SELECT DISTINCT #{facilityCode} AS FACILITY_CODE, #{transactionSerialNo} AS TRANSACTION_SERIAL_NO, #{equipmentId} AS EQUIPMENT_ID, 
		       #{uploadTypeCode} AS UPLOAD_TYPE_CODE, EP.PARAMETER_ID AS PARAMETER_ID, PL.EQUIPMENT_PARAMETER_ID AS EQUIPMENT_PARAMETER_ID, 
		       #{recipeId} AS RECIPE_ID, RTRIM(LTRIM(PL.REQUEST_VALUE)) AS UPLOAD_VALUE, #{transactionDate} AS TRANSACTION_DATE, 
		       #{lastUpdateUserId} AS LAST_UPDATE_USER_ID, #{lastUpdateDate} AS LAST_UPDATE_DATE
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
		  LEFT OUTER JOIN RMSPLUS.TB_RMS_EQUIPMENT_PARAM_INFO EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE = #{facilityCode} 
		   AND EP.EQUIPMENT_ID = #{equipmentId} 
		   AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID
		   AND EP.USE_FLAG = 'Y')
                 OUTER APPLY (SELECT TOP 1 UPLOAD_VALUE 
		                FROM RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST UH WITH(NOLOCK)
		               WHERE UH.FACILITY_CODE = #{facilityCode}
			         AND UH.EQUIPMENT_ID = #{equipmentId}
			         AND UH.EQUIPMENT_PARAMETER_ID = EP.EQUIPMENT_PARAMETER_ID
		               ORDER BY UH.TRANSACTION_DATE DESC) LATEST
		 WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.PARAMETER_FLAG = 'Y'
		   AND ((PL.REQUEST_VALUE IS NOT NULL AND LATEST.UPLOAD_VALUE IS NULL) 
	             OR (PL.REQUEST_VALUE IS NULL AND LATEST.UPLOAD_VALUE IS NOT NULL) 
		     OR (PL.REQUEST_VALUE != LATEST.UPLOAD_VALUE))

]]>"
sqlserver_insert_TB_RMS_RECIPE_DOWN_HIST,1,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_RMS_RECIPE_DOWN_HIST
			   (FACILITY_CODE, EQUIPMENT_ID, TRANSACTION_SERIAL_NO, LOT_ID, REQ_PROD_SPEC_ID, 
			    REQ_PROD_SPEC_VERSION, RECIPE_ID, RECIPE_VERSION, RECIPE_MAP_VERSION, EQUIPMENT_RECIPE_ID, VALIDATION_RESULT_CODE, VALIDATION_CODE, 
			    VALIDATION_MODE_CODE, REP_PROD_SPEC_ID, REP_PROD_SPEC_VERSION, DOWNLOAD_TYPE_CODE, VALIDATION_SEQ_NO, 
			    TOP_BACK_TYPE_CODE, TRANSACTION_DATE)
		VALUES (#{facilityCode}, #{equipmentId}, #{transactionSerialNo}, #{lotId}, #{reqProdSpecId}, 
		        #{reqProdSpecVersion}, #{recipeId}, #{recipeVersion}, #{recipeMapVersion}, #{equipmentRecipeId}, #{validationResultCode}, #{validationCode}, 
		        #{validationModeCode}, #{repProdSpecId}, #{repProdSpecVersion}, #{downloadTypeCode}, #{validationSeqNo}, 
		        #{topBackTypeCode}, #{transactionDate})
	
	
]]>"
sqlserver_insert_TB_RMS_RECIPE_PARAM_DOWN_HIST,1,"<![CDATA[

		INSERT INTO RMSPLUS.TB_RMS_RECIPE_PARAM_DOWN_HIST	
		       (FACILITY_CODE, EQUIPMENT_ID, TRANSACTION_SERIAL_NO, PARAMETER_ID, USE_FLAG, 
		        DOWNLOAD_FLAG, EQUIPMENT_VALUE, RMS_VALUE, DOWNLOAD_VALUE, TRANSACTION_DATE)
		SELECT #{facilityCode} AS FACILITY_CODE, 
		       #{equipmentId} AS EQUIPMENT_ID, 
		       #{transactionSerialNo} AS TRANSACTION_SERIAL_NO,
		       PL.PARAMETER_ID AS PARAMETER_ID, 
		       PL.USE_FLAG AS USE_FLAG, 
		       (CASE WHEN #{downloadTypeCode} = 'LAST' AND PL.USE_FLAG = 'Y' THEN 'Y'
		             WHEN #{downloadTypeCode} = 'SPEC' AND PL.DOWNLOAD_FLAG = 'Y' THEN 'Y' 
		             ELSE 'N' 
		       		 END) AS DOWNLOAD_FLAG,     
		       PL.EQUIPMENT_VALUE AS EQUIPMENT_VALUE, 
		       PL.RMS_VALUE AS RMS_VALUE, 
		       (CASE WHEN #{validationResultCode}='0' 
		              AND #{downloadTypeCode} = 'LAST' 
		              AND PL.USE_FLAG = 'Y' 
		             THEN PL.RMS_VALUE
		             WHEN (#{validationResultCode}='0' OR #{validationCode}='20') 
		              AND #{downloadTypeCode} = 'SPEC' 
		              AND PL.USE_FLAG = 'Y' 
		              AND PL.DOWNLOAD_FLAG = 'Y' 
		             THEN PL.RMS_VALUE -- ë¯¹ì„œ ?±í¬?ë£Œ?†ìŒNG???•ìƒ?ìœ¼ë¡??´ë¦¼
					 WHEN #{recipeIdPrefixValue} ='MIX' 
					      AND #{validationResultCode}='1' 
					      AND #{downloadTypeCode} = 'SPEC' 
					      AND PL.USE_FLAG = 'Y'  
					      AND PL.DOWNLOAD_FLAG = 'Y' 
					 THEN -- ë¯¹ì„œ NG ?ë£Œëª?ë¹ˆê°’, ?´ì™¸ '0' 
					      (CASE WHEN PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId} 
					            THEN '' 
					            ELSE '0' 
					            END)  		            
		             ELSE PL.EQUIPMENT_VALUE  
		       		 END) AS DOWNLOAD_VALUE,
		       #{transactionDate} AS TRANSACTION_DATE
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL WITH(NOLOCK)
		 WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.PARAMETER_FLAG = 'Y'

]]>"
sqlserver_insert_TB_RMS_RECIPE_UPLOAD_HIST,1,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST
               (FACILITY_CODE, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, UPLOAD_TYPE_CODE, RECIPE_ID, 
                RECIPE_VERSION, TRANSACTION_DATE, EQP_PROD_SPEC_ID, LAST_UPDATE_USER_ID, LAST_UPDATE_DATE )
        SELECT #{facilityCode}, #{transactionSerialNo}, #{equipmentId}, #{uploadTypeCode}, #{equipmentRecipeId}, 
               MAX(ER.RECIPE_VERSION), #{transactionDate}, #{prodSpecId}, #{lastUpdateUserId}, #{lastUpdateDate}
		  FROM RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO ER WITH(NOLOCK)
		 WHERE ER.FACILITY_CODE=#{facilityCode} 
		   AND ER.EQUIPMENT_ID = #{equipmentId} 
		   AND ER.EQUIPMENT_RECIPE_ID=#{equipmentRecipeId}
		   AND ER.PRODUCT_SPECIFICATION_ID in (#{prodSpecId}, '*') 
		   AND ER.USE_FLAG = 'Y'
	
	
]]>"
sqlserver_insert_TB_RMS_RECIPE_UPLOAD_HIST,2,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST	
			   (FACILITY_CODE, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, EQP_PROD_SPEC_ID, EQP_PROD_SPEC_VERSION, 
			    PRODUCT_SPECIFICATION_ID, PRODUCT_SPECIFICATION_VERSION, UPLOAD_TYPE_CODE, RECIPE_ID, UPLOAD_LOT_ID, 
				PRODUCTION_QTY, EQUIPMENT_RUN_FLAG, AUTO_DATA_COLLECTION_FLAG, EQUIPMENT_TEST_MODE_FLAG, 
			    PROCESS_FLAG, TRANSACTION_DATE, COLLECTION_ATTRIBUTE1, COLLECTION_ATTRIBUTE2, COLLECTION_ATTRIBUTE3, 
			    COLLECTION_ATTRIBUTE4, COLLECTION_ATTRIBUTE5, LAST_UPDATE_USER_ID, LAST_UPDATE_DATE) 
		VALUES (#{facilityCode}, #{transactionSerialNo}, #{equipmentId}, #{eqpProdSpecId}, #{eqpProdSpecVersion}, 
		        #{productSpecificationId}, #{productSpecificationVersion},#{uploadTypeCode}, #{recipeId}, #{uploadLotId}, 
				#{productionQty}, #{equipmentRunFlag}, #{autoDataCollectionFlag}, #{equipmentTestModeFlag}, 
		        #{processFlag}, #{transactionDate}, #{collectionAttribute1}, #{collectionAttribute2}, #{collectionAttribute3}, 
		        #{collectionAttribute4}, #{collectionAttribute5}, #{lastUpdateUserId}, #{lastUpdateDate})
	
	
]]>"
sqlserver_insert_TB_RMS_RECIPE_UPLOAD_HIST,3,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST
		 (FACILITY_CODE, TRANSACTION_SERIAL_NO, EQUIPMENT_ID, UPLOAD_TYPE_CODE, RECIPE_ID, 
		  RECIPE_VERSION, UPLOAD_LOT_ID, EQP_PROD_SPEC_ID, EQP_PROD_SPEC_VERSION, PRODUCT_SPECIFICATION_ID, 
		  PRODUCT_SPECIFICATION_VERSION, VALIDATION_MODE_CODE, VALIDATION_RESULT_CODE, VALIDATION_CODE, TRANSACTION_DATE, 
		  COLLECTION_ATTRIBUTE1, LAST_UPDATE_USER_ID, LAST_UPDATE_DATE) 
		VALUES 
		 (#{facilityCode}, #{transactionSerialNo}, #{equipmentId}, #{uploadTypeCode}, #{recipeId}, #{recipeVersion},
		  #{uploadLotId}, #{eqpProdSpecId}, #{eqpProdSpecVersion}, #{productSpecificationId}, #{productSpecificationVersion}, 
		  #{validationModeCode}, #{validationResultCode}, #{validationCode}, #{transactionDate}, #{collectionAttribute1}, 
		  #{lastUpdateUserId}, #{lastUpdateDate})
	
	
]]>"
sqlserver_insert_TB_RMS_RECIPE_VERSION_INFO,1,"<![CDATA[

		INSERT INTO RMSPLUS.TB_RMS_RECIPE_VERSION_INFO
		SELECT FACILITY_CODE, RECIPE_ID, PARAMETER_ID, #{recipeNewVersion} AS RECIPE_VERSION, SPEC_TYPE_CODE, LSL_VALUE
		       ,TARGET_VALUE, USL_VALUE, SPEC_CHANGE_REASON, #{creationUsereId}, #{creationDate}
		       ,NULL, NULL
  		  FROM RMSPLUS.TB_RMS_RECIPE_VERSION_INFO WITH(NOLOCK)
 		 WHERE FACILITY_CODE = #{facilityCode}
		   AND RECIPE_ID = #{recipeId} 
		   AND RECIPE_VERSION = #{recipeVersion}

]]>"
sqlserver_insert_TB_RMS_REL_VALIDATION_INFO,1,"<![CDATA[

INSERT INTO RMSPLUS.TB_RMS_REL_VALIDATION_INFO 
 (FACILITY_CODE, VALIDATION_SEQ_NO, RELATION_VALIDATION_SEQ_NO, EQUIPMENT_ID, PRODUCT_SPECIFICATION_ID,
  PRODUCT_SPECIFICATION_VERSION, RECIPE_ID, RECIPE_VERSION, RECIPE_MAP_VERSION, RELATION_RECIPE_ID,
  RELATION_RECIPE_VERSION, RELATION_RECIPE_MAP_VERSION, RELATION_TYPE_CODE, LAST_UPDATE_USER_ID, LAST_UPDATE_DATE,
  VALIDATION_TYPE_CODE)
  VALUES
 (#{facilityCode}, #{validationSeqNo}, #{relationValidationSeqNo}, #{equipmentId}, #{productSpecificationId},
 #{productSpecificationVersion}, #{recipeId}, #{recipeVersion}, #{recipeMapVersion}, #{relationRecipeId},
 #{relationRecipeVersion}, #{relationRecipeMapVersion}, #{relationTypeCode}, 'system', GETDATE(),
  #{validationTypeCode})

]]>
"
sqlserver_insert_TB_RMS_SMS_SKIP_LOG,1,"<![CDATA[

	
		INSERT INTO RMSPLUS.TB_RMS_SMS_SKIP_LOG
		 (FACILITY_CODE, SMS_TYPE_CODE, EQUIPMENT_ID, TRANSACTION_DATE, VALIDATION_SEQ_NO, 
		  LOT_ID, VALIDATION_CODE, SMS_MESSAGE_CONTENT, PHONE_NUMBER, USER_NAME, 
		  PROCESS_FLAG)
		  SELECT #{facilityCode} AS FACILITY_CODE, #{smsTypeCode} AS SMS_TYPE_CODE, #{equipmentId} AS EQUIPMENT_ID, 
		         #{transactionDate} AS TRANSACTION_DATE, #{validationSeqNo} AS VALIDATION_SEQ_NO, #{lotId} AS LOT_ID, 
		         #{validationCode} AS VALIDATION_CODE, #{smsMessageContent} AS SMS_MESSAGE_CONTENT, REPLACE(REPLACE(TSU.PHONE_NUMBER,'-',''),' ','') AS PHONE_NUMBER, 
		         TSU.USER_NAME AS USER_NAME, 'N' AS PROC_FLAG
			FROM RMSPLUS.TB_RMS_TEMP_SMS_USER TSU WITH(NOLOCK)
		   WHERE TSU.FUNCTION_NAME = #{functionName}
		     AND TSU.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		     AND SMS_SEND_FLAG ='N' 
		     AND ALARM_TYPE_CODE IN ('SMS','ALL')
		     AND ISNULL(PHONE_NUMBER,'') != ''  	
	
	
]]>"
sqlserver_insert_TB_RMS_TEMP_SMS_USER,1,"<![CDATA[

    INSERT INTO RMSPLUS.TB_RMS_TEMP_SMS_USER 
     (FUNCTION_NAME, TRANSACTION_SERIAL_NO, USER_NAME, PHONE_NUMBER, EMAIL_ADDR, ALARM_TYPE_CODE, SMS_SEND_FLAG)
		  SELECT #{functionName} AS FUNCTION_NAME, 
		         #{transactionSerialNo} AS TRANSACTION_SERIAL_NO, 
		         UM.USER_NAME AS USER_NAME, 
			 REPLACE(REPLACE(UM.MOBILE_PHONE_NO,'-',''),' ','') AS PHONE_NUMBER,
			 UM.EMAIL_ADDR AS EMAIL_ADDR,
			 DT.ALARM_TYPE_CODE AS ALARM_TYPE_CODE,
			 (CASE WHEN #{smsNightSkipFlag} = 'Y' AND ISNULL(DT.WEEK_SMS_FLAG,'N') = 'N'
			       THEN 'N'
				   WHEN #{smsWeekSkipFlag} = 'Y' AND ISNULL(DT.WEEK_SMS_FLAG,'N') = 'N' 
				   THEN 'N'
				   ELSE 'Y'
		    	   END) AS SMS_SEND_FLAG  
		    FROM (SELECT VE.EQUIPMENT_ID, US.MAIL_USER_ID,
			         MIN(US.MAIL_ATTRIBUTE_2) AS ALARM_TYPE_CODE, 
			         MIN(US.MAIL_ATTRIBUTE_3) AS NIGHT_SMS_FLAG, 
				 MIN(US.MAIL_ATTRIBUTE_4) AS WEEK_SMS_FLAG, 
				 COUNT(UM.MAIL_KEY_VALUE_1) AS USER_PROD_CNT,
				 (CASE WHEN SUM((CASE WHEN UM.MAIL_KEY_VALUE_1 = CM.MODEL_ID 
				                      THEN 1 
				                      ELSE 0 
				                      END)) > 0 
				       THEN 'Y' 
				       ELSE 'N' 
				       END) AS MY_PROD_FLAG
			    FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE
			   INNER JOIN RMSPLUS.TB_RMS_MAIL_SMS_USER_INFO US WITH(NOLOCK) 
			      ON (US.FACILITY_CODE = VE.FACILITY_CODE
			     AND US.MAIL_TYPE_CODE = 'MAIL_TYPE_MGR_GROUP'
			     AND US.MAIL_KEY_VALUE_1 = VE.MGR_GROUP_ID)
			   INNER JOIN RMSPLUS.TB_COM_PRODUCT_SPEC_MST CM WITH(NOLOCK) 
			      ON (CM.PRODUCT_SPECIFICATION_ID = #{productSpecificationId})
			    LEFT OUTER JOIN RMSPLUS.TB_RMS_MAIL_SMS_USER_INFO UM WITH(NOLOCK) 
			      ON (UM.FACILITY_CODE = VE.FACILITY_CODE
			     AND UM.MAIL_TYPE_CODE = 'MAIL_TYPE_PRODUCT_SPEC'
			     AND UM.MAIL_USER_ID = US.MAIL_USER_ID)
		           WHERE VE.EQUIPMENT_ID = #{equipmentId}
			     AND US.MAIL_KEY_VALUE_2   = #{validationCode}
			     AND (EXISTS (SELECT 1  
				            FROM RMSPLUS.TB_RMS_MAIL_SMS_USER_INFO UE WITH(NOLOCK) 
					   WHERE UE.FACILITY_CODE = VE.FACILITY_CODE
					     AND UE.MAIL_TYPE_CODE = 'MAIL_TYPE_EQUIPMENT'
					     AND UE.MAIL_KEY_VALUE_1 = VE.EQUIPMENT_ID
					     AND UE.MAIL_USER_ID = US.MAIL_USER_ID)   
		               OR NOT EXISTS (SELECT 1
				   	        FROM RMSPLUS.VW_RMS_EQUIPMENT_MST EQ WITH(NOLOCK)
					       INNER JOIN RMSPLUS.TB_RMS_MAIL_SMS_USER_INFO UE WITH(NOLOCK)
				         	  ON (UE.FACILITY_CODE = EQ.FACILITY_CODE
						 AND UE.MAIL_TYPE_CODE = 'MAIL_TYPE_EQUIPMENT'
						 AND UE.MAIL_KEY_VALUE_1 = EQ.EQUIPMENT_ID)
					       WHERE EQ.MGR_GROUP_ID = VE.MGR_GROUP_ID
					         AND UE.MAIL_USER_ID = US.MAIL_USER_ID) 
      	                       OR NOT EXISTS (SELECT 1
					        FROM RMSPLUS.VW_RMS_EQUIPMENT_MST EQ WITH(NOLOCK)
					       INNER JOIN RMSPLUS.TB_RMS_MAIL_SMS_USER_INFO UE WITH(NOLOCK) 
					          ON (UE.FACILITY_CODE = EQ.FACILITY_CODE
					         AND UE.MAIL_TYPE_CODE = 'MAIL_TYPE_EQUIPMENT'
					         AND UE.MAIL_KEY_VALUE_1 = EQ.EQUIPMENT_ID)
					       WHERE EQ.MGR_GROUP_ID = VE.MGR_GROUP_ID )	   
				             ) 
		           GROUP BY VE.EQUIPMENT_ID, US.MAIL_USER_ID
			 ) DT
	           INNER JOIN RMSCMN.TB_EGN_USR_MST UM WITH(NOLOCK) 
		      ON (UM.USER_ID = DT.MAIL_USER_ID)	
		   WHERE (DT.USER_PROD_CNT = 0 OR (DT.USER_PROD_CNT > 0 AND DT.MY_PROD_FLAG = 'Y'))

]]>"
sqlserver_insert_TB_RMS_TEMP_SMS_USER,2,"<![CDATA[

    INSERT INTO RMSPLUS.TB_RMS_TEMP_SMS_USER 
		 (FUNCTION_NAME, TRANSACTION_SERIAL_NO, USER_NAME, PHONE_NUMBER, EMAIL_ADDR, ALARM_TYPE_CODE, SMS_SEND_FLAG)
		  SELECT #{functionName} AS FUNCTION_NAME,
		         #{transactionSerialNo} AS TRANSACTION_SERIAL_NO,
		         UM.USER_NAME AS USER_NAME, 
			 REPLACE(REPLACE(UM.MOBILE_PHONE_NO,'-',''),' ','') AS PHONE_NUMBER,
			 UM.EMAIL_ADDR AS EMAIL_ADDR,
			 US.MAIL_ATTRIBUTE_2 AS ALARM_TYPE_CODE_CODE,
			 (CASE WHEN #{smsNightSkipFlag} = 'Y' 
			        AND ISNULL(US.MAIL_ATTRIBUTE_3,'N') = 'N' 
			       THEN 'N'
		    	       WHEN #{smsWeekSkipFlag} = 'Y' 
				AND ISNULL(US.MAIL_ATTRIBUTE_4,'N') = 'N' 
			       THEN 'N'
			       ELSE 'Y'
			       END) AS SMS_SEND_FLAG  
		    FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK)
		   INNER JOIN RMSPLUS.TB_RMS_MAIL_SMS_USER_INFO US WITH(NOLOCK) 
		      ON (US.FACILITY_CODE = VE.FACILITY_CODE
		     AND US.MAIL_TYPE_CODE = 'MAIL_TYPE_MGR_GROUP'
		     AND US.MAIL_KEY_VALUE_1 = VE.MGR_GROUP_ID)
		   INNER JOIN RMSPLUS.TB_RMS_MAIL_SMS_USER_INFO UE WITH(NOLOCK) 
		      ON (UE.FACILITY_CODE = VE.FACILITY_CODE
		     AND UE.MAIL_TYPE_CODE = 'MAIL_TYPE_EQUIPMENT'
		     AND UE.MAIL_KEY_VALUE_1 = VE.EQUIPMENT_ID 
		     AND UE.MAIL_USER_ID = US.MAIL_USER_ID)
		   INNER JOIN RMSCMN.TB_EGN_USR_MST UM WITH(NOLOCK) 
		      ON (UM.USER_ID = US.MAIL_USER_ID)	
		   WHERE VE.EQUIPMENT_ID = #{equipmentId}
		     AND US.MAIL_KEY_VALUE_2 = #{validationCode}

]]>"
sqlserver_insert_TB_RMS_TEMP_SMS_USER,3,"<![CDATA[

    INSERT INTO RMSPLUS.TB_RMS_TEMP_SMS_USER 
		 (FUNCTION_NAME, TRANSACTION_SERIAL_NO, USER_NAME, PHONE_NUMBER, EMAIL_ADDR, ALARM_TYPE_CODE, SMS_SEND_FLAG)
		  SELECT #{functionName} AS FUNCTION_NAME, 
			 #{transactionSerialNo} AS TRANSACTION_SERIAL_NO, 
			 UM.USER_NAME AS USER_NAME, 
			 REPLACE(REPLACE(UM.MOBILE_PHONE_NO,'-',''),' ','') AS PHONE_NUMBER,
			 UM.EMAIL_ADDR AS EMAIL_ADDR,
			 US.MAIL_ATTRIBUTE_2 AS ALARM_TYPE_CODE_CODE,
			 (CASE WHEN #{smsNightSkipFlag} = 'Y' 
			        AND ISNULL(US.MAIL_ATTRIBUTE_3,'N') = 'N' 
			       THEN 'N'
			       WHEN #{smsWeekSkipFlag} = 'Y' 
			        AND ISNULL(US.MAIL_ATTRIBUTE_4,'N') = 'N' 
			       THEN 'N'
			       ELSE 'Y'
			       END) AS SMS_SEND_FLAG  
		    FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK)
		   INNER JOIN RMSPLUS.TB_RMS_MAIL_SMS_USER_INFO US WITH(NOLOCK) 
		      ON (US.FACILITY_CODE = VE.FACILITY_CODE
		     AND US.MAIL_TYPE_CODE = 'MAIL_TYPE_MGR_GROUP'
		     AND US.MAIL_KEY_VALUE_1 = VE.MGR_GROUP_ID)
		   INNER JOIN RMSCMN.TB_EGN_USR_MST UM WITH(NOLOCK) 
		      ON (UM.USER_ID = US.MAIL_USER_ID)	
		   WHERE VE.EQUIPMENT_ID = #{equipmentId}
		     AND US.MAIL_KEY_VALUE_2   = #{validationCode}

]]>"
sqlserver_insert_TB_RMS_VALIDATION_INFO,1,"<![CDATA[

	INSERT INTO RMSPLUS.TB_RMS_VALIDATION_INFO
               (FACILITY_CODE, VALIDATION_SEQ_NO, LAST_TRANSACTION_DATE, PROCESS_CODE, EQUIPMENT_ID, 
                LOT_ID, MATERIAL_ID, EQP_PROD_SPEC_ID, EQP_PROD_SPEC_VERSION, RECIPE_ID, 
                RECIPE_VERSION, RECIPE_MAP_VERSION, EQUIPMENT_RECIPE_ID, VALIDATION_MODE_CODE, VALIDATION_RESULT_CODE, 
                VALIDATION_CODE, PRODUCT_SPECIFICATION_ID, PRODUCT_SPECIFICATION_VERSION, SYSTEM_ERROR_MESSAGE_CONTENT, COLLECTION_TYPE_CODE, 
                PARENT_LOT_ID, PLC_PROGRAM_VERSION, GP_PROGRAM_VERSION, VALIDATION_USER_ID, BATCH_SIZE, 
                TOP_BACK_TYPE_CODE, LAST_UPDATE_USER_ID, LAST_UPDATE_DATE)
         VALUES (#{facilityCode}, #{validationSeqNo}, #{lastTransactionDate}, #{processCode}, #{equipmentId}, 
	         #{lotId}, #{materialId}, #{eqpProdSpecId}, #{eqpProdSpecVersion}, #{recipeId}, 
	         #{recipeVersion}, #{recipeMapVersion}, #{equipmentRecipeId}, #{validationModeCode}, #{validationResultCode}, 
	         #{validationCode}, #{productSpecificationId}, #{rmsProductSpecVersion}, #{systemErrorMessageContent}, #{collectionTypeCode}, 
	         #{parentLotId}, #{plcProgramVersion}, #{gpProgramVersion}, #{validationUserId}, #{batchSize}, 
	         #{topBackTypeCode}, #{lastUpdateUserId}, GETDATE())

]]>"
sqlserver_insert_TB_RMS_VALIDATION_ITEM_INFO,1,"<![CDATA[

	INSERT INTO RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO
	 (FACILITY_CODE, VALIDATION_SEQ_NO, EQUIPMENT_PARAMETER_ID, LAST_TRANSACTION_DATE, EQUIPMENT_ID,
	  RECIPE_ID, RECIPE_VERSION, RECIPE_MAP_VERSION, EQUIPMENT_RECIPE_ID, PARAMETER_ID, EQUIPMENT_VALUE, LSL_VALUE,
	  TARGET_VALUE, USL_VALUE, VALIDATION_RESULT_CODE, SPEC_TYPE_CODE, USE_FLAG,
	  DOWNLOAD_VALUE_FLAG)
	SELECT #{facilityCode} AS FACILITY_CODE,
		#{validationSeqNo} AS VALIDATION_SEQ_NO,  
		PL.EQUIPMENT_PARAMETER_ID,
		#{lastTransactionDate}  AS LAST_TRANSACTION_DATE,
		#{equipmentId} AS EQUIPMENT_ID,
		#{recipeId} AS RECIPE_ID,
		#{recipeVersion} AS RECIPE_VERSION,
		#{recipeMapVersion} AS RECIPE_MAP_VERSION,
		#{equipmentRecipeId} AS EQUIPMENT_RECIPE_ID,
		RMV.PARAMETER_ID,
		PL.REQUEST_VALUE AS EQUIPMENT_VALUE,
		NULL AS LSL_VALUE,
		'' AS TARGET_VALUE,
		NULL AS USL_VALUE,
		(CASE WHEN RMV.PARAMETER_ID IS NULL
		      THEN '1'
		      ELSE '0'
		      END) AS VALIDATION_RESULT_CODE,
		RV.SPEC_TYPE_CODE,
		'Y' AS USE_FLAG,
		NULL AS DOWNLOAD_VALUE_FLAG
	  FROM RMSPLUS.TB_RMS_EQUIPMENT_MST EM WITH(NOLOCK)
	 INNER JOIN RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
	    ON (PL.FUNCTION_NAME = #{functionName}
	   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	   AND PL.PARAMETER_FLAG = 'Y')
	  LEFT OUTER JOIN RMSPLUS.TB_RMS_RECIPE_MAP_VERSION_INFO RMV WITH(NOLOCK)
	    ON (RMV.FACILITY_CODE = EM.FACILITY_CODE
	   AND RMV.RECIPE_ID = #{recipeId}
	   AND RMV.RECIPE_MAP_VERSION = #{recipeMapVersion}
	   AND RMV.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID)
	  LEFT OUTER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
	    ON (RV.FACILITY_CODE = EM.FACILITY_CODE
	   AND RV.RECIPE_ID = #{recipeId}
	   AND RV.RECIPE_VERSION = #{recipeVersion}
	   AND RV.PARAMETER_ID = RMV.PARAMETER_ID)
	 WHERE EM.FACILITY_CODE = #{facilityCode}
	  AND EM.EQUIPMENT_ID = #{equipmentId}

]]>"
sqlserver_insert_TB_RMS_VALIDATION_ITEM_INFO,2,"<![CDATA[

    INSERT INTO RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO
        (FACILITY_CODE, VALIDATION_SEQ_NO, EQUIPMENT_PARAMETER_ID, LAST_TRANSACTION_DATE, EQUIPMENT_ID, 
         RECIPE_ID, RECIPE_VERSION, RECIPE_MAP_VERSION, EQUIPMENT_RECIPE_ID, PARAMETER_ID, EQUIPMENT_VALUE, LSL_VALUE, 
         TARGET_VALUE, USL_VALUE, VALIDATION_RESULT_CODE, SPEC_TYPE_CODE, USE_FLAG, 
         DOWNLOAD_VALUE_FLAG)
    SELECT #{facilityCode} AS FACILITY_CODE,
           #{validationSeqNo} AS VALIDATION_SEQ_NO,  
         PL.EQUIPMENT_PARAMETER_ID,
         #{lastTransactionDate}  AS LAST_TRANSACTION_DATE, 
         #{equipmentId} AS EQUIPMENT_ID,
         #{recipeId} AS RECIPE_ID,
         #{recipeVersion} AS RECIPE_VERSION,
         #{recipeMapVersion} AS RECIPE_MAP_VERSION,
         #{equipmentRecipeId} AS EQUIPMENT_RECIPE_ID,
         EP.PARAMETER_ID,
         PL.REQUEST_VALUE AS EQUIPMENT_VALUE,
         NULL AS LSL_VALUE,
         '' AS TARGET_VALUE,
         NULL AS USL_VALUE,
         (CASE WHEN EP.PARAMETER_ID IS NULL 
               THEN '1' 
               ELSE '0' 
               END) AS VALIDATION_RESULT_CODE,
         RV.SPEC_TYPE_CODE,
         'Y' AS USE_FLAG,
         NULL AS DOWNLOAD_VALUE_FLAG 
      FROM RMSPLUS.TB_RMS_EQUIPMENT_MST EM WITH(NOLOCK)
     INNER JOIN RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK) 
        ON (PL.FUNCTION_NAME = #{functionName} 
       AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
       AND PL.PARAMETER_FLAG = 'Y')
     INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_PARAM_INFO EP WITH(NOLOCK) 
        ON (EP.FACILITY_CODE = EM.FACILITY_CODE 
       AND EP.EQUIPMENT_ID = EM.EQUIPMENT_ID 
       AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID)
     INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO ER WITH(NOLOCK)
        ON (ER.FACILITY_CODE = EM.FACILITY_CODE
       AND ER.EQUIPMENT_ID = EM.EQUIPMENT_ID
       AND ER.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
       AND ER.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion} 
       AND ER.RECIPE_ID = #{recipeId}
       AND ER.RECIPE_VERSION = #{recipeVersion}
       AND ER.RECIPE_MAP_VERSION = #{recipeMapVersion})
     INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
        ON (RV.FACILITY_CODE = EM.FACILITY_CODE
       AND RV.RECIPE_ID = ER.RECIPE_ID
       AND RV.RECIPE_VERSION = ER.RECIPE_VERSION
       AND RV.PARAMETER_ID = EP.PARAMETER_ID)
     INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK)
        ON (PM.FACILITY_CODE = EP.FACILITY_CODE
       AND PM.PARAMETER_ID = EP.PARAMETER_ID
       AND PM.EQUIPMENT_GROUP_ID = EM.EQUIPMENT_GROUP_ID)          
     WHERE EM.FACILITY_CODE = #{facilityCode}
       AND EM.EQUIPMENT_ID = #{equipmentId}

]]>"
sqlserver_insert_TB_RMS_VALIDATION_ITEM_INFO_cust,1,"<![CDATA[

			WITH TEMP_TB_MIX_MATERIAL AS
				 (SELECT EP.PARAMETER_ID, 
				         GP.STEP_SEQ_NO, 
				         GP.MATERIAL_SEQ_NO, 
				         ISNULL(MM.MATERIAL_ID, '') AS MATERIAL_ID, 
				         ISNULL(MMC.MATERIAL_NAME, '') AS MATERIAL_NAME, 
						 ROW_NUMBER() OVER (PARTITION BY GP.STEP_SEQ_NO, 
						  								 (CASE WHEN ISNULL(MMC.MATERIAL_NAME,'') = '' 
						                                       THEN '' 
						                                       ELSE MM.MATERIAL_ID 
						                                       END) ORDER BY MATERIAL_SEQ_NO
						                   ) AS STEP_MATERIAL_SEQ
				    FROM RMSPLUS.TB_RMS_PARAMETER_MST GP WITH(NOLOCK) 
				   INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
				      ON (EP.EQUIPMENT_ID = #{equipmentId} 
					 AND EP.PARAMETER_ID = GP.PARAMETER_ID)
					 AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
					 AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
					 AND EP.RECIPE_ID = #{recipeId}
					 AND EP.RECIPE_VERSION = #{recipeVersion}
					 AND EP.RECIPE_MAP_VERSION = #{recipeMapVersion}
					LEFT OUTER JOIN RMSPLUS.TB_COM_MIX_MATERIAL_INFO MM WITH(NOLOCK) 
					  ON (MM.FACILITY_CODE  = EP.FACILITY_CODE 
					 AND MM.EQUIPMENT_ID = #{equipmentId}
					 AND MM.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
					 AND MM.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion} 
					 AND MM.PARAMETER_ID = EP.PARAMETER_ID 
					 AND ISNULL(MM.MATERIAL_ID, '') <> '') 
					LEFT OUTER JOIN RMSPLUS.TB_COM_MIX_MATERIAL_CODE_MST MMC WITH(NOLOCK) 
					  ON (MMC.MATERIAL_ID = MM.MATERIAL_ID) 
				   WHERE GP.FACILITY_CODE = #{facilityCode}
				  	 AND GP.MATERIAL_NAME_FLAG = 'Y'),
			     TEMP_TB_MIX_REPMATERIAL AS
				  (SELECT EP.RECIPE_ID, 
                                          EP.RECIPE_VERSION, 
                                          GP.PARAMETER_ID, 
                                          GP.STEP_SEQ_NO, 
				          GP.MATERIAL_SEQ_NO, 
                                          ISNULL(MM.ALTERNATIVE_MATERIAL_ID, '') AS ALTERNATIVE_MATERIAL_ID, 
                                          ISNULL(MMC.MATERIAL_NAME, '') AS ALTERNATIVE_MATERIAL_NAME, 
				          ROW_NUMBER() OVER (PARTITION BY GP.STEP_SEQ_NO, MM.ALTERNATIVE_MATERIAL_ID ORDER BY GP.MATERIAL_SEQ_NO) AS STEP_MATERIAL_SEQ
			             FROM RMSPLUS.TB_RMS_PARAMETER_MST GP WITH(NOLOCK) 
				    INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
				       ON (EP.FACILITY_CODE = GP.FACILITY_CODE
				      AND EP.EQUIPMENT_ID = #{equipmentId} 
				      AND EP.PARAMETER_ID = GP.PARAMETER_ID
				      AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
				      AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
				      AND EP.RECIPE_ID = #{recipeId}
				      AND EP.RECIPE_VERSION = #{recipeVersion}
				      AND EP.RECIPE_MAP_VERSION = #{recipeMapVersion})
				     LEFT OUTER JOIN RMSPLUS.TB_COM_MIX_MATERIAL_ALT MM WITH(NOLOCK) 
				       ON (MM.FACILITY_CODE = GP.FACILITY_CODE  
				      AND MM.EQUIPMENT_ID = #{equipmentId}
				      AND MM.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
				      AND MM.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
				      AND MM.PARAMETER_ID = EP.PARAMETER_ID 
				      AND ISNULL(MM.ALTERNATIVE_MATERIAL_ID, '') <> '') 
				     LEFT OUTER JOIN RMSPLUS.TB_COM_MIX_MATERIAL_CODE_MST MMC WITH(NOLOCK) 
				       ON (MMC.MATERIAL_ID = MM.ALTERNATIVE_MATERIAL_ID) 
				    WHERE GP.FACILITY_CODE = #{facilityCode}
				      AND GP.MATERIAL_NAME_FLAG = 'Y'),
			     TEMP_TB_PARAMETER_LIST AS 
			        (SELECT PL.EQUIPMENT_PARAMETER_ID, 
			                PL.REQUEST_VALUE, 
			                SUBSTRING(RIGHT(PL.EQUIPMENT_PARAMETER_ID, 5), 1, 2) AS STEP_SEQ_NO, 
			                PL.REQUEST_VALUE AS MATERIAL_ID, 
			                ROW_NUMBER() OVER(PARTITION BY SUBSTRING(RIGHT(PL.EQUIPMENT_PARAMETER_ID, 5), 1, 2), 
			                PL.REQUEST_VALUE ORDER BY PL.EQUIPMENT_PARAMETER_ID) AS STEP_MATERIAL_SEQ
			           FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
			          WHERE PL.PARAMETER_FLAG = 'Y'  
			            AND PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId})  -- Mixing ê³µì • ì¤??ë£Œëª?I/F??EQUIPMENT_PARAMETER_IDê°€ 'EV+ì°¨ìˆ˜(2)+A'ë¡??œìž‘ ?? 
			INSERT RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO
			 (FACILITY_CODE, VALIDATION_SEQ_NO, EQUIPMENT_PARAMETER_ID, LAST_TRANSACTION_DATE, EQUIPMENT_ID, 
			  RECIPE_ID, RECIPE_VERSION, RECIPE_MAP_VERSION, PARAMETER_ID, EQUIPMENT_VALUE, LSL_VALUE, 
			  TARGET_VALUE, USL_VALUE, VALIDATION_RESULT_CODE, SPEC_TYPE_CODE, USE_FLAG )   			         
			SELECT #{facilityCode} AS FACILITY_CODE,
			       #{validationSeqNo} AS VALIDATION_SEQ_NO,
			       DT.EQUIPMENT_PARAMETER_ID AS EQUIPMENT_PARAMETER_ID,
			       #{lastTransactionDate} AS LAST_TRANSACTION_DATE,
			       #{equipmentId} AS EQUIPMENT_ID,
			       #{recipeId} AS RECIPE_ID, 
			       #{recipeVersion} AS RECIPE_VERSION,
			       #{recipeMapVersion} AS RECIPE_MAP_VERSION,
			       DT.PARAMETER_ID AS PARAMETER_ID,
			       DT.REQUEST_VALUE AS EQUIPMENT_VALUE,
                               NULL AS LSL_VALUE,
                               '' AS TARGET_VALUE,
                               NULL AS USL_VALUE,			       
			      (CASE WHEN DT.PARAMETER_ID IS NULL 
			            THEN '1' 
			            ELSE '0' 
			            END) AS VALIDATION_RESULT_CODE,
			       'F' AS SPEC_TYPE_CODE,
			       'Y' AS USE_FLAG
			  FROM (SELECT PL.EQUIPMENT_PARAMETER_ID, 
			               MIN(PL.REQUEST_VALUE) AS REQUEST_VALUE, 
				       MIN((CASE WHEN ISNULL(MM.PARAMETER_ID,'') ='' 
				                 THEN MR.PARAMETER_ID 
				  	         ELSE MM.PARAMETER_ID  
					         END)) AS PARAMETER_ID  				  
			         FROM TEMP_TB_PARAMETER_LIST PL WITH(NOLOCK)
			         LEFT OUTER JOIN TEMP_TB_MIX_MATERIAL MM WITH(NOLOCK) 
			           ON (MM.STEP_SEQ_NO = PL.STEP_SEQ_NO  
				  AND (REPLACE(REPLACE(REPLACE(SUBSTRING(PL.MATERIAL_ID,1,10), '_', ''), '-', ''), ' ', '') = REPLACE(REPLACE(REPLACE(SUBSTRING(MM.MATERIAL_ID,1,10), '_', ''), '-', ''), ' ', '') 
				   		        OR 
				   		        REPLACE(REPLACE(REPLACE(SUBSTRING(PL.MATERIAL_ID,1,10), '_', ''), '-', ''), ' ', '') = REPLACE(REPLACE(REPLACE(SUBSTRING(MM.MATERIAL_NAME,1,10), '_', ''), '-', ''), ' ', '')
				   		       ) 
				   		   AND  MM.STEP_MATERIAL_SEQ = PL.STEP_MATERIAL_SEQ)
				   	 LEFT OUTER JOIN TEMP_TB_MIX_REPMATERIAL MR WITH(NOLOCK) 
				   	   ON (MR.STEP_SEQ_NO = PL.STEP_SEQ_NO  
						   AND (REPLACE(REPLACE(REPLACE(SUBSTRING(PL.MATERIAL_ID,1,10), '_', ''), '-', ''), ' ', '') = REPLACE(REPLACE(REPLACE(SUBSTRING(MR.ALTERNATIVE_MATERIAL_ID,1,10), '_', ''), '-', ''), ' ', '') 
						        OR 
						        REPLACE(REPLACE(REPLACE(SUBSTRING(PL.MATERIAL_ID,1,10), '_', ''), '-', ''), ' ', '') = REPLACE(REPLACE(REPLACE(SUBSTRING(MR.ALTERNATIVE_MATERIAL_NAME,1,10), '_', ''), '-', ''), ' ', '')
						       )
						   AND MR.STEP_MATERIAL_SEQ = PL.STEP_MATERIAL_SEQ) 
					GROUP BY PL.EQUIPMENT_PARAMETER_ID
				 ) DT

]]>"
sqlserver_insert_TB_RMS_VALIDATION_ITEM_INFO_cust,2,"<![CDATA[

		INSERT RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO
			  (FACILITY_CODE, VALIDATION_SEQ_NO, EQUIPMENT_PARAMETER_ID, LAST_TRANSACTION_DATE, EQUIPMENT_ID, 
			   RECIPE_ID, RECIPE_VERSION, RECIPE_MAP_VERSION, PARAMETER_ID, EQUIPMENT_VALUE, LSL_VALUE, 
			   TARGET_VALUE, USL_VALUE, VALIDATION_RESULT_CODE, SPEC_TYPE_CODE, USE_FLAG)    			      
			SELECT DT.FACILITY_CODE,
			       #{validationSeqNo} AS VALIDATION_SEQ_NO,
                   DT.EQUIPMENT_PARAMETER_ID,
			       #{lastTransactionDate} AS LAST_TRANSACTION_DATE,
			       #{equipmentId} AS EQUIPMENT_ID,
				   #{recipeId} AS RECIPE_ID, 
				   #{recipeVersion} AS RECIPE_VERSION,
				   #{recipeMapVersion} AS RECIPE_MAP_VERSION,
                   DT.PARAMETER_ID AS PARAMETER_ID,
                   DT.REQUEST_VALUE  AS EQUIPMENT_VALUE,
                   NULL AS LSL_VALUE,
                   '' AS TARGET_VALUE,
                   NULL AS USL_VALUE,
                   (CASE WHEN PM.PARAMETER_ID IS NULL 
                         THEN '1' 
                         ELSE '0' 
                         END) AS VALIDATION_RESULT_CODE,
                   PM.SPEC_TYPE_CODE,
                   'Y' AS USE_FLAG
              FROM (SELECT #{facilityCode} AS FACILITY_CODE, 
					       PL.EQUIPMENT_PARAMETER_ID, 
						   PL.REQUEST_VALUE, 
						   (SELECT MIN(EP.PARAMETER_ID)
						      FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK) 
							 INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK) 
								ON (PM.FACILITY_CODE = DH.FACILITY_CODE 
							   AND PM.PARAMETER_ID = DH.PARAMETER_ID)
							 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
								ON (EP.FACILITY_CODE = PM.FACILITY_CODE 
							   AND EP.EQUIPMENT_ID = DH.EQUIPMENT_ID 
							   AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
							   AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
							   AND EP.RECIPE_ID = #{recipeId}
							   AND EP.RECIPE_VERSION = #{recipeVersion}
							   AND EP.EQUIPMENT_PARAMETER_ID = SUBSTRING(PL.EQUIPMENT_PARAMETER_ID, 1, LEN(PL.EQUIPMENT_PARAMETER_ID)-2) + RMSPLUS.FN_LPAD(CONVERT(NVARCHAR(4), PM.MATERIAL_SEQ_NO), '0', 2))
						    WHERE DH.FACILITY_CODE = #{facilityCode}
						      AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
						      AND DH.EQUIPMENT_PARAMETER_ID = SUBSTRING(PL.EQUIPMENT_PARAMETER_ID, 1, LEN(PL.EQUIPMENT_PARAMETER_ID)-3)+'A'+RIGHT(PL.EQUIPMENT_PARAMETER_ID, 2)
						      AND DH.EQUIPMENT_ID = #{equipmentId}
						   ) AS PARAMETER_ID
					  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
					 WHERE PL.FUNCTION_NAME = #{functionName}
		          	   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		          	   AND (PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId1} 
		          	        OR 
		          	        PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId2})  -- Mixing ?ìž¬ë£??¬ìž…??I/F??TAGIDê°€ 'EV+ì°¨ìˆ˜(2)+B'ë¡? ?ë£Œ?¬ìš©?¬ë? 'EV+ì°¨ìˆ˜(2)+C' ?œìž‘ ??  
					   AND PL.PARAMETER_FLAG = 'Y'
		           ) DT
		           LEFT OUTER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK) 
		            ON (PM.FACILITY_CODE = #{facilityCode} AND PM.PARAMETER_ID = DT.PARAMETER_ID)

]]>"
sqlserver_insert_TB_RMS_VALIDATION_ITEM_INFO_cust,3,"<![CDATA[

		INSERT RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO
				  ( FACILITY_CODE, VALIDATION_SEQ_NO, EQUIPMENT_PARAMETER_ID, LAST_TRANSACTION_DATE, EQUIPMENT_ID, 
				    RECIPE_ID, RECIPE_VERSION, RECIPE_MAP_VERSION, PARAMETER_ID, EQUIPMENT_VALUE, LSL_VALUE, 
				    TARGET_VALUE, USL_VALUE, VALIDATION_RESULT_CODE, SPEC_TYPE_CODE, USE_FLAG )
			SELECT #{facilityCode} AS FACILITY_CODE, 
			       #{validationSeqNo} AS VALIDATION_SEQ_NO,  
				   PL.EQUIPMENT_PARAMETER_ID,
				   #{lastTransactionDate}  AS LAST_TRANSACTION_DATE, 
				   #{equipmentId} AS EQUIPMENT_ID,
				   #{recipeId} AS RECIPE_ID,
				   #{recipeVersion} AS RECIPE_VERSION,
				   #{recipeMapVersion} AS RECIPE_MAP_VERSION,
				   EP.PARAMETER_ID,
				   PL.REQUEST_VALUE AS EQUIPMENT_VALUE,
				   NULL AS LSL_VALUE,
				   NULL AS TARGET_VALUE,
				   NULL AS USL_VALUE,
				   (CASE WHEN EP.PARAMETER_ID IS NULL 
				         THEN '1' 
				         ELSE '0' 
				         END) AS VALIDATION_RESULT_CODE,
				   EP.SPEC_TYPE_CODE,
				   'Y' AS USE_FLAG  
			  FROM RMSPLUS.TB_RMS_EQUIPMENT_MST EQ WITH(NOLOCK)
			 INNER JOIN RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
			    ON (PL.FUNCTION_NAME = #{functionName} 
			        AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}) 
			  LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
			    ON (EP.FACILITY_CODE = EQ.FACILITY_CODE 
			        AND EP.EQUIPMENT_ID = EQ.EQUIPMENT_ID 
			        AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID
			        AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
					AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
					AND EP.RECIPE_ID = #{recipeId}
					AND EP.RECIPE_VERSION = #{recipeVersion}
					AND EP.RECIPE_MAP_VERSION = #{recipeMapVersion}
			        )
			 WHERE EQ.FACILITY_CODE = #{facilityCode} 
			   AND EQ.EQUIPMENT_ID = #{equipmentId}
			   AND PL.PARAMETER_FLAG      = 'Y' 
			   AND PL.EQUIPMENT_PARAMETER_ID NOT LIKE '%EV__A__'  				   -- ?ë£Œëª?Para:'EV+ì°¨ìˆ˜(2)+A+SEQ(2)' 
			   AND PL.EQUIPMENT_PARAMETER_ID NOT LIKE '%EV__B__'  				   -- ?ë£Œ?¤ì •ê°?Para:'EV+ì°¨ìˆ˜(2)+B+SEQ(2)'
			   AND PL.EQUIPMENT_PARAMETER_ID NOT LIKE '%.EV__C__';                 -- ?ë£Œ?¬ìš©?¬ë? Para:'EV+ì°¨ìˆ˜(2)+C+SEQ(2)', ?ë£Œë¬´ê? Para:?ë£Œëª?Para:'EV+ì°¨ìˆ˜(2)+V+SEQ(2)'

]]>"
sqlserver_select_DUAL,1,"<![CDATA[

	
			SELECT #{equipmentId} AS EQUIPMENT_ID,
				   #{validationResultCode} AS VALIDATION_RESULT_CODE,
				   #{validationErrorCode} AS VALIDATION_ERROR_CODE,
				   RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationCode}, 'ERROR_MESSAGE', #{hmiLanguageCode}) AS ERROR_MESSAGE,
				   #{productSpecificationId} AS PRODUCT_SPECIFICATION_ID,
				   #{productSpecificationVersion} AS PRODUCT_SPECIFICATION_VERSION,
				   #{recipeId} AS RECIPE_ID,
				   #{recipeVersion} AS RECIPE_VERSION,
				   #{parameterTotalCount} AS PARAMETER_TOTAL_COUNT,
				   #{parameterNGCount} AS PARAMETER_NG_COUNT 
	
	
]]>"
sqlserver_select_DUAL,2,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID,
			   #{validationResultCode} AS VALIDATION_RESULT_CODE,
			   RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationErrorCode}, 'ERROR_CODE', #{hmiLanguageCode}) AS VALIDATION_ERROR_CODE,
			   RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationErrorCode}, 'ERROR_MESSAGE', #{hmiLanguageCode}) AS ERROR_MESSAGE,
			   #{productSpecificationId} AS PRODUCT_SPECIFICATION_ID,
			   #{productSpecificationVersion} AS PRODUCT_SPECIFICATION_VERSION,
			   #{recipeId} AS RECIPE_ID,
			   #{recipeVersion} AS RECIPE_VERSION,
			   #{equipmentRecipeId} AS EQUIPMENT_RECIPE_ID,
			   #{parameterTotalCount} AS PARAMETER_TOTAL_COUNT,
			   #{parameterNGCount} AS PARAMETER_NG_COUNT 
	
	
]]>"
sqlserver_select_DUAL,3,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID,  
				(CASE WHEN #{validationResultCode}='0' 
				      THEN '10' 
				      ELSE '11' 
				      END) AS VALIDATION_RESULT_CODE,  
				RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationErrorCode}, 'ERROR_CODE', #{hmiLanguageCode}) AS VALIDATION_ERROR_CODE,
				RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationErrorCode}, 'ERROR_MESSAGE',  #{hmiLanguageCode}) AS ERROR_MESSAGE,
				#{productSpecificationId} AS PRODUCT_SPECIFICATION_ID,  
				#{productSpecificationVersion} AS PRODUCT_SPECIFICATION_VERSION,
				#{equipmentParameterId} AS EQUIPMENT_PARAMETER_ID,
				#{gradeCode} AS GRADE_CODE,     --GRADE
				#{equipmentValue} AS EQUIPMENT_VALUE,
				#{lslValue} AS LSL_VALUE,
				#{targetValue} AS TARGET_VALUE,
				#{uslValue} AS USL_VALUE,
				CASE WHEN ISNULL(#{useFlag},'N')='Y' 
				     THEN '1' 
				     ELSE '0' 
				     END AS USE_FLAG 
	
	
]]>"
sqlserver_select_DUAL,4,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID,  
			   #{validationResultCode} AS VALIDATION_RESULT_CODE,  
			   #{validationErrorCode} AS VALIDATION_ERROR_CODE,
			   RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationCode}, 'ERROR_MESSAGE',  #{hmiLanguageCode}) AS ERROR_MESSAGE,
			   #{productSpecificationId} AS PRODUCT_SPECIFICATION_ID,  
			   #{productSpecificationVersion} AS PRODUCT_SPECIFICATION_VERSION,
			   #{equipmentParameterId} AS EQUIPMENT_PARAMETER_ID,
			   #{gradeCode} AS GRADE_CODE,    
			   #{equipmentValue} AS EQUIPMENT_VALUE,
			   #{lslValue} AS LSL_VALUE,
			   #{targetValue} AS TARGET_VALUE,
			   #{uslValue} AS USL_VALUE,
			   (CASE WHEN ISNULL(#{useFlag},'N')='Y' 
				     THEN '1' 
				     ELSE '0' 
				     END) AS USE_FLAG
	
	
]]>"
sqlserver_select_DUAL,5,"<![CDATA[

	
		SELECT  #{equipmentId} AS EQUIPMENT_ID, 
	       		(CASE WHEN #{validationResultCode}='0' 
	       		      THEN '10' --10:OK
	       			  ELSE '11' --11:NG
	       			  END) AS VALIDATION_RESULT_CODE,   
		   		RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationErrorCode}, 'ERROR_CODE', #{hmiLanguageCode}) AS VALIDATION_ERROR_CODE,
		   		RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationErrorCode}, 'ERROR_MESSAGE', #{hmiLanguageCode}) AS ERROR_MESSAGE,
           		GETDATE() AS NOW_DATE 
	
	
]]>"
sqlserver_select_DUAL,6,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID,  
				(CASE WHEN #{validationResultCode}='0' 
				      THEN '10' 
				      ELSE '11' 
				      END) AS VALIDATION_RESULT_CODE,  
				RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationErrorCode}, 'ERROR_CODE', #{hmiLanguageCode}) AS VALIDATION_ERROR_CODE,
				RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationErrorCode}, 'ERROR_MESSAGE',  #{hmiLanguageCode}) AS ERROR_MESSAGE,
				#{productSpecificationId} AS PRODUCT_SPECIFICATION_ID,  
				#{productSpecificationVersion} AS PRODUCT_SPECIFICATION_VERSION,
				#{equipmentParameterId} AS EQUIPMENT_PARAMETER_ID,                 
		        #{parameterName} AS PARAMETER_NAME,     --HMI PARAëª?
		        #{gradeCode} AS GRADE_CODE,     --GRADE
		        #{lslValue} AS LSL_VALUE,
		        #{targetValue} AS TARGET_VALUE,
		        #{uslValue} AS USL_VALUE
	
	
]]>"
sqlserver_select_DUAL,7,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID,  
			   #{validationResultCode} AS VALIDATION_RESULT_CODE,  
			   #{validationErrorCode} AS VALIDATION_ERROR_CODE,
			   RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationErrorCode}, 'ERROR_MESSAGE',  #{hmiLanguageCode}) AS ERROR_MESSAGE,
			   #{productId} AS PRODUCT_ID,  
			   #{productVersion} AS PRODUCT_VERSION,
			   #{equipmentParameterId} AS EQUIPMENT_PARAMETER_ID,
			   #{parameterName} AS PARAMETER_NAME,    
			   #{gradeCode} AS GRADE_CODE,
			   #{lslValue} AS LSL_VALUE,
			   #{targetValue} AS TARGET_VALUE,
			   #{uslValue} AS USL_VALUE
	
	
]]>"
sqlserver_select_TB_COM_ERROR_CODE,1,"<![CDATA[

		SELECT MULTI_LANGUAGE_TYPE_CODE, MULTI_LANGUAGE_CODE, TERM_DESC
		  FROM RMSCMN.TB_EGN_MULTI_LANG_DICT LANG WITH(NOLOCK)
		 WHERE LANG.TERM_TYPE_CODE = #{termTypeCode}
	   	   AND MULTI_LANGUAGE_TYPE_CODE = #{multiLangugeTypeCode}	
                   AND LANG.MULTI_LANGUAGE_CODE = (
			   SELECT LANGUAGE_KEY_CODE
		  	     FROM RMSPLUS.TB_COM_ERROR_CODE EC WITH(NOLOCK)
         	 	    WHERE EC.FACILITY_CODE = #{facilityCode}
		 	      AND EC.FUNCTION_NAME = #{functionName}
		 	      AND EC.ERROR_CODE = #{errorCode})

]]>"
sqlserver_select_TB_COM_MIX_MATERIAL_INFO,1,"<![CDATA[

	
		SELECT COUNT(*) AS CNT
		  FROM RMSPLUS.TB_COM_MIX_MATERIAL_INFO MM WITH(NOLOCK) 
		 WHERE MM.FACILITY_CODE = #{facilityCode}
		   AND MM.EQUIPMENT_ID = #{equipmentId}
		   AND MM.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
		   AND MM.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
		   AND ISNULL(MM.MATERIAL_ID, '') != ''
	
	
]]>"
sqlserver_select_TB_COM_PRODUCT_SPEC_MST,1,"<![CDATA[

	
		SELECT ISNULL(RMSPLUS.FN_GET_LANG_DATA(#{basicLang}, MM.MODEL_NAME), ISNULL(PM.MODEL_ID, '')) AS PRODUCT_SPECIFICATION_NAME
		  FROM RMSPLUS.TB_COM_PRODUCT_SPEC_MST PM WITH(NOLOCK) 
	          LEFT OUTER JOIN RMSPLUS.TB_COM_MODEL_MST MM WITH(NOLOCK) 
	            ON (MM.MODEL_ID = PM.MODEL_ID)
		 WHERE PM.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
	
	
]]>"
sqlserver_select_TB_EGN_CODE_ITEM_INFO,1,"<![CDATA[

	
		SELECT RMSPLUS.FN_GET_LANG_DATA(#{basicLanguageCode}, CD.BUSINESS_USAGE_CODE_DESC) AS VALIDATION_CODE_NAME     
	  	  FROM RMSCMN.TB_EGN_CODE_ITEM_INFO CD WITH(NOLOCK) 
	     WHERE CD.FACILITY_CODE = #{facilityCode} 
	       AND CD.BUSINESS_USAGE_TYPE_CODE = #{businessUsageTypeCode} 
	       AND CD.BUSINESS_USAGE_CODE_ID = #{businessUsageCodeId}
	
	
]]>"
sqlserver_select_TB_EGN_CODE_ITEM_INFO,2,"<![CDATA[

	
		SELECT BUSINESS_USAGE_CODE_ID, BUSINESS_USAGE_CODE_DESC, ATTRIBUTE1, USE_FLAG 
  		  FROM RMSCMN.TB_EGN_CODE_ITEM_INFO WITH(NOLOCK)
 		 WHERE FACILITY_CODE = #{facilityCode}
   		   AND BUSINESS_USAGE_TYPE_CODE = #{businessUsageTypeCode}
	
	
]]>"
sqlserver_select_TB_MES_EQUIP_PRODUCT_INFO,1,"<![CDATA[  

SELECT TOP 1 
       CP.FACILITY_CODE, EQUIPMENT_ID, CP.PRODUCT_SPECIFICATION_ID, CP.PRODUCT_SPECIFICATION_VERSION, CP.WORK_STARTDATE
  FROM RMSPLUS.TB_MES_EQUIP_PRODUCT_INFO CP WITH(NOLOCK)
 WHERE CP.FACILITY_CODE = #{facilityCode}
   AND CP.EQUIPMENT_ID = #{equipmentId}
 ORDER BY CP.WORK_STARTDATE DESC  
 
 ]]>"
sqlserver_select_TB_MES_LOT_INFO,1,"<![CDATA[

	
		SELECT ISNULL(MIN(ML.PRODUCT_SPECIFICATION_ID), #{productSpecificationId}) AS PRODUCT_SPECIFICATION_ID,
			   ISNULL(MIN(ML.PROD_SPEC_TYPE_CODE),'') AS PROD_SPEC_TYPE_CODE, 
			   ISNULL(MIN(CCD.ATTRIBUTE1),'N') AS VALIDATION_FLAG
		  FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK)
		  LEFT OUTER JOIN RMSPLUS.TB_RMS_CODE_ITEM_INFO CD WITH(NOLOCK) 
			ON (CD.FACILITY_CODE =#{facilityCode} 
		       AND CD.BUSINESS_USAGE_TYPE_CODE ='LOT_TYPE' 
		       AND CD.BUSINESS_USAGE_CODE_ID = ML.PROD_SPEC_TYPE_CODE)
		  LEFT OUTER JOIN RMSCMN.TB_EGN_CODE_ITEM_INFO CCD WITH(NOLOCK) 
		    ON (CCD.FACILITY_CODE = CD.FACILITY_CODE 
		   AND CCD.BUSINESS_USAGE_TYPE_CODE = CD.BUSINESS_USAGE_TYPE_CODE 
		   AND CCD.BUSINESS_USAGE_CODE_ID = CD.BUSINESS_USAGE_CODE_ID)			 
		 WHERE (ML.LOT_ID = #{lotId} OR (#{recipeIdPrefixValue} ='COT' AND ML.LARGE_LOT_ID = #{lotId})) 
		   AND ML.USE_FLAG='Y'
	
	
]]>"
sqlserver_select_TB_MES_LOT_INFO,2,"<![CDATA[

	
		SELECT ISNULL(MIN(ML.PRODUCT_SPECIFICATION_ID), #{productSpecificationId}) AS LOT_PRODUCT_SPECIFICATION_ID
		  FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK) 
		 WHERE (ML.LOT_ID = #{lotId} OR (#{recipeIdPrefixValue} ='COT' AND ML.LARGE_LOT_ID = #{lotId}))
	
	
]]>"
sqlserver_select_TB_MES_LOT_INFO,3,"<![CDATA[

	
		SELECT ISNULL(MIN(ML.PRODUCT_SPECIFICATION_ID), #{productSpecificationId}) AS LOT_PRODUCT_SPECIFICATION_ID
		  FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK) 
		 WHERE (ML.LOT_ID = #{lotId} OR (#{recipeIdPrefixValue} ='COT' AND ML.LARGE_LOT_ID = #{lotId}))
		   AND ML.USE_FLAG='Y'
	
	
]]>"
sqlserver_select_TB_MES_LOT_INFO,4,"<![CDATA[

	
	SELECT TOP 1
	       ISNULL(MIN(ML.PRODUCT_SPECIFICATION_ID), 'X') AS LOT_PRODUCT_SPECIFICATION_ID,
               ISNULL(MIN(ML.PRODUCT_SPECIFICATION_VERSION), '') AS LOT_PROD_SPEC_VERSION
	  FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK)
	 WHERE (ML.LOT_ID = #{lotId} OR ( ML.LARGE_LOT_ID  = #{lotId} AND ML.LOT_TYPE_CODE = #{lotType}) )
	   AND ML.USE_FLAG = 'Y'
	
	
]]>"
sqlserver_select_TB_MES_LOT_INFO,5,"<![CDATA[

	
		SELECT LOT_ID, PLANT_CODE, FACILITY_CODE, FACTORY_AREA_ID, LOT_TYPE_CODE,
		       PRODUCT_SPECIFICATION_ID, ROUTE_ID, LARGE_LOT_ID, COATER_LOT_ID, PARENT_LOT_ID,
		       ELECTRODE_TYPE_CODE, PRODUCT_SPECIFICATION_VERSION, MODEL_ID, LOT_ORIGIN_TYPE_CODE, USE_FLAG,
		       LAST_UPDATE_DATE, PROD_SPEC_TYPE_CODE, LOT_STATUS_VALUE
		  FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK)
	     WHERE ML.LOT_ID = #{lotId}
	       AND ML.USE_FLAG = 'Y'
	
	
]]>"
sqlserver_select_TB_MES_LOT_INFO,6,"<![CDATA[

	SELECT WC.LOT_ID, WC.FACILITY_CODE, EP.PROCESS_CODE, EP.EQUIPMENT_ID, EP.PRODUCT_SPECIFICATION_ID, 
	       EP.PRODUCT_SPECIFICATION_VERSION, EP.RECIPE_ID, EP.RECIPE_VERSION, EP.RECIPE_MAP_VERSION 
	  FROM RMSPLUS.VW_WIP_CURRENT WC WITH(NOLOCK)
	 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP 
            ON (EP.FACILITY_CODE = WC.FACILITY_CODE 
           AND EP.EQUIPMENT_ID = WC.EQUIPMENT_ID 
           AND EP.PRODUCT_SPECIFICATION_ID = WC.PRODUCT_SPECIFICATION_ID 
           AND EP.PRODUCT_SPECIFICATION_VERSION = '000' 
           AND EP.USE_FLAG = 'Y')

]]>"
sqlserver_select_TB_MES_LOT_INFO,7,"<![CDATA[

	
		SELECT ML.PRODUCT_SPECIFICATION_ID AS PRODUCT_SPECIFICATION_ID,
		       ML.PRODUCT_SPECIFICATION_VERSION AS PRODUCT_SPECIFICATION_VERSION
	      FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK)
	     WHERE ML.LOT_ID = #{lotId}
	       AND ML.USE_FLAG = 'Y'
	
	
]]>"
sqlserver_select_TB_RMS_BATCH_JOB_INFO,1,"<![CDATA[

    SELECT FACILITY_CODE, 
           BATCH_ID, 
           ISNULL(RUN_FLAG, 'N') AS RUN_FLAG, 
           ISNULL(USE_FLAG, 'N') AS USE_FLAG 
      FROM RMSPLUS.TB_RMS_BATCH_JOB_INFO WITH(NOLOCK)
     WHERE BATCH_ID = #{batchJobId}

]]>"
sqlserver_select_TB_RMS_CODE_ITEM_INFO,1,"<![CDATA[

	SELECT CD.KEY1, CD.KEY2, CCD.ATTRIBUTE1, CCD.ATTRIBUTE2, CCD.ATTRIBUTE3, 
	       CCD.ATTRIBUTE4, CCD.ATTRIBUTE5, CD.ATTRIBUTE6, CD.ATTRIBUTE7, CD.ATTRIBUTE8   
	  FROM RMSPLUS.TB_RMS_CODE_ITEM_INFO CD WITH(NOLOCK)
	 INNER JOIN RMSCMN.TB_EGN_CODE_ITEM_INFO CCD WITH(NOLOCK) 
		ON (CCD.FACILITY_CODE = CD.FACILITY_CODE 
	   AND CCD.BUSINESS_USAGE_TYPE_CODE = CD.BUSINESS_USAGE_TYPE_CODE 
	   AND CCD.BUSINESS_USAGE_CODE_ID = CD.BUSINESS_USAGE_CODE_ID)
	 WHERE CD.BUSINESS_USAGE_TYPE_CODE = #{codeGroupId}
	   AND CD.FACILITY_CODE = (SELECT FACILITY_CODE 
	                             FROM RMSPLUS.TB_RMS_EQUIPMENT_MST WITH(NOLOCK)
		  		    WHERE EQUIPMENT_ID = #{equipmentId})

]]>"
sqlserver_select_TB_RMS_CODE_ITEM_INFO,2,"<![CDATA[
	
	SELECT ISNULL(MIN(CD.BUSINESS_USAGE_CODE_ID),'en-US') AS CODE_ID
	  FROM RMSPLUS.TB_RMS_CODE_ITEM_INFO CD WITH(NOLOCK)
	 INNER JOIN RMSCMN.TB_EGN_CODE_ITEM_INFO CCD WITH(NOLOCK) 
		ON (CCD.FACILITY_CODE = CD.FACILITY_CODE 
	   AND CCD.BUSINESS_USAGE_TYPE_CODE = CD.BUSINESS_USAGE_TYPE_CODE 
	   AND CCD.BUSINESS_USAGE_CODE_ID = CD.BUSINESS_USAGE_CODE_ID)
	 WHERE CD.BUSINESS_USAGE_TYPE_CODE = #{businessUsageTypeCode}
	   AND CD.KEY1 = #{key01}

]]>"
sqlserver_select_TB_RMS_CODE_ITEM_INFO,3,"<![CDATA[

	SELECT RMSPLUS.FN_GET_LANG_DATA(#{basicLang}, CCD.BUSINESS_USAGE_CODE_DESC) AS CODE_NAME,
       	   ISNULL(CCD.ATTRIBUTE1, 'N') AS ATTRIBUTE1
	  FROM RMSPLUS.TB_RMS_CODE_ITEM_INFO CD WITH(NOLOCK)
	 INNER JOIN RMSCMN.TB_EGN_CODE_ITEM_INFO CCD WITH(NOLOCK) 
            ON (CCD.FACILITY_CODE = CD.FACILITY_CODE 
	   AND CCD.BUSINESS_USAGE_TYPE_CODE = CD.BUSINESS_USAGE_TYPE_CODE 
	   AND CCD.BUSINESS_USAGE_CODE_ID = CD.BUSINESS_USAGE_CODE_ID)
	 WHERE CCD.FACILITY_CODE = #{facilityCode}	    
	   AND CCD.BUSINESS_USAGE_TYPE_CODE = #{codeGroupId} 
	   AND CCD.BUSINESS_USAGE_CODE_ID = #{codeId}

]]>"
sqlserver_select_TB_RMS_CODE_ITEM_INFO,4,"<![CDATA[

	SELECT (CASE WHEN SMS_WEEK_SKIP_FLAG ='Y' OR SMS_NIGHT_SKIP_FLAG ='Y' 
		     THEN 'Y' 
		     ELSE 'N' 
		     END) AS SKIP_FLAG,
	        SMS_WEEK_SKIP_FLAG AS SMS_WEEK_SKIP_FLAG,
		SMS_NIGHT_SKIP_FLAG AS SMS_NIGHT_SKIP_FLAG
	  FROM ( 
	        SELECT (CASE WHEN (CD.KEY3 = 'Y' AND DATEPART(DW, GETDATE()) IN (7, 1)) 
			     THEN 'Y' 
			     ELSE 'N' 
			     END) AS SMS_WEEK_SKIP_FLAG,
		       (CASE WHEN (ISNULL(CD.KEY1,'') != '' 
			      AND ISNULL(CD.KEY1,'') != '' 
			      AND (GETDATE() >= CONVERT(DATETIME, CONVERT(NVARCHAR, GETDATE(), 23) + ' ' + CD.KEY1 ) 
			      AND  GETDATE() < CONVERT(DATETIME, CONVERT(NVARCHAR, GETDATE(), 23) + ' ' + CD.KEY2 ))) 
			     THEN 'Y'
			     ELSE 'N'
			      END) AS SMS_NIGHT_SKIP_FLAG 
		 FROM RMSPLUS.TB_RMS_CODE_ITEM_INFO CD WITH(NOLOCK)
		INNER JOIN RMSCMN.TB_EGN_CODE_ITEM_INFO CCD WITH(NOLOCK) 
		   ON (CCD.FACILITY_CODE = CD.FACILITY_CODE 
		  AND CCD.BUSINESS_USAGE_TYPE_CODE = CD.BUSINESS_USAGE_TYPE_CODE 
		  AND CCD.BUSINESS_USAGE_CODE_ID = CD.BUSINESS_USAGE_CODE_ID) 
		WHERE CD.BUSINESS_USAGE_TYPE_CODE = 'SMS_SKIP_TIME'
		  AND CD.BUSINESS_USAGE_CODE_ID = 'TIME1' ) DT			  

]]>"
sqlserver_select_TB_RMS_CODE_ITEM_INFO,5,"<![CDATA[
	
	SELECT BUSINESS_USAGE_CODE_ID
  	  FROM RMSPLUS.TB_RMS_CODE_ITEM_INFO WITH(NOLOCK)
  	 WHERE FACILITY_CODE = #{facilityCode}
	   AND BUSINESS_USAGE_TYPE_CODE = #{businessUsageTypeCode}
	
]]>"
sqlserver_select_TB_RMS_CODE_ITEM_INFO,6,"<![CDATA[

	
	SELECT ISNULL(MIN(EC.ATTRIBUTE1),'Y') ATTRIBUTE1
	  FROM RMSCMN.TB_EGN_CODE_ITEM_INFO EC WITH(NOLOCK)
         INNER JOIN RMSPLUS.TB_RMS_CODE_ITEM_INFO CD WITH(NOLOCK)
            ON (CD.FACILITY_CODE = EC.FACILITY_CODE
	   AND CD.BUSINESS_USAGE_TYPE_CODE = EC.BUSINESS_USAGE_TYPE_CODE
	   AND CD.BUSINESS_USAGE_CODE_ID = EC.BUSINESS_USAGE_CODE_ID)
         WHERE CD.FACILITY_CODE = #{facilityCode} 
           AND CD.BUSINESS_USAGE_TYPE_CODE =#{businessUsageTypeCode}
	   AND  CD.BUSINESS_USAGE_CODE_ID = ISNULL(#{businessUsageCodeId},'')
	
	
]]>"
sqlserver_select_TB_RMS_EQP_REQ_DOWN_CUST_INFO,1,"<![CDATA[
	
	WITH TEMP_TANK_LIST AS (
         SELECT DT.TANK_NO, 
                TK.ATTRIBUTE_VALUE_2 AS TANK_NAME, 
                DT.TANK_GRADE
	       FROM (
	             SELECT TL.TRANSACTION_SERIAL_NO AS TRANSACTION_SERIAL_NO, 
                        TL.EQUIPMENT_ID AS EQUIPMENT_ID, 
                        ISNULL(REPLACE(TL.ATTRIBUTE_VALUE_3, ' ', ''), '') AS TANK_GRADE, 
		                MIN(TL.ATTRIBUTE_VALUE_1) AS TANK_NO
		           FROM RMSPLUS.TB_RMS_EQP_REQ_DOWN_CUST_INFO TL WITH(NOLOCK)
		          WHERE TL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
			        AND TL.EQUIPMENT_ID = #{equipmentId}
			        AND ISNULL(REPLACE(TL.ATTRIBUTE_VALUE_3, ' ', ''), '') <> ''
		          GROUP BY TL.TRANSACTION_SERIAL_NO, TL.EQUIPMENT_ID, TL.ATTRIBUTE_VALUE_3
		        ) DT
	      INNER JOIN RMSPLUS.TB_RMS_EQP_REQ_DOWN_CUST_INFO TK WITH(NOLOCK) 
		     ON (TK.TRANSACTION_SERIAL_NO = DT.TRANSACTION_SERIAL_NO
	        AND TK.EQUIPMENT_ID = DT.EQUIPMENT_ID
		    AND TK.ATTRIBUTE_VALUE_1 = DT.TANK_NO) 
	     ),
	     TEMP_RMSMTRL_LIST AS ( 
	     SELECT PL.EQUIPMENT_PARAMETER_ID, 
                SUBSTRING(RIGHT(PL.EQUIPMENT_PARAMETER_ID, 5), 1, 2) AS STEP_NO, 
	            (CASE WHEN #{downloadTypeCode} = 'SPEC' 
		               AND DOWNLOAD_FLAG = 'Y' 
		              THEN RMS_VALUE 
		              ELSE '' 
		               END) AS RMS_GRADE 
	       FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL WITH(NOLOCK)  
	      WHERE PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		    AND PL.EQUIPMENT_ID = #{equipmentId} 
		    AND PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId}
		    AND PL.PARAMETER_FLAG = 'Y' 
	     )
	     SELECT SUM(ISNULL((CASE WHEN UPPER(ISNULL(PL.RMS_GRADE,'')) <> UPPER(ISNULL(TL.TANK_GRADE,'')) 
	                             THEN 1 
	                             ELSE 0 
	                             END), 0)
	               ) AS CNT 
               FROM TEMP_RMSMTRL_LIST PL WITH(NOLOCK)
	       LEFT OUTER JOIN TEMP_TANK_LIST TL WITH(NOLOCK) 
		 ON (UPPER(TL.TANK_GRADE) = UPPER(PL.RMS_GRADE))

]]>"
sqlserver_select_TB_RMS_EQP_REQ_DOWN_CUST_INFO,2,"<![CDATA[

	WITH TEMP_TANK_LIST AS (
             SELECT DT.TANK_NO, 
                    TK.ATTRIBUTE_VALUE_2 AS TANK_NAME, 
                    DT.TANK_GRADE
               FROM (
	             SELECT TL.TRANSACTION_SERIAL_NO AS TRANSACTION_SERIAL_NO, 
                            TL.EQUIPMENT_ID AS EQUIPMENT_ID, 
                            ISNULL(REPLACE(TL.ATTRIBUTE_VALUE_3, ' ', ''), '') AS TANK_GRADE, 
			    MIN(TL.ATTRIBUTE_VALUE_1) AS TANK_NO
		       FROM RMSPLUS.TB_RMS_EQP_REQ_DOWN_CUST_INFO TL WITH(NOLOCK)
		      WHERE ISNULL(REPLACE(TL.ATTRIBUTE_VALUE_3, ' ', ''), '')  <> ''
		      GROUP BY TL.TRANSACTION_SERIAL_NO, TL.EQUIPMENT_ID, TL.ATTRIBUTE_VALUE_3
	            ) DT
	      INNER JOIN RMSPLUS.TB_RMS_EQP_REQ_DOWN_CUST_INFO TK WITH(NOLOCK)
	         ON (TK.TRANSACTION_SERIAL_NO = DT.TRANSACTION_SERIAL_NO
	        AND TK.EQUIPMENT_ID = DT.EQUIPMENT_ID
	        AND TK.ATTRIBUTE_VALUE_1 = DT.TANK_NO) 
	     ),
	     TEMP_RMSMTRL_LIST AS ( 
	     SELECT PL.EQUIPMENT_PARAMETER_ID, 
                    SUBSTRING(RIGHT(PL.EQUIPMENT_PARAMETER_ID, 5), 1, 2) AS STEP_NO, 
		    (CASE WHEN #{downloadTypeCode} = 'SPEC' AND PL.DOWNLOAD_FLAG = 'Y' 
		          THEN RMS_VALUE 
		          ELSE '' 
		          END) AS RMS_GRADE 
	       FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL WITH(NOLOCK)   
	      WHERE PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	        AND PL.EQUIPMENT_ID = #{equipmentId}
	        AND PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId}
	        AND PL.PARAMETER_FLAG = 'Y' 
	     )
	     SELECT PL.EQUIPMENT_PARAMETER_ID, 
                    PL.STEP_NO, 
                    TL.TANK_NO, 
                    TL.TANK_NAME, 
		    (CASE WHEN ISNULL(TL.TANK_NO,'') ='' 
		          THEN '' 
		          ELSE UPPER(PL.RMS_GRADE) 
		          END) AS RMS_GRADE
              FROM TEMP_RMSMTRL_LIST PL WITH(NOLOCK)
	      LEFT OUTER JOIN TEMP_TANK_LIST TL WITH(NOLOCK) 
	        ON (UPPER(TL.TANK_GRADE) = UPPER(PL.RMS_GRADE))
	     ORDER BY PL.EQUIPMENT_PARAMETER_ID 

]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,1,"<![CDATA[

	SELECT COUNT(*) AS CNT
	  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL WITH(NOLOCK)  
	 WHERE PL.FUNCTION_NAME = #{functionName}
	   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}	
	   AND PL.PARAMETER_FLAG = 'Y'  

]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,2,"<![CDATA[

	SELECT COUNT(*) AS CNT
	  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL WITH(NOLOCK)
	 WHERE PL.FUNCTION_NAME = #{functionName}
 	   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}	
 	   AND PL.PARAMETER_FLAG = #{parameterFlag}
	   AND (PL.PARAMETER_ID IS NULL OR PL.RMS_USE_FLAG <> 'Y' OR PL.USE_FLAG <> 'Y')

]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,3,"<![CDATA[

		SELECT PL.EQUIPMENT_ID AS EQUIPMENT_ID, 
			   PL.EQUIPMENT_PARAMETER_ID AS EQUIPMENT_PARAMETER_ID, 
			   PL.GRADE_CODE AS GRADE_CODE,
		       (CASE WHEN #{validationResultCode}='0' 
		                  AND #{downloadTypeCode} = 'LAST' 
		                  AND PL.USE_FLAG = 'Y' 
		             THEN PL.RMS_VALUE
		             WHEN (#{validationResultCode}='0' OR #{validationCode} = '20') 
		                  AND #{downloadTypeCode} = 'SPEC' 
		                  AND PL.USE_FLAG = 'Y' 
		                  AND PL.DOWNLOAD_FLAG = 'Y' 
		             THEN PL.RMS_VALUE 	 --ë¯¹ì„œ ?±í¬?ë£Œ?†ìŒNG???•ìƒ?ìœ¼ë¡??´ë¦¼
		             WHEN #{recipeIdPrefixValue} ='MIX' 
		                  AND #{validationResultCode} ='1' 
		                  AND #{downloadTypeCode} = 'SPEC' 
					 THEN -- ë¯¹ì„œ NG ?ë£Œëª?ë¹ˆê°’, ?´ì™¸ '0' 
					      (CASE WHEN PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId} 
					           THEN '' 
					           ELSE '0' 
					           END)       -- ?ë£Œëª?ë¹ˆê°’, ?´ì™¸ '0' 
		             ELSE PL.EQUIPMENT_VALUE
		             END) AS RMS_VALUE,
		       (CASE WHEN PL.USE_FLAG = 'Y' 
		             THEN '1' 
		             ELSE '0' 
		             END) AS USE_FLAG,        
		       (CASE WHEN #{downloadTypeCode} = 'LAST' 
		                  AND PL.USE_FLAG = 'Y' 
		             THEN '1'
		             WHEN #{downloadTypeCode} = 'SPEC' 
		                  AND PL.DOWNLOAD_FLAG = 'Y' 
		             THEN '1' 
		             ELSE '0' 
		             END) AS DOWNLOAD_FLAG
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL WITH(NOLOCK)
		 WHERE PL.FUNCTION_NAME = #{functionName}
	 	   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}	
	     ORDER BY PL.EQUIPMENT_PARAMETER_ID 

]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,4,"<![CDATA[

	
		SELECT COUNT(1) AS CNT
	     FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO WITH(NOLOCK)
		WHERE FUNCTION_NAME = #{functionName}
	 	  AND TRANSACTION_SERIAL_NO=#{transactionSerialNo}	
	 	  AND PARAMETER_FLAG = 'Y'
		  AND RMS_USE_FLAG ='Y'
	
	
]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,5,"<![CDATA[

	
	   SELECT PL.EQUIPMENT_PARAMETER_ID, 
                  SUBSTRING(RIGHT(PL.EQUIPMENT_PARAMETER_ID, 5), 1, 2) AS STEP_NO, '' AS TANK_NO, 
                 '' AS TANK_NAME, 
                 '' AS RMS_GRADE
	     FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL WITH(NOLOCK) 
	    WHERE FUNCTION_NAME = #{functionName}
	      AND TRANSACTION_SERIAL_NO=#{transactionSerialNo}	
	      AND PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId}
	    ORDER BY PL.EQUIPMENT_PARAMETER_ID

]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO,1,"<![CDATA[

	
		SELECT FUNCTION_NAME, TRANSACTION_SERIAL_NO, EQUIPMENT_PARAMETER_ID, REQUEST_VALUE, PARAMETER_FLAG 
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO WITH(NOLOCK) 
		 WHERE FUNCTION_NAME = #{functionName}
		   AND TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	
	
]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO,2,"<![CDATA[

	
		SELECT (CASE WHEN ISNULL(MIN(PL.REQUEST_VALUE),'') != '' 
		                  AND CONVERT(FLOAT,ISNULL(MIN(RV.TARGET_VALUE),'')) = CONVERT(FLOAT,ISNULL(MIN(PL.REQUEST_VALUE),''))  
		             THEN #{insProductSpecificationVersion} + '_'+ ISNULL(MIN(PL.REQUEST_VALUE),'') 
			  		 WHEN ISNULL(MIN(PL.REQUEST_VALUE),'') != '' 
					 THEN #{insProductSpecificationVersion} + '_'+ ISNULL(MIN(PL.REQUEST_VALUE),'') 
					 ELSE #{insProductSpecificationVersion}
			         END) AS PRODUCT_SPECIFICATION_VERSION,
			   COUNT(*) AS CHECK_CNT 
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK) 
		 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE = #{facilityCode} 
		   AND EP.EQUIPMENT_ID =#{equipmentId} 
		   AND EP.EQUIPMENT_PARAMETER_ID= PL.EQUIPMENT_PARAMETER_ID)
		 INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
		    ON (RV.FACILITY_CODE = EP.FACILITY_CODE 
		   AND RV.RECIPE_ID = EP.RECIPE_ID 
		   AND RV.RECIPE_VERSION = EP.RECIPE_VERSION)  
		 INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK) 
		    ON (PM.FACILITY_CODE = EP.FACILITY_CODE 
		   AND PM.PARAMETER_ID = EP.PARAMETER_ID 
		   AND PM.MGR_GROUP_ID = EP.MGR_GROUP_ID
		   AND PM.EQUIPMENT_GROUP_ID = EP.EQUIPMENT_GROUP_ID
		   AND EP.EQUIPMENT_PARAMETER_ID= PL.EQUIPMENT_PARAMETER_ID)
		 WHERE PL.FUNCTION_NAME=#{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
		   AND PL.PARAMETER_FLAG ='Y'
		   AND ISNULL(PM.VALIDATION_VERSION_CHECK_FLAG,'N') ='Y'
	
	
]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO,3,"<![CDATA[

	
		SELECT COUNT(*) AS CNT
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO WITH(NOLOCK)
		 WHERE FUNCTION_NAME=#{functionName}
		   AND TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
		   AND PARAMETER_FLAG = #{parameterFlag}
	
	
]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO,4,"<![CDATA[
	
	SELECT #{equipmentId} AS EQUIPMENT_ID, 
	       PL.EQUIPMENT_PARAMETER_ID AS EQUIPMENT_PARAMETER_ID, 
	       ISNULL(EP.GRADE_CODE,'0') AS GRADE_CODE, 
	       PL.REQUEST_VALUE AS REQUEST_VALUE,
	      (CASE WHEN ISNULL(EP.GRADE_CODE,'0') = '1'
	            THEN PL.REQUEST_VALUE
	            ELSE (CASE WHEN ISNULL(DH.TARGET_VALUE, '') = '' 
	    		       THEN PL.REQUEST_VALUE 
			       ELSE DH.TARGET_VALUE 
			       END)
		    END) AS RMS_VALUE,
	      DH.LSL_VALUE AS LSL_VALUE,  
	      DH.USL_VALUE AS USL_VALUE,  
	      ISNULL(DH.VALIDATION_RESULT_CODE, 0) AS VALIDATION_RESULT_CODE,  
	      (CASE WHEN ISNULL(DH.USE_FLAG,'N')='Y' 
	            THEN '1' 
	            ELSE '0' 
	            END) AS USE_FLAG  
    	 FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
	 LEFT OUTER JOIN RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK)
	   ON (DH.EQUIPMENT_ID = #{equipmentId}
	  AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
	  AND DH.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID )
	 LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
	   ON (EP.EQUIPMENT_ID = #{equipmentId}
	  AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId} 
	  AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion} 
	  AND EP.RECIPE_ID = #{recipeId} 
	  AND EP.RECIPE_VERSION = #{recipeVersion} 
	  AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID
	  AND EP.USE_FLAG = 'Y')
	WHERE PL.FUNCTION_NAME=#{functionName}
	  AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	ORDER BY PL.EQUIPMENT_PARAMETER_ID 	     

]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO,5,"<![CDATA[

    SELECT COUNT(*) AS CNT
	  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK) 
	  LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
	    ON (EP.EQUIPMENT_ID = #{equipmentId}
           AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
           AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
           AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID)   
	 WHERE PL.FUNCTION_NAME = #{functionName}
	   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}	
	   AND PL.PARAMETER_FLAG = 'Y'  
	   AND ISNULL(EP.RMS_USE_FLAG,'N')='Y'

]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO,6,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID, 
                       PL.EQUIPMENT_PARAMETER_ID AS EQUIPMENT_PARAMETER_ID, 
                       ISNULL(EP.GRADE_CODE,'0') AS GRADE_CODE, 
		       PL.REQUEST_VALUE AS REQUEST_VALUE, 
                       PL.REQUEST_VALUE AS RMS_VALUE, 
                       '' AS LSL_VALUE, 
		       '' AS USL_VALUE, 
                       '0' AS VALIDATION_RESULT_CODE, 
                       '1' AS USE_FLAG    
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK) 
		  LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		    ON (EP.EQUIPMENT_ID = #{equipmentId} 
		   AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID)
		 WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		 ORDER BY PL.EQUIPMENT_PARAMETER_ID
	
	
]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO,7,"<![CDATA[

	
		SELECT TOP 1
		       EQUIPMENT_PARAMETER_ID AS EQUIPMENT_PARAMETER_ID, 
		       REQUEST_VALUE AS REQUEST_VALUE
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK) 
		 WHERE FUNCTION_NAME=#{functionName}
		   AND TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
		   AND EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId}  
		   AND ISNULL(PL.REQUEST_VALUE,'') != ''
		   AND PL.PARAMETER_FLAG =#{parameterFlag}
		 ORDER BY EQUIPMENT_PARAMETER_ID 
	
	
]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO,8,"<![CDATA[

		SELECT #{equipmentId}       		AS EQUIPMENT_ID,
			   PL.EQUIPMENT_PARAMETER_ID	AS EQUIPMENT_PARAMETER_ID,
			   ISNULL(EP.GRADE_CODE,'0') 	AS GRADE_CODE,
			   PL.REQUEST_VALUE             AS REQUEST_VALUE,
			   PL.REQUEST_VALUE            	AS RMS_VALUE,
			   ''                   		AS LSL_VALUE, 
			   ''                   		AS USL_VALUE, 
			   '0' 							AS VALIDATION_RESULT_CODE,   -- 0:OK, 1:NG
			   (CASE WHEN ISNULL(EP.RMS_USE_FLAG,'N') = 'Y' 
			         THEN '1' 
			         ELSE '0' 
			         END) AS USE_FLAG  		--0:ë¯¸ì‚¬?? 1:?¬ìš© 
		FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
		LEFT OUTER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		  ON (EP.EQUIPMENT_ID = #{equipmentId}
	         AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId} 
	         AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion} 
	         AND EP.RECIPE_ID = #{recipeId} 
	         AND EP.RECIPE_VERSION = #{recipeVersion} 
	         AND EP.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID
	         AND EP.USE_FLAG = 'Y')
	      WHERE PL.FUNCTION_NAME=#{functionName}
	        AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	      ORDER BY PL.EQUIPMENT_PARAMETER_ID

]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO_cust,1,"<![CDATA[

		WITH TEMP_TB_MIX_MATERIAL AS (
                     SELECT EP.PARAMETER_ID, 
			    PM.STEP_SEQ_NO, 
			    PM.MATERIAL_SEQ_NO, 
			    ISNULL(MM.MATERIAL_ID, '') AS MATERIAL_ID, 
			    ISNULL(MC.MATERIAL_NAME, '') AS MATERIAL_NAME, 
			    RMSPLUS.FN_GET_ALTERNATIVE_MTRL_NAME('ko-KR', 
			                                         MM.FACILITY_CODE, 
			                                         MM.EQUIPMENT_ID, 
			                                         MM.PRODUCT_SPECIFICATION_ID, 
			                                         MM.PRODUCT_SPECIFICATION_VERSION, 
			                                         MM.PARAMETER_ID, 
			                                         'MATERIAL_ID') AS REP_MTRL_ID,
		   	    RMSPLUS.FN_GET_ALTERNATIVE_MTRL_NAME('ko-KR', 
			                                         MM.FACILITY_CODE, 
				                                 MM.EQUIPMENT_ID, 
				                                 MM.PRODUCT_SPECIFICATION_ID, 
				                                 MM.PRODUCT_SPECIFICATION_VERSION, 
				                                 MM.PARAMETER_ID, 
				                                 'MATERIAL_NAME') AS REP_MTRL_NAME, 
		  	    ROW_NUMBER() OVER (PARTITION BY PM.STEP_SEQ_NO, MM.MATERIAL_ID ORDER BY MATERIAL_SEQ_NO) AS STEP_MATERIAL_SEQ
		       FROM RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK) 
		      INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK)
		         ON (EP.FACILITY_CODE = PM.FACILITY_CODE 
			AND EP.EQUIPMENT_ID = #{equipmentId} 
			AND EP.PARAMETER_ID = PM.PARAMETER_ID)
		       LEFT OUTER JOIN RMSPLUS.TB_COM_MIX_MATERIAL_INFO MM WITH(NOLOCK) 
		         ON (MM.FACILITY_CODE = EP.FACILITY_CODE
			AND MM.EQUIPMENT_ID = #{equipmentId}
			AND MM.PRODUCT_SPECIFICATION_ID = #{productSpecificationId} 
			AND MM.PRODUCT_SPECIFICATION_VERSION = #{insProductSpecificationVersion} 
			AND MM.PARAMETER_ID = EP.PARAMETER_ID 
			AND ISNULL(MM.MATERIAL_ID, '') != '') 
		       LEFT OUTER JOIN RMSPLUS.TB_COM_MIX_MATERIAL_CODE_MST MC WITH(NOLOCK) 
			 ON (MC.MATERIAL_ID = MM.MATERIAL_ID) 
		      WHERE PM.FACILITY_CODE = #{facilityCode}
		        AND EP.EQUIPMENT_PARAMETER_ID IN (
                            SELECT SUBSTRING(EP.EQUIPMENT_PARAMETER_ID, 1, LEN(EP.EQUIPMENT_PARAMETER_ID)-3)+'A'+RIGHT(EP.EQUIPMENT_PARAMETER_ID, 2) 
		              FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		             INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK)
		                ON (PM.FACILITY_CODE = EP.FACILITY_CODE 
		               AND PM.MGR_GROUP_ID = EP.MGR_GROUP_ID
		               AND PM.EQUIPMENT_GROUP_ID = EP.EQUIPMENT_GROUP_ID
		               AND PM.PARAMETER_ID = EP.PARAMETER_ID)
		      INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
		         ON (RV.FACILITY_CODE = EP.FACILITY_CODE 
		        AND RV.RECIPE_ID = EP.RECIPE_ID 
		        AND RV.RECIPE_VERSION = EP.RECIPE_VERSION 
		        AND RV.PARAMETER_ID = EP.PARAMETER_ID) 
		      WHERE EP.FACILITY_CODE = #{facilityCode}
		        AND EP.EQUIPMENT_ID = #{equipmentId}
		        AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
		        AND EP.PRODUCT_SPECIFICATION_VERSION LIKE #{insProductSpecificationVersion} + '%'
		        AND ISNULL(PM.VALIDATION_VERSION_CHECK_FLAG,'N') ='Y'
		        AND (CASE WHEN ISNULL((EP.PRODUCT_SPECIFICATION_VERSION),'') != '' 
		                  THEN RV.TARGET_VALUE 
		                  ELSE 0 
			          END) = #{firstValue})
		        AND PM.MATERIAL_NAME_FLAG = 'Y'
		     ),
		     TEMP_TB_PARAMETER_LIST AS (
                     SELECT PL.EQUIPMENT_PARAMETER_ID, 
			    PL.REQUEST_VALUE AS MATERIAL_ID, 
			    SUBSTRING(RIGHT(PL.EQUIPMENT_PARAMETER_ID, 5), 1, 2) AS STEP_SEQ_NO, 
			    ROW_NUMBER() 
                                  OVER(PARTITION BY SUBSTRING(RIGHT(PL.EQUIPMENT_PARAMETER_ID, 5), 1, 2), PL.REQUEST_VALUE 
                                 ORDER BY PL.EQUIPMENT_PARAMETER_ID) AS STEP_MATERIAL_SEQ
	     	      FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
		     WHERE PL.FUNCTION_NAME=#{functionName}
		       AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		       AND PL.PARAMETER_FLAG = 'Y'  
		       AND PL.EQUIPMENT_PARAMETER_ID = SUBSTRING(#{equipmentParameterId}, 1, LEN(#{equipmentParameterId})-3)+'A'+RIGHT(#{equipmentParameterId}, 2))
		SELECT #{insProductSpecificationVersion} AS PRODUCT_SPECIFICATION_VERSION, 
		       COUNT(*) AS CHECK_CNT 
		  FROM TEMP_TB_PARAMETER_LIST PL WITH(NOLOCK)
		  LEFT OUTER JOIN TEMP_TB_MIX_MATERIAL MM WITH(NOLOCK) 
		    ON (MM.STEP_SEQ_NO = PL.STEP_SEQ_NO 
		   AND MM.STEP_MATERIAL_SEQ = PL.STEP_MATERIAL_SEQ)
		 WHERE RMSPLUS.FN_GET_STRCMP( REPLACE(REPLACE(REPLACE(PL.MATERIAL_ID, '_', ''), '-', ''), ' ', ''), 
		       (CASE WHEN ISNULL(MM.REP_MTRL_ID,'') = '' 
		             THEN REPLACE(REPLACE(REPLACE(MM.MATERIAL_ID, '_', ''), '-', ''), ' ', '') 
		             ELSE REPLACE(REPLACE(REPLACE(MM.MATERIAL_ID, '_', ''), '-', ''), ' ', '')+','+REPLACE(REPLACE(REPLACE(MM.REP_MTRL_ID, '_', ''), '-', ''), ' ', '') 
		 	     END)) ='0' OR RMSPLUS.FN_GET_STRCMP(REPLACE(REPLACE(REPLACE(SUBSTRING(PL.MATERIAL_ID,1,10), '_', ''), '-', ''), ' ', ''),  
		       (CASE WHEN ISNULL(MM.REP_MTRL_NAME,'') = '' 
		             THEN REPLACE(REPLACE(REPLACE(SUBSTRING(MM.MATERIAL_NAME,1,10), '_', ''), '-', ''), ' ', '') 
			     ELSE REPLACE(REPLACE(REPLACE(SUBSTRING(MM.MATERIAL_NAME,1,10), '_', ''), '-', ''), ' ', '') + ',' + REPLACE(REPLACE(REPLACE(SUBSTRING(MM.REP_MTRL_NAME,1,10), '_', ''), '-', ''), ' ', '') 
			     END)) = '0'

]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO_cust,2,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID,
		        STEP_NO, 
		        '10' AS VALIDATION_RESULT_CODE   -- 10:OK, 11:NG 
		  FROM
			(SELECT SUBSTRING(RIGHT(PL.EQUIPMENT_PARAMETER_ID, 5), 1, 2) AS STEP_NO
			    FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
			   WHERE FUNCTION_NAME = #{functionName}
			     AND TRANSACTION_SERIAL_NO=#{transactionSerialNo}  
			 ) DT
		 GROUP BY STEP_NO 
		 ORDER BY STEP_NO
	
	
]]>"
sqlserver_select_TB_RMS_EQP_REQ_PARAM_INFO_cust,3,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID,
		       '' AS STEP_NO, 
		       '' AS VALIDATION_RESULT_CODE   -- 10:OK, 11:NG  
	
	
]]>"
sqlserver_select_TB_RMS_EQUIPMENT_MST,1,"<![CDATA[

	
		SELECT FACILITY_CODE,
			   ISNULL(EQ.EQUIPMENT_ID, 'X') AS EQUIPMENT_ID,	
		       RMSPLUS.FN_GET_LANG_DATA(#{basicLang}, EQ.EQUIPMENT_NAME) AS EQUIPMENT_NAME,
  		   	   ISNULL(EQ.GRADE_CODE, 'H') AS GRADE_CODE,
		   	   ISNULL(EQ.RMS_MODE_TYPE_CODE, '') AS RMS_MODE_TYPE_CODE,			--RMS ëª¨ë“œ ? í˜•
		   	   ISNULL(EQ.RMS_MODE_CODE,'') AS RMS_MODE_CODE                     --RMS UI ëª¨ë“œ(CNB2??
  		  FROM RMSPLUS.TB_RMS_EQUIPMENT_MST EQ WITH(NOLOCK) 
  	     WHERE EQ.EQUIPMENT_ID = #{equipmentId}
	
	
]]>"
sqlserver_select_TB_RMS_EQUIPMENT_MST,2,"<![CDATA[

	
		SELECT FACILITY_CODE, RMS_USE_FLAG, ISNULL(VALIDATION_USE_FLAG, 'N') AS VALIDATION_USE_FLAG, VALIDATION_MODE_CODE, DOWNLOAD_USE_FLAG, DOWNLOAD_MODE_CODE, 
			   EQUIPMENT_SPEC_APPLY_USE_FLAG
		  FROM RMSPLUS.TB_RMS_EQUIPMENT_MST WITH(NOLOCK)
		 WHERE EQUIPMENT_ID = #{equipmentId}
		   AND PROCESS_CODE = #{processCode};
	
	
]]>"
sqlserver_select_TB_RMS_EQUIPMENT_MST,3,"<![CDATA[

	
		SELECT FM.FACILITY_CODE, FM.FACILITY_DESC, AM.FACTORY_AREA_ID, AM.FACTORY_AREA_DESC,
	   		   EM.EQUIPMENT_ID, EM.EQUIPMENT_NAME, EM.EQUIPMENT_TYPE_CODE 
  		  FROM RMSPLUS.TB_RMS_EQUIPMENT_MST EM WITH(NOLOCK)
  		 INNER JOIN RMSCMN.TB_EGN_FACILITY_MST FM WITH(NOLOCK)
            ON (FM.FACILITY_CODE = EM.FACILITY_CODE)
         INNER JOIN RMSCMN.TB_EGN_FCTRY_AREA_MST AM WITH(NOLOCK)
 	  	    ON (AM.FACTORY_AREA_ID = EM.FACTORY_AREA_ID)
 	  	 WHERE EM.EQUIPMENT_ID = #{equipmentId}
	
	
]]>"
sqlserver_select_TB_RMS_EQUIPMENT_PARAM_INFO,1,"<![CDATA[

		SELECT COUNT(*) AS CNT
		  FROM RMSPLUS.TB_RMS_EQUIPMENT_PARAM_INFO EP WITH(NOLOCK)
		 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER VEP WITH(NOLOCK) 
		    ON (EP.EQUIPMENT_ID = VEP.EQUIPMENT_ID 
		        AND EP.PARAMETER_ID = VEP.PARAMETER_ID 
		        AND VEP.USE_FLAG = 'Y')
		 WHERE EP.FACILITY_CODE = #{facilityCode}
		   AND EP.EQUIPMENT_ID = #{equipmentId} 
		   AND ISNULL(VEP.EQUIPMENT_PARAMETER_ID, '') != ''

]]>"
sqlserver_select_TB_RMS_EQUIPMENT_PARAM_INFO,2,"<![CDATA[


SELECT COUNT(*) AS CNT
  FROM RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO ER WITH(NOLOCK)
  INNER JOIN RMSPLUS.TB_RMS_RECIPE_PARAMETER_INFO RP WITH(NOLOCK)
     ON (RP.FACILITY_CODE = ER.FACILITY_CODE
	AND RP.RECIPE_ID = #{recipeId})
  INNER JOIN RMSPLUS.TB_RMS_RECIPE_MAP_VERSION_INFO RMV WITH(NOLOCK)
     ON (RMV.FACILITY_CODE = ER.FACILITY_CODE
	AND RMV.RECIPE_ID = #{recipeId}
	AND RMV.RECIPE_MAP_VERSION = #{recipeMapVersion}
	AND ISNULL(RMV.EQUIPMENT_PARAMETER_ID, '') != ''
	AND RMV.RMS_USE_FLAG='Y'
	AND RMV.PARAMETER_ID = RP.PARAMETER_ID)
  WHERE ER.FACILITY_CODE = #{facilityCode}
	AND ER.EQUIPMENT_ID = #{equipmentId} 
	AND ER.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
	AND ER.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
	AND ER.RECIPE_ID = #{recipeId}
	AND ER.RECIPE_VERSION = #{recipeVersion}
	AND ER.RECIPE_MAP_VERSION = #{recipeMapVersion}
	
]]>"
sqlserver_select_TB_RMS_EQUIPMENT_RECIPE_INFO,1,"<![CDATA[

	
		SELECT * 
  		  FROM RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO WITH(NOLOCK)
 		 WHERE FACILITY_CODE = #{facilityCode}
   		   AND EQUIPMENT_ID = #{equipmentId}
  	   	   AND PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
  	   	   AND PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
   		   AND USE_FLAG = 'Y'
	
	
]]>"
sqlserver_select_TB_RMS_EQUIPMENT_RECIPE_INFO,2,"<![CDATA[

	
		SELECT EQUIPMENT_ID, RECIPE_ID, RECIPE_VERSION 
	  	  FROM RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO WITH(NOLOCK)
         WHERE FACILITY_CODE = #{facilityCode}
	       AND EQUIPMENT_ID = #{equipmentId}
	       AND USE_FLAG = 'Y';
	
	
]]>"
sqlserver_select_TB_RMS_EQUIPMENT_RECIPE_INFO,3,"<![CDATA[

	
		SELECT EQUIPMENT_ID, RECIPE_ID, RECIPE_VERSION, RECIPE_MAP_VERSION
	  	  FROM RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO WITH(NOLOCK)
         WHERE FACILITY_CODE = #{facilityCode}
	       AND EQUIPMENT_ID = #{equipmentId}
	       AND RECIPE_ID = #{recipeId}
	       AND USE_FLAG = 'Y'
	
	
]]>"
sqlserver_select_TB_RMS_EQUIPMENT_RECIPE_INFO,4,"<![CDATA[

	
		SELECT EQUIPMENT_ID, PRODUCT_SPECIFICATION_ID, RECIPE_ID, RECIPE_VERSION, RECIPE_MAP_VERSION, EQUIPMENT_RECIPE_ID 
  		  FROM RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO WITH(NOLOCK)
 		 WHERE FACILITY_CODE = #{facilityCode}
   		   AND EQUIPMENT_ID = #{equipmentId}
  	   	   AND PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
  	   	   AND RECIPE_ID = #{recipeId}
   		   AND USE_FLAG = 'Y'
	
	
]]>"
sqlserver_select_TB_RMS_EQUIPMENT_STATE_HIST,1,"<![CDATA[

	
		SELECT ISNULL (NEW_STATE_CODE,'0') AS BEF_STATE
		  FROM RMSPLUS.TB_RMS_EQUIPMENT_STATE_HIST WITH(NOLOCK)
	 	 WHERE EQUIPMENT_ID = #{equipmentId}
		   AND CURRENT_FLAG='C'
	
	
]]>"
sqlserver_select_TB_RMS_ID_INFO,1,"<![CDATA[

	
		SELECT FACILITY_CODE, ID_FORMAT_VALUE, SEQ_FORMAT_VALUE, CURRENT_ID, CURRENT_SEQ
		  FROM RMSPLUS.TB_RMS_ID_INFO WITH(NOLOCK)
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND ID_TYPE_CODE = #{idTypeCode}
	
	
]]>"
sqlserver_select_TB_RMS_ID_INFO,2,"<![CDATA[        

{
          call RMSPLUS.SP_GENERATE_ID(#{facilityCode}, #{idTypeCode})      
}

]]>"
sqlserver_select_TB_RMS_MAIL_TEMPLATE_INFO,1,"<![CDATA[

	
		SELECT MAIL_TITLE_CONTENT, MAIL_BODY_CONTENT, HTML_FLAG
		  FROM RMSPLUS.TB_RMS_MAIL_TEMPLATE_INFO MT WITH(NOLOCK)
	  	 WHERE MAIL_TYPE_ID = #{mailTypeId}
		   AND LANGUAGE_CODE = #{languageCode} 
	
	
]]>"
sqlserver_select_TB_RMS_PROD_EXCEPT_PARAM_INFO,1,"<![CDATA[

	
		SELECT (CASE WHEN #{useFlag} = 'Y' THEN ISNULL(MIN('N'), 'Y') 
		             ELSE #{useFlag} 
		             END) AS USE_FLAG
		  FROM RMSPLUS.TB_RMS_PROD_EXCEPT_PARAM_INFO XP WITH(NOLOCK)
	     WHERE XP.EQUIPMENT_ID = #{equipmentId}
		   AND XP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
		   AND XP.PARAMETER_ID = #{parameterId}
		   AND XP.EXCEPT_FLAG = 'Y'
	
	
]]>"
sqlserver_select_TB_RMS_PURGE_TABLE_INFO,1,"<![CDATA[

	
		SELECT PT.FACILITY_CODE, PT.PURGE_TABLE_NAME, PT.PURGE_COLUMN_NAME, PT.PURGE_COLUMN_TYPE, PT.PURGE_TYPE, 
		       PT.KEEP_AMOUNT
		  FROM RMSPLUS.TB_RMS_PURGE_TABLE_INFO PT WITH(NOLOCK)
	     WHERE PT.USE_FLAG = 'Y'
	
	
]]>"
sqlserver_select_TB_RMS_RCP_PARAM_UPLOAD_HIST,1,"<![CDATA[

	
		SELECT COUNT(*) AS CNT
		  FROM RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST WITH(NOLOCK)
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND TRANSACTION_SERIAL_NO = #{transactionSerialNo} 
		   AND ISNULL(PARAMETER_ID, '') = ''
	
	
]]>"
sqlserver_select_TB_RMS_RCP_PARAM_UPLOAD_HIST,2,"<![CDATA[

	
		SELECT COUNT(*) AS CNT
		  FROM RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST WITH(NOLOCK)
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND EQUIPMENT_ID = #{equipmentId}
		   AND RECIPE_ID = #{recipeId}
		   AND UPLOAD_TYPE_CODE = 'EQP_SPEC_APPLY'
		   AND RECIPE_VERSION = #{recipeVersion}
		   AND LAST_UPDATE_DATE > GETDATE() - #{searchTime}
	
	
]]>"
sqlserver_select_TB_RMS_RCP_UPLOAD_FINAL_HIST,1,"<![CDATA[

		SELECT TOP 1 
		       UH.TRANSACTION_SERIAL_NO AS TRANSACTION_SERIAL_NO,
		       UH.TRANSACTION_DATE AS TRANSACTION_DATE
		  FROM RMSPLUS.TB_RMS_RCP_UPLOAD_FINAL_HIST UH WITH(NOLOCK)
		 WHERE UH.FACILITY_CODE = #{facilityCode} 
		   AND UH.EQUIPMENT_ID = #{equipmentId} 
		   AND UH.UPLOAD_TYPE_CODE = #{uploadTypeCode}
		   AND UH.EQP_PROD_SPEC_ID = #{eqpProdSpecId}
		   AND UH.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}  
	           AND ISNULL(UH.COLLECTION_ATTRIBUTE1,'') = ISNULL(#{collectionAttribute1},'')
		   AND UH.VALIDATION_MODE_CODE    = #{validationModeCode} 
	    ORDER BY UH.TRANSACTION_DATE DESC

]]>"
sqlserver_select_TB_RMS_RECIPE_UPLOAD_HIST,1,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID, 
			   (CASE WHEN #{validationResultCode} = '0' 
			         THEN '10' 
			         ELSE '11' 
			         END) AS VALIDATION_RESULT_CODE,  
			   RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationCode}, 'ERROR_CODE','en-US') AS ERROR_CODE,
			   RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationCode}, 'ERROR_MESSAGE','en-US') AS ERROR_MSG,
			   #{productSpecificationId} AS PRODUCT_SPECIFICATION_ID,
			   #{productSpecificationVersion} AS PRODUCT_SPECIFICATION_VERSION, 
			   #{parameterEquipmentCount} AS PARAMETER_TOTAL_COUNT 
		  FROM RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST WITH(NOLOCK)
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND TRANSACTION_SERIAL_NO = #{transactionSerialNo}
	
	
]]>"
sqlserver_select_TB_RMS_RECIPE_UPLOAD_HIST,2,"<![CDATA[

        SELECT UP.TRANSACTION_SERIAL_NO AS COLLECT_NO, 
               VE.FACILITY_CODE, 
               UP.EQUIPMENT_ID, 
               UP.UPLOAD_LOT_ID AS LOT_ID, 
               UP.PRODUCT_SPECIFICATION_ID AS PRODUCT_SPECIFICATION_ID,  
 	       UP.PRODUCT_SPECIFICATION_VERSION, 
               CASE WHEN UP.UPLOAD_TYPE_CODE ='SV_COLLECT-I' 
	            THEN 'I' 
	            ELSE 'C' 
		    END AS COLLECT_TYPE,
	       CASE WHEN UP.AUTO_DATA_COLLECTION_FLAG = '' 
	            THEN '1' 
		    ELSE UP.AUTO_DATA_COLLECTION_FLAG 
		    END AS AUTO_FLAG, 
	       CASE WHEN UP.EQUIPMENT_TEST_MODE_FLAG = ''  
	            THEN '0' 
		    ELSE UP.EQUIPMENT_TEST_MODE_FLAG 
		    END AS TEST_FLAG, 
               UP.TRANSACTION_DATE AS COLLECT_TIME,
	       CASE WHEN UP.EQUIPMENT_ID LIKE 'M1CT%' AND UP.COLLECTION_ATTRIBUTE1 = '0' 
		    THEN 'TOP' 
		    WHEN UP.EQUIPMENT_ID LIKE 'M1CT%' AND UP.COLLECTION_ATTRIBUTE1 = '1' 
	            THEN 'BACK'
		    ELSE '' 
		    END AS TOPBACK_TYPE
	       FROM RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST UP WITH(NOLOCK) 
	     INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
	        ON (VE.EQUIPMENT_ID = UP.EQUIPMENT_ID)
	     WHERE UP.UPLOAD_TYPE_CODE IN ('SV_COLLECT-I', 'SV_COLLECT-C')
	       AND UP.PROCESS_FLAG = 'P'
	       AND ISNULL(UP.EQUIPMENT_TEST_MODE_FLAG, '0') <> '1' 
	       AND (UP.UPLOAD_TYPE_CODE ='SV_COLLECT-I' OR VE.RUN_FLAG_USE_FLAG = 'N' OR (VE.RUN_FLAG_USE_FLAG = 'Y' AND UP.EQUIPMENT_RUN_FLAG = '1'))
	       AND ISNULL(UP.COLLECTION_ATTRIBUTE2, '0') <> '1' 
	       AND ISNULL(UP.COLLECTION_ATTRIBUTE3, '0') <> '1' 
	       AND NOT EXISTS (SELECT 1
	                         FROM (SELECT TOP 1 MW.END_DATE
 			       	         FROM RMSPLUS.TB_MES_WIP_HIST MW WITH(NOLOCK) 
				 	WHERE MW.EQUIPMENT_ID = CASE WHEN VE.MAIN_EQUIPMENT_FLAG = 'Y' 
				                                     THEN VE.EQUIPMENT_ID 
					                             ELSE VE.MAIN_EQUIPMENT_ID 
								     END
					  AND MW.LOT_ID = UP.MES_LOT_ID
				        ORDER BY MW.WIP_SEQ DESC) DT
		                WHERE DT.END_DATE < UP.TRANSACTION_DATE)	  
             ORDER BY UP.EQUIPMENT_ID, UP.TRANSACTION_DATE

]]>"
sqlserver_select_TB_RMS_RECIPE_UPLOAD_HIST,3,"<![CDATA[

        SELECT UP.TRANSACTION_SERIAL_NO AS COLLECT_NO, 
               VE.FACILITY_CODE, 
               UP.EQUIPMENT_ID, 
               UP.UPLOAD_LOT_ID AS LOT_ID, 
               UP.PRODUCT_SPECIFICATION_ID AS PRODUCT_SPECIFICATION_ID,  
 	       UP.PRODUCT_SPECIFICATION_VERSION, 
               CASE WHEN UP.UPLOAD_TYPE_CODE ='SV_COLLECT-I' 
	            THEN 'I' 
	  	    ELSE 'C' 
		    END AS COLLECT_TYPE,
	       CASE WHEN UP.AUTO_DATA_COLLECTION_FLAG = '' 
		    THEN '1' 
		    ELSE UP.AUTO_DATA_COLLECTION_FLAG 
		    END AS AUTO_FLAG, 
               CASE WHEN UP.EQUIPMENT_TEST_MODE_FLAG = ''  
	            THEN '0' 
		    ELSE UP.EQUIPMENT_TEST_MODE_FLAG 
		    END AS TEST_FLAG, 
		    UP.TRANSACTION_DATE AS COLLECT_TIME,
	       CASE WHEN UP.EQUIPMENT_ID LIKE 'M1CT%' AND UP.COLLECTION_ATTRIBUTE1 = '0' 
		    THEN 'TOP' 
		    WHEN UP.EQUIPMENT_ID LIKE 'M1CT%' AND UP.COLLECTION_ATTRIBUTE1 = '1' 
	            THEN 'BACK'
		    ELSE '' 
		    END AS TOPBACK_TYPE
	  FROM RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST UP WITH(NOLOCK) 
	 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
	    ON (VE.EQUIPMENT_ID = UP.EQUIPMENT_ID)
	 WHERE UP.UPLOAD_TYPE_CODE IN ('SV_COLLECT-I', 'SV_COLLECT-C')
	   AND UP.PROCESS_FLAG = 'P'
	   AND ISNULL(UP.EQUIPMENT_TEST_MODE_FLAG, '0') <> '1' 
	   AND (UP.UPLOAD_TYPE_CODE ='SV_COLLECT-I' OR VE.RUN_FLAG_USE_FLAG = 'N' OR (VE.RUN_FLAG_USE_FLAG = 'Y' AND UP.EQUIPMENT_RUN_FLAG = '1'))
	   AND ISNULL(UP.COLLECTION_ATTRIBUTE2, '0') <> '1' 
	   AND ISNULL(UP.COLLECTION_ATTRIBUTE3, '0') <> '1' 
	   AND NOT EXISTS (SELECT 1
          FROM (SELECT TOP 1 MW.END_DATE
 	          FROM RMSPLUS.TB_MES_WIP_HIST MW WITH(NOLOCK) 
		 WHERE MW.EQUIPMENT_ID = CASE WHEN VE.MAIN_EQUIPMENT_FLAG = 'Y' 
		                              THEN VE.EQUIPMENT_ID 
	 				      ELSE VE.MAIN_EQUIPMENT_ID 
					      END
		   AND MW.LOT_ID = UP.MES_LOT_ID
		 ORDER BY MW.WIP_SEQ DESC) DT
         WHERE DT.END_DATE < UP.TRANSACTION_DATE)
           AND UP.PRODUCT_SPECIFICATION_ID IS NOT NULL
           AND UP.PRODUCT_SPECIFICATION_ID <> ''
	   AND UP.PRODUCT_SPECIFICATION_VERSION IS NOT NULL
	   AND UP.PRODUCT_SPECIFICATION_VERSION <> ''
	 ORDER BY UP.EQUIPMENT_ID, UP.TRANSACTION_DATE

]]>"
sqlserver_select_TB_RMS_REL_RECIPE_INFO,1,"<![CDATA[

SELECT * 
  FROM RMSPLUS.TB_RMS_REL_RECIPE_INFO WITH(NOLOCK)
 WHERE FACILITY_CODE = #{facilityCode}
   AND EQUIPMENT_ID = #{equipmentId}
   AND PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
   AND PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
   AND RECIPE_ID = #{recipeId}
   AND RECIPE_VERSION = #{recipeVersion}
   AND RECIPE_MAP_VERSION = #{recipeMapVersion}
   AND USE_FLAG = 'Y'

]]>"
sqlserver_select_TB_RMS_SMS_SEND_INFO,1,"<![CDATA[

	SELECT ISNULL(MIN('Y'), 'N') AS PREV_SEND_FLAG
	  FROM RMSPLUS.TB_RMS_SMS_SEND_INFO SSI WITH(NOLOCK) 
	 WHERE SSI.SMS_TYPE_CODE = #{smsTypeCode}
	   AND SSI.EQUIPMENT_ID = #{equipmentId} 
	   AND SSI.LOT_ID = #{lotId}
	   AND SSI.VALIDATION_CODE = #{validationCode} 
	
]]>"
sqlserver_select_TB_RMS_VALIDATION_INFO,1,"<![CDATA[

	SELECT TOP 1 
   	       VALIDATION_SEQ_NO, 
               LAST_TRANSACTION_DATE, 
               VALIDATION_RESULT_CODE, 
               RECIPE_ID, 
               RECIPE_VERSION, 
               RECIPE_MAP_VERSION
          FROM RMSPLUS.TB_RMS_VALIDATION_INFO VH WITH(NOLOCK)
         WHERE VH.FACILITY_CODE = #{facilityCode}
           AND VH.EQUIPMENT_ID = #{equipmentId}
           AND VH.EQP_PROD_SPEC_ID = #{eqpProdSpecId}
           AND VH.EQP_PROD_SPEC_VERSION = #{eqpProdSpecVersion} 
	   AND VH.LOT_ID = #{lotId}
	   AND VH.VALIDATION_MODE_CODE = #{validationModeCode} 
	 ORDER BY LAST_TRANSACTION_DATE DESC

]]>"
sqlserver_select_TB_RMS_VALIDATION_INFO,2,"<![CDATA[

	SELECT TOP 1 
               VALIDATION_SEQ_NO, 
               LAST_TRANSACTION_DATE, 
               VALIDATION_RESULT_CODE, 
               RECIPE_ID, 
               RECIPE_VERSION, 
               RECIPE_MAP_VERSION 
	       PRODUCT_SPECIFICATION_ID, 
               PRODUCT_SPECIFICATION_VERSION
          FROM RMSPLUS.TB_RMS_VALIDATION_INFO VH WITH(NOLOCK)
         WHERE VH.FACILITY_CODE = #{facilityCode}
           AND VH.EQUIPMENT_ID = #{equipmentId}
           AND LAST_TRANSACTION_DATE > GETDATE() - #{searchTime}
         ORDER BY LAST_TRANSACTION_DATE DESC

]]>"
sqlserver_select_TB_RMS_VALIDATION_INFO,3,"<![CDATA[

         SELECT TOP 1 
	        VALIDATION_SEQ_NO, 
                LAST_TRANSACTION_DATE, 
                ISNULL(LOT_ID,'') AS LOT_ID, 
                ISNULL(SUBSTRING(PRODUCT_SPECIFICATION_VERSION,1,3),'') AS PRODUCT_SPECIFICATION_VERSION
           FROM RMSPLUS.TB_RMS_VALIDATION_INFO VD WITH(NOLOCK)
          WHERE FACILITY_CODE = #{facilityCode}
            AND EQUIPMENT_ID = #{equipmentId}
            AND LOT_ID  = #{lotId}
            AND LAST_TRANSACTION_DATE  > DATEADD(DAY, -1, #{collectTime})
            AND LAST_TRANSACTION_DATE      < #{collectTime}
	  ORDER BY LAST_TRANSACTION_DATE DESC

]]>"
sqlserver_select_TB_RMS_VALIDATION_INFO,4,"<![CDATA[  

    SELECT TOP 1          
           VALIDATION_SEQ_NO, 
	   LAST_TRANSACTION_DATE,
	   PRODUCT_SPECIFICATION_ID,
	   PRODUCT_SPECIFICATION_VERSION,
           RECIPE_ID,
	   RECIPE_VERSION,
	   RECIPE_MAP_VERSION,
	   VALIDATION_RESULT_CODE
      FROM RMSPLUS.TB_RMS_VALIDATION_INFO VD WITH(NOLOCK)            
     WHERE FACILITY_CODE = #{facilityCode}
       AND EQUIPMENT_ID = #{equipmentId}
       AND LAST_TRANSACTION_DATE > DATEADD(DAY, -1, #{collectTime})              
       AND LAST_TRANSACTION_DATE < #{collectTime}     
 ORDER BY LAST_TRANSACTION_DATE DESC  

]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO,1,"<![CDATA[

	SELECT COUNT(*) AS CNT
	  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK,INDEX(PK_TB_RMS_VALIDATION_ITEM_INFO))
	 WHERE FACILITY_CODE = #{facilityCode}
	   AND VALIDATION_SEQ_NO = #{validationSeqNo}
	   AND USE_FLAG = 'Y'

]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO,2,"<![CDATA[

	SELECT COUNT(*) AS CHECK_CNT, 
	       MIN(DH.PARAMETER_ID) AS SPEC_OVER_PARAMETER_ID, 
	       RMSPLUS.FN_GET_LANG_DATA(#{basicLang}, ISNULL(MIN(EP.PARAMETER_NAME), '')) AS SPEC_OVER_PARAMETER_NAME  
	  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK, INDEX(PK_TB_RMS_VALIDATION_ITEM_INFO))
	 INNER JOIN RMSPLUS.TB_RMS_VALIDATION_INFO VI WITH(NOLOCK)
	    ON (VI.FACILITY_CODE = DH.FACILITY_CODE
	   AND VI.VALIDATION_SEQ_NO = DH.VALIDATION_SEQ_NO)
     INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST EP WITH(NOLOCK)
        ON EP.FACILITY_CODE = DH.FACILITY_CODE
       AND EP.EQUIPMENT_GROUP_ID = (SELECT EQUIPMENT_GROUP_ID
                                      FROM RMSPLUS.TB_RMS_EQUIPMENT_MST EM WITH(NOLOCK)
                                     WHERE EM.FACILITY_CODE = VI.FACILITY_CODE 
                                       AND EM.EQUIPMENT_ID = VI.EQUIPMENT_ID)
       AND EP.PARAMETER_ID = DH.PARAMETER_ID
	 WHERE DH.FACILITY_CODE = #{facilityCode}
	   AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
	   AND DH.USE_FLAG = 'Y'
	   AND DH.VALIDATION_RESULT_CODE = '1'

]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO,3,"<![CDATA[

	SELECT ISNULL(MIN('Y'), 'N') AS SPEC_CHANGE_FLAG
  	  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK, INDEX(PK_TB_RMS_VALIDATION_ITEM_INFO))
	 WHERE FACILITY_CODE = #{facilityCode}
           AND VALIDATION_SEQ_NO = #{validationSeqNo}
	   AND USE_FLAG = 'Y'
	   AND VALIDATION_RESULT_CODE = '1' 
	   AND DOWNLOAD_VALUE_FLAG = 'Y'

]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO,4,"<![CDATA[

	
		SELECT #{equipmentId} AS EQUIPMENT_ID, 
			   (CASE WHEN (#{validationResultCode}='0' OR #{validationFlag} = 'N') 
			         THEN '10' 
			         ELSE '11' 
			         END) AS VALIDATION_RESULT_CODE,   
			   (CASE WHEN (#{validationResultCode}='0' OR #{validationFlag} = 'N') 
			         THEN '0' 
			         ELSE RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationCode}, 'ERROR_CODE', #{hmiLanguageCode}) 
			         END) AS ERROR_CODE, 
			   (CASE WHEN (#{validationResultCode}='0' OR #{validationFlag} = 'N') 
			         THEN '' 
			         ELSE RMSPLUS.FN_GET_VAL_MSG(#{facilityCode}, #{validationCode}, 'ERROR_MESSAGE', #{hmiLanguageCode}) 
			         END) AS ERROR_MSG, 
			   #{productSpecificationId} AS PRODUCT_SPECIFICATION_ID,
			   #{productSpecificationVersion} AS PRODUCT_SPECIFICATION_VERSION,
			   #{recipeId} AS RECIPE_ID,
			   #{recipeVersion} AS RECIPE_VERSION,
			   #{recipeMapVersion} AS RECIPE_MAP_VERSION,
			   #{equipmentRecipeId} AS EQUIPMENT_RECIPE_ID,
			   #{parameterTotalCount} AS PARAMETER_TOTAL_COUNT,
			   COUNT(DH.VALIDATION_RESULT_CODE) AS PARAMETER_NG_COUNT     
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK)
		 WHERE DH.FACILITY_CODE = #{facilityCode}
	       AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND DH.VALIDATION_RESULT_CODE = '1'
	
	
]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO,5,"<![CDATA[

	
		SELECT TOP 1 'Y' AS VALUE_CHANGE_FLAG
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO VD WITH(NOLOCK)
		 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE = VD.FACILITY_CODE 
		   AND EP.EQUIPMENT_ID = VD.EQUIPMENT_ID 
		   AND EP.PARAMETER_ID = VD.PARAMETER_ID)
		 INNER JOIN RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK) 
		    ON (PL.FUNCTION_NAME = #{functionName} 
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
		   AND PL.EQUIPMENT_PARAMETER_ID = VD.EQUIPMENT_PARAMETER_ID)
	 	 WHERE VD.FACILITY_CODE = #{facilityCode}
 		   AND VD.EQUIPMENT_ID = #{equipmentId}	
	 	   AND VD.VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND EP.RMS_USE_FLAG = 'Y'
		   AND ISNULL(VD.EQUIPMENT_VALUE, '') != ISNULL(PL.REQUEST_VALUE, '') 
	
	
]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO,6,"<![CDATA[

    SELECT TOP 1 'Y' AS VALUE_CHANGE_FLAG
      FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO VD WITH(NOLOCK)
     INNER JOIN TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK) 
        ON (PL.TRANSACTION_SERIAL_NO = #{transactionSerialNo} 
       AND PL.FUNCTION_NAME = #{functionName}
       AND PL.EQUIPMENT_PARAMETER_ID = VD.EQUIPMENT_PARAMETER_ID
       AND ISNULL(PL.REQUEST_VALUE, '') <> ISNULL(VD.EQUIPMENT_VALUE, ''))
     WHERE VD.FACILITY_CODE = #{facilityCode}
       AND VD.VALIDATION_SEQ_NO= #{validationSeqNo}

 ]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO,7,"<![CDATA[

    SELECT COUNT(1) AS CNT 
      FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK)
     INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK)
        ON (EP.FACILITY_CODE = DH.FACILITY_CODE
       AND EP.EQUIPMENT_ID = DH.EQUIPMENT_ID
       AND EP.PARAMETER_ID = DH.PARAMETER_ID)
     WHERE DH.FACILITY_CODE = #{facilityCode}
       AND DH.VALIDATION_SEQ_NO= #{validationSeqNo}
       AND EP.GRADE_CODE IN ('2', '3')

]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO,8,"<![CDATA[
	
	SELECT COUNT(*) AS CHECK_CNT, 
   	       MIN(DH.PARAMETER_ID) AS SPEC_OVER_PARAMETER_ID, 
	       RMSPLUS.FN_GET_LANG_DATA(#{basicLang}, ISNULL(MIN(PM.PARAMETER_NAME), '')) AS SPEC_OVER_PARAMETER_NAME  
	  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK, INDEX(PK_TB_RMS_VALIDATION_ITEM_INFO))
	 INNER JOIN RMSPLUS.TB_RMS_VALIDATION_INFO VI WITH(NOLOCK)
            ON (VI.FACILITY_CODE = DH.FACILITY_CODE
	   AND VI.VALIDATION_SEQ_NO = DH.VALIDATION_SEQ_NO)
         INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO ER WITH(NOLOCK)
	    ON (ER.FACILITY_CODE = DH.FACILITY_CODE
	   AND ER.EQUIPMENT_ID = DH.EQUIPMENT_ID
	   AND ER.RECIPE_ID = DH.RECIPE_ID
	   AND ER.RECIPE_VERSION = DH.RECIPE_VERSION
	   AND ER.RECIPE_MAP_VERSION = DH.RECIPE_MAP_VERSION
	   AND ER.PRODUCT_SPECIFICATION_ID = VI.PRODUCT_SPECIFICATION_ID
	   AND ER.PRODUCT_SPECIFICATION_VERSION = VI.PRODUCT_SPECIFICATION_VERSION)
         INNER JOIN RMSPLUS.TB_RMS_RECIPE_MAP_VERSION_INFO RMV WITH(NOLOCK)
	    ON (RMV.FACILITY_CODE = DH.FACILITY_CODE
	   AND RMV.RECIPE_ID = DH.RECIPE_ID
	   AND RMV.RECIPE_MAP_VERSION = DH.RECIPE_MAP_VERSION
	   AND RMV.PARAMETER_ID = DH.PARAMETER_ID)
         INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_MST EM WITH(NOLOCK)
	    ON (EM.FACILITY_CODE = DH.FACILITY_CODE
	   AND EM.EQUIPMENT_ID = DH.EQUIPMENT_ID)
         INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK)
	    ON (PM.FACILITY_CODE = DH.FACILITY_CODE
	   AND PM.EQUIPMENT_GROUP_ID = EM.EQUIPMENT_GROUP_ID
	   AND PM.PARAMETER_ID = DH.PARAMETER_ID)
	 WHERE DH.FACILITY_CODE = #{facilityCode}
           AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
	   AND DH.USE_FLAG = 'Y'
	   AND DH.VALIDATION_RESULT_CODE = '1'

]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO,9,"<![CDATA[

    SELECT COUNT(*) AS CHECK_CNT
      FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK, INDEX(PK_TB_RMS_VALIDATION_ITEM_INFO))
     WHERE FACILITY_CODE = #{facilityCode}
       AND VALIDATION_SEQ_NO = #{validationSeqNo} 
       AND EQUIPMENT_ID = #{equipmentId} 
       AND ISNULL(PARAMETER_ID, '') = '' 

]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO_cust,1,"<![CDATA[

		SELECT COUNT(*) AS CHECK_CNT, 
			   ISNULL(SUM((CASE WHEN DH.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId} 
			                   THEN 1 
			                   ELSE 0 
			                   END)),0) AS CHECK_MIX_MTRL_CNT
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK) 
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND EQUIPMENT_ID = #{equipmentId} 
		   AND VALIDATION_SEQ_NO = #{validationSeqNo} 
		   AND ISNULL(PARAMETER_ID, '') = '' 

]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO_cust,2,"<![CDATA[

	   SELECT #{equipmentId} AS EQUIPMENT_ID, 
                  STEP_NO, 
                  (CASE WHEN SUM(CONVERT(NUMERIC, VALIDATION_RESULT_CODE)) > 0 
	                THEN '11' 
	                ELSE'10' 
	                END) AS VALIDATION_RESULT_CODE   --10:OK, 11:NG
            FROM (SELECT SUBSTRING(RIGHT(PL.EQUIPMENT_PARAMETER_ID, 5), 1, 2) AS STEP_NO, 
                         ISNULL(DH.VALIDATION_RESULT_CODE, 0) AS VALIDATION_RESULT_CODE 
	            FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_INFO PL WITH(NOLOCK)
	            LEFT OUTER JOIN RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK)
	              ON (DH.FACILITY_CODE = #{facilityCode}
		     AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
		     AND DH.EQUIPMENT_PARAMETER_ID = PL.EQUIPMENT_PARAMETER_ID)
		   WHERE PL.FUNCTION_NAME = #{functionName}
		     AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}        
		 ) DT
	   GROUP BY STEP_NO
	   ORDER BY STEP_NO
	
]]>"
sqlserver_select_TB_RMS_VALIDATION_ITEM_INFO_cust,3," <![CDATA[

   SELECT EM.GBIS_EQUIPMENT_ID,
          RM.RECIPE_TYPE_CODE,
          CI.BUSINESS_USAGE_CODE_DESC AS RECIPE_TYPE_NAME,
          PM.PARAMETER_ID,
          PM.PARAMETER_NAME,
          VII.LSL_VALUE,
          ISNULL(VII.TARGET_VALUE, '') AS TARGET_VALUE,
          VII.USL_VALUE,
          VII.EQUIPMENT_VALUE
     FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO VII WITH(NOLOCK)
    INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_MST EM WITH(NOLOCK)
       ON EM.FACILITY_CODE = VII.FACILITY_CODE
      AND EM.EQUIPMENT_ID = VII.EQUIPMENT_ID
    INNER JOIN RMSPLUS.TB_RMS_RECIPE_MST RM WITH(NOLOCK)
       ON RM.FACILITY_CODE = VII.FACILITY_CODE
      AND RM.RECIPE_ID = VII.RECIPE_ID       
    INNER JOIN RMSCMN.TB_EGN_CODE_ITEM_INFO CI WITH(NOLOCK)
       ON CI.FACILITY_CODE = RM.FACILITY_CODE
      AND BUSINESS_USAGE_TYPE_CODE = 'RECIPE_TYPE'
      AND CI.BUSINESS_USAGE_CODE_ID = RM.RECIPE_TYPE_CODE
    INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK)
       ON PM.FACILITY_CODE = VII.FACILITY_CODE
      AND PM.EQUIPMENT_GROUP_ID = EM.EQUIPMENT_GROUP_ID
      AND PM.PARAMETER_ID = VII.PARAMETER_ID
    WHERE VII.FACILITY_CODE = #{facilityCode}
      AND VII.VALIDATION_SEQ_NO = #{validationSeqNo}
      AND VII.VALIDATION_RESULT_CODE = 1
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_MST,1,"<![CDATA[

	SELECT ISNULL(VE.FACILITY_CODE, 'X') AS FACILITY_CODE,
	       ISNULL(VE.EQUIPMENT_ID, 'X') AS EQUIPMENT_ID,
	       RMSPLUS.FN_GET_LANG_DATA(#{basicLang}, VE.EQUIPMENT_NAME) AS EQUIPMENT_NAME,
	       (SELECT RMSPLUS.FN_GET_LANG_DATA(#{basicLang}, AM.FACTORY_AREA_DESC) AS LINE_NAME 
	          FROM RMSCMN.TB_EGN_FCTRY_AREA_MST AM WITH(NOLOCK)
		 WHERE AM.REPRESENTATIVE_FACTORY_CODE = VE.FACILITY_CODE
		   AND AM.FACTORY_AREA_ID = VE.FACTORY_AREA_ID) AS LINE_NAME, 
               VE.PLANT_CODE AS PLANT_CODE,           
	       VE.RECIPE_TYPE_UNIT_CODE AS RECIPE_TYPE_UNIT_CODE,
	       ISNULL(VE.SMS_USE_FLAG, 'N') AS SMS_EQP_FLAG,
	       ISNULL(VE.RMS_APPLY_FLAG, 'N') AS RMS_APPLY_FLAG,
	       ISNULL(VE.GRADE_CODE, 'H') AS GRADE_CODE,
	       ISNULL(VE.PROD_SPEC_INPUT_FLAG, 'N') AS PROD_SPEC_INPUT_FLAG,
	       VE.RECIPE_ID_PREFIX_VALUE AS RECIPE_ID_PREFIX_VALUE,
	       VE.INPUT_LOT_TYPE_CODE AS INPUT_LOT_TYPE_CODE,
	       (CASE WHEN ISNULL(VE.RMS_MODE_TYPE_CODE,'') IN ('0', '3') 
	             THEN ISNULL(VE.RMS_MODE_CODE,'') 
	             ELSE #{rmsModeCode} 
	             END) AS RMS_MODE_CODE, -- RMS ON/OFF ê´€ë¦??¤ë¹„??UI MODEë¡? ?¤ì •
	       ISNULL(VE.PRE_VALIDATION_TYPE_CODE, 'N') AS PRE_VALIDATION_TYPE_CODE
	  FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE 
         WHERE VE.EQUIPMENT_ID = #{equipmentId}

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_MST,2,"<![CDATA[

	
		SELECT ISNULL(MIN(VE.FACILITY_CODE), 'X') AS FACILITY_CODE,
		       ISNULL(MIN(VE.EQUIPMENT_ID), 'X') AS EQUIPMENT_ID,
			   MIN(VE.RECIPE_TYPE_UNIT_CODE) AS RECIPE_TYPE_UNIT_CODE,
			   MIN(VE.DOWNLOAD_TYPE_CODE) AS DOWNLOAD_TYPE_CODE,
			   MIN(VE.RECIPE_ID_PREFIX_VALUE) AS RECIPE_ID_PREFIX_VALUE,
			   MIN(VE.INPUT_LOT_TYPE_CODE) AS INPUT_LOT_TYPE_CODE,
			   MIN(VE.DOWNLOAD_USE_FLAG) AS DOWNLOAD_USE_FLAG,
			   ISNULL(MIN(VE.PROD_SPEC_INPUT_FLAG),'N') AS PROD_SPEC_INPUT_FLAG,
			   ISNULL(MIN(VE.LAST_PARAM_VALUE_REQUIRED_FLAG),'N') AS LAST_PARAM_VALUE_REQUIRED_FLAG,
			   ISNULL(MIN(VE.RMS_MODE_TYPE_CODE),'') AS RMS_MODE_TYPE_CODE,
			   (CASE WHEN ISNULL(MIN(VE.RMS_MODE_TYPE_CODE),'') ='3' 
			         THEN ISNULL(MIN(VE.RMS_MODE_CODE),'') 
			         ELSE #{rmsModeCode} 
			         END) AS RMS_MODE_CODE -- RMS ON/OFF ê´€ë¦??¤ë¹„??UI MODEë¡? ?¤ì •
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
		 WHERE VE.EQUIPMENT_ID = #{equipmentId}
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_MST,3,"<![CDATA[
	
		SELECT ISNULL(VE.FACILITY_CODE, 'X') AS FACILITY_CODE,
		       ISNULL(VE.EQUIPMENT_ID, 'X') AS EQUIPMENT_ID,
		       RMSPLUS.FN_GET_LANG_DATA(#{basicLang}, VE.EQUIPMENT_NAME) AS EQUIPMENT_NAME,
		       (SELECT RMSPLUS.FN_GET_LANG_DATA(#{basicLang}, AM.FACTORY_AREA_DESC) 
			  FROM RMSCMN.TB_EGN_FCTRY_AREA_MST AM WITH(NOLOCK)
			 WHERE AM.REPRESENTATIVE_FACTORY_CODE = VE.FACILITY_CODE
			   AND AM.FACTORY_AREA_ID = VE.FACTORY_AREA_ID) AS LINE_NAME, 
	               VE.PLANT_CODE AS PLANT_CODE,           
		       VE.RECIPE_TYPE_UNIT_CODE AS RECIPE_TYPE_UNIT_CODE, 
		       ISNULL(VE.RMS_APPLY_FLAG, 'N') AS RMS_APPLY_FLAG,
		       ISNULL(VE.GRADE_CODE, 'H') AS GRADE_CODE,
		       ISNULL(VE.PROD_SPEC_INPUT_FLAG, 'N') AS PROD_SPEC_INPUT_FLAG,
		       VE.RECIPE_ID_PREFIX_VALUE AS RECIPE_ID_PREFIX_VALUE,
		       VE.INPUT_LOT_TYPE_CODE AS INPUT_LOT_TYPE_CODE,
		       (CASE WHEN ISNULL(VE.RMS_MODE_TYPE_CODE,'') ='3' 
		             THEN ISNULL(VE.RMS_MODE_CODE,'') 
		             ELSE #{rmsModeCode} 
		             END) AS RMS_MODE_CODE -- RMS ON/OFF ê´€ë¦??¤ë¹„??UI MODEë¡? ?¤ì •
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_MST 
		 WHERE VE.EQUIPMENT_ID = #{equipmentId}

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_MST,4,"<![CDATA[

	
		SELECT MIN(VE.FACILITY_CODE) AS FACILITY_CODE,
		       ISNULL(MIN(VE.EQUIPMENT_ID), 'X') AS EQUIPMENT_ID, 
			   MIN(VE.RECIPE_TYPE_UNIT_CODE) AS RECIPE_TYPE_UNIT_CODE, 
			   ISNULL(MIN(VE.RMS_APPLY_FLAG), 'N') AS RMS_APPLY_FLAG,
			   ISNULL(MIN(VE.GRADE_CODE), 'H') AS GRADE_CODE,
			   MIN(VE.RECIPE_ID_PREFIX_VALUE) AS RECIPE_ID_PREFIX_VALUE,
			   MIN(VE.INPUT_LOT_TYPE_CODE) AS INPUT_LOT_TYPE_CODE,
			   ISNULL(MIN(VE.PROD_SPEC_INPUT_FLAG), 'N') AS PROD_INPUT_FLAG,
			   MIN(VE.RMS_MODE_TYPE_CODE) AS RMS_MODE_TYPE_CODE,
			   (CASE WHEN ISNULL(MIN(VE.RMS_MODE_TYPE_CODE),'') ='3' 
			         THEN ISNULL(MIN(VE.RMS_MODE_CODE),'') 
			         ELSE #{rmsModeCode} 
			         END) AS RMS_MODE_CODE               -- RMS ON/OFF ê´€ë¦??¤ë¹„??UI MODEë¡? ?¤ì •
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE
		 WHERE VE.EQUIPMENT_ID =  #{equipmentId}
		   AND ISNULL(VE.UPLOAD_USE_FLAG,'N') ='Y'
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_MST,5,"<![CDATA[

	
		SELECT ISNULL(MIN(VE.FACILITY_CODE), 'X') AS FACILITY_CODE,
		       ISNULL(MIN(VE.EQUIPMENT_ID), 'X') AS EQUIPMENT_ID,
			   MIN(VE.RECIPE_ID_PREFIX_VALUE) AS RECIPE_ID_PREFIX_VALUE,
			   ISNULL(MIN(VE.PROD_SPEC_INPUT_FLAG),'N') AS PROD_SPEC_INPUT_FLAG,
			   (CASE WHEN MIN(VE.RECIPE_TYPE_UNIT_CODE) = 'B' 
			         THEN '000' 
			         ELSE #{productSpecificationVersion} 
			         END) AS PRODUCT_SPECIFICATION_VERSION
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE
		 WHERE (VE.EQUIPMENT_ID = #{equipmentId})
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_MST,6,"<![CDATA[

	
		SELECT ISNULL(MIN(VE.FACILITY_CODE), '') AS FACILITY_CODE, 
		       ISNULL(MIN('Y'), 'N') AS SMS_USE_FLAG
          FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE
         INNER JOIN RMSPLUS.TB_RMS_MAIL_SMS_USER_INFO US WITH(NOLOCK) 
		    ON (US.FACILITY_CODE = VE.FACILITY_CODE
		   AND US.MAIL_TYPE_CODE = 'MAIL_TYPE_MGR_GROUP'
		   AND US.MAIL_KEY_VALUE_1 = VE.MGR_GROUP_ID)
		 WHERE VE.EQUIPMENT_ID = #{equipmentId}
		   AND US.MAIL_KEY_VALUE_2 = #{validationCode} 
		   AND VE.SMS_USE_FLAG = 'Y'  
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_MST,7,"<![CDATA[

	SELECT VE.EQUIPMENT_GROUP_ID AS EQUIPMENT_GROUP_ID,
    	       VE.PROCESS_CODE AS PROCESS_CODE,	
	       VE.EQUIPMENT_ID AS EQUIPMENT_ID 
	  FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE 
         WHERE VE.EQUIPMENT_ID = #{equipmentId}

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_MST_cust,1,"<![CDATA[

		SELECT VE.EQUIPMENT_GROUP_ID AS EQUIPMENT_GROUP_ID,
			   VE.PROCESS_CODE AS PROCESS_CODE,	
	           VE.EQUIPMENT_ID AS EQUIPMENT_ID,
	           VE.GRADE_CODE AS GRADE_CODE,
	           (CASE WHEN VE.RECIPE_ID_PREFIX_VALUE LIKE #{recipeIdPrefixValue} 
	                 THEN 'Y' 
	                 ELSE 'N' 
	                 END) AS RECIPE_PREFIX_MATCH_FLAG 
	      FROM RMSPLUS.VW_RMS_EQUIPMENT_MST VE
	     WHERE VE.EQUIPMENT_ID = #{equipmentId}

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,1,"<![CDATA[

	SELECT EP.PARAMETER_ID AS PARAMETER_ID,
               (CASE WHEN EP.GRADE_CODE ='1' 
	             THEN 'N' 
	             ELSE #{useFlag} 
	             END) AS USE_FLAG
	 FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
        WHERE EP.EQUIPMENT_ID = #{equipmentId}
	  AND EP.EQUIPMENT_PARAMETER_ID = #{equipmentParameterId}
	  AND EP.RMS_USE_FLAG ='Y'
	  AND EP.USE_FLAG = 'Y'

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,2,"<![CDATA[

	
		SELECT RMSPLUS.FN_GET_LANG_DATA(#{hmiLanguageCode}, EP.PARAMETER_DISPLAY_NAME) AS PARAMETER_NAME,        
			   ISNULL(EP.GRADE_CODE,'0') AS GRADE_CODE,     
			   RV.LSL_VALUE AS LSL_VALUE,
		  	   ISNULL(RV.TARGET_VALUE,'') AS TARGET_VALUE,
			   RV.USL_VALUE AS USL_VALUE,
			   (CASE WHEN (EP.SPEC_TYPE_CODE = 'F' AND CONVERT(FLOAT,ISNULL(#{parameterValue}, '')) != RV.TARGET_VALUE) 
			         THEN '1'
				     WHEN ((EP.SPEC_TYPE_CODE = 'R') AND ((CONVERT(FLOAT, #{parameterValue}) < CONVERT(FLOAT, (CASE WHEN RV.LSL_VALUE IS NULL 
				                                                                                                    THEN #{parameterValue} 
				                                                                                                    ELSE RV.LSL_VALUE 
				                                                                                                    END)
				                                                                                     )
				                                         ) 
				                                         OR 
				                                         (CONVERT(FLOAT, #{parameterValue}) > CONVERT(FLOAT, (CASE WHEN RV.USL_VALUE IS NULL 
				                                                                                                   THEN #{parameterValue} 
				                                                                                                   ELSE RV.USL_VALUE 
				                                                                                                   END)
				                                                                                   )
				                                         )
				                                        )
				         ) 
				     THEN '1'
					 ELSE '0'
					 END) AS RESULT_CODE
		 FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
		INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK) 
		   ON (RV.FACILITY_CODE = EP.FACILITY_CODE 
		       AND RV.RECIPE_ID = EP.RECIPE_ID 
		       AND RV.RECIPE_VERSION = EP.RECIPE_VERSION 
		       AND RV.PARAMETER_ID = EP.PARAMETER_ID)
	    WHERE EP.FACILITY_CODE = #{facilityCode}
	      AND EP.EQUIPMENT_ID = #{equipmentId}
		  AND EP.PARAMETER_ID = #{parameterId}
		  AND EP.RECIPE_ID = #{recipeId}
			  
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,3,"<![CDATA[

		SELECT COUNT(PARAMETER_ID) AS CNT
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
	     WHERE EP.FACILITY_CODE = #{facilityCode}
	       AND EP.EQUIPMENT_ID = #{equipmentId}
	       AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId} 
	       AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion} 
	       AND EP.RECIPE_ID = #{recipeId} 
	       AND EP.RECIPE_VERSION = #{recipeVersion}
	       AND ISNULL(EP.USE_FLAG, '') != '' 
	       AND ISNULL(EP.EQUIPMENT_PARAMETER_ID, '') != ''
	       AND ISNULL(EP.RMS_USE_FLAG,'N') ='Y'
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,4,"<![CDATA[

	SELECT COUNT(*) CNT
   	  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
         WHERE EP.FACILITY_CODE = #{facilityCode}
           AND EP.EQUIPMENT_ID = #{equipmentId}
           AND EP.EQUIPMENT_PARAMETER_ID = #{equipmentParameterId}
           AND EP.USE_FLAG = 'Y'

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,5,"<![CDATA[

    SELECT ISNULL(RV.RECIPE_ID,'') AS RECIPE_ID,
?‚â€‚â€‚â€‚â€‚â€‚â€‚â€?  ISNULL(RV.PARAMETER_ID,'') AS PARAMETER_ID,
?‚â€‚â€‚â€‚â€‚â€‚â€‚â€?  ISNULL(RMSPLUS.FN_GET_LANG_DATA(#{hmiLanguageCode}, EP.PARAMETER_DISPLAY_NAME), '') AS PARAMETER_NAME,       HMI PARAëª??‚â€‚â€‚â€‚â€‚â€‚â€‚â€?  ISNULL(EP.GRADE_CODE,'0') AS GRADE_CODE,     GRADE
?‚â€‚â€‚â€‚â€‚â€‚â€‚â€?  ISNULL(CONVERT(NVARCHAR, CONVERT(FLOAT,  RV.LSL_VALUE )),'') AS LSL_VALUE,
?‚â€‚â€‚â€‚â€‚â€‚â€‚â€?  ISNULL(RV.TARGET_VALUE,'') AS TARGET_VALUE,
?‚â€‚â€‚â€??‚â€‚â€?  ISNULL(CONVERT(NVARCHAR, CONVERT(FLOAT,  RV.USL_VALUE )),'') AS USL_VALUE,
?‚â€‚â€‚â€‚â€‚â€‚â€‚â€?  ISNULL(EP.RMS_USE_FLAG,'') AS RMS_USE_FLAG
?‚â€‚â€‚â€‚â€?FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
?‚â€‚â€‚â€‚â€‚INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
?‚â€‚â€‚â€‚â€?  ON (RV.FACILITY_CODE = EP.FACILITY_CODE
?‚â€‚â€‚â€‚â€? AND RV.RECIPE_ID = EP.RECIPE_ID
?‚â€‚â€‚â€‚â€? AND RV.RECIPE_VERSION = EP.RECIPE_VERSION
?‚â€‚â€‚â€‚â€? AND RV.PARAMETER_ID = EP.PARAMETER_ID)
?‚â€‚â€‚â€‚â€‚WHERE EP.FACILITY_CODE = #{facilityCode}
?‚â€‚â€‚â€‚â€? AND EP.EQUIPMENT_ID = #{equipmentId}
?‚â€‚â€‚â€‚â€? AND EP.EQUIPMENT_PARAMETER_ID = #{equipmentParameterId}
?‚â€‚â€‚â€‚â€? AND EP.EQUIPMENT_RECIPE_ID = #{equipmentRecipeId}

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,6,"<![CDATA[

	SELECT COUNT(*) AS CNT
  	  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
	 INNER JOIN RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL WITH(NOLOCK) 
	    ON (PL.FUNCTION_NAME = #{functionName} 
		    AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
		    AND PL.PARAMETER_ID = EP.PARAMETER_ID)
	 WHERE EP.FACILITY_CODE = #{facilityCode}
	   AND EP.EQUIPMENT_ID = #{equipmentId}
	   AND EP.RECIPE_ID = #{recipeId}

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,7,"<![CDATA[

	
		SELECT COUNT(*) AS CNT
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
		 WHERE EP.FACILITY_CODE = #{facilityCode}
		   AND EP.EQUIPMENT_ID = #{equipmentId}
	       AND EP.EQUIPMENT_RECIPE_ID = #{equipmentRecipeId}
		   AND EP.PARAMETER_ID = #{parameterId} 
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,8,"<![CDATA[

	
		SELECT ISNULL(MIN(EP.RECIPE_ID), '') AS RECIPE_ID,  
			   ISNULL(MIN(EP.RECIPE_VERSION), 0) AS RECIPE_VERSION,
			   ISNULL(MIN(EP.EQUIPMENT_RECIPE_ID), '') AS EQUIPMENT_RECIPE_ID,
			   ISNULL(MIN(EP.RECIPE_MAP_VERSION), 0) AS RECIPE_MAP_VERSION
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
	  	 WHERE EP.FACILITY_CODE = #{facilityCode}
	  	   AND EP.EQUIPMENT_ID  = #{equipmentId}
	       AND EP.PRODUCT_SPECIFICATION_ID      = #{productSpecificationId}
		   AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
		   AND EP.USE_FLAG = 'Y' 
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,9,"<![CDATA[

	
		SELECT COUNT(*) AS CNT
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
		 WHERE EP.FACILITY_CODE = #{facilityCode}
		   AND EP.EQUIPMENT_ID = #{equipmentId}
		   AND ISNULL(EP.EQUIPMENT_PARAMETER_ID,'') = #{equipmentParameterId}
		   AND EP.RMS_USE_FLAG ='Y' 
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,10,"<![CDATA[

	
		SELECT ISNULL(MAX(RECIPE_ID), '') AS RECIPE_ID, 
		       ISNULL(MAX(RECIPE_VERSION), 0) AS RECIPE_VERSION,
		       ISNULL(MAX(RECIPE_MAP_VERSION), 0) AS RECIPE_MAP_VERSION,
		       ISNULL(MAX(EQUIPMENT_RECIPE_ID), '') AS EQUIPMENT_RECIPE_ID		       
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
		 WHERE EP.FACILITY_CODE = #{facilityCode}
		   AND EP.EQUIPMENT_ID = #{equipmentId}
		   AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
		   AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
		   AND USE_FLAG = 'Y' 
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,11,"<![CDATA[

	
	SELECT ISNULL(MAX(EP.PRODUCT_SPECIFICATION_VERSION),#{insProdSpecVersion}) AS INS_PROD_SPEC_VERSION,
	       COUNT(*) AS CHECK_CNT 
          FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
	 INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK)
	    ON (PM.FACILITY_CODE = EP.FACILITY_CODE 
	   AND PM.MGR_GROUP_ID = EP.MGR_GROUP_ID
	   AND PM.EQUIPMENT_GROUP_ID = EP.EQUIPMENT_GROUP_ID
	   AND PM.PARAMETER_ID = EP.PARAMETER_ID )
         INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
	    ON (RV.FACILITY_CODE = #{facilityCode} 
	   AND RV.RECIPE_ID = EP.RECIPE_ID 
	   AND RV.PARAMETER_ID = EP.PARAMETER_ID )   
	 WHERE EP.FACILITY_CODE = #{facilityCode}
	   AND EP.EQUIPMENT_ID = #{equipmentId}
	   AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
	   AND EP.PRODUCT_SPECIFICATION_VERSION LIKE #{prodSpecVersion} + '%'
	   AND ISNULL(PM.VALIDATION_VERSION_CHECK_FLAG,'N') ='Y' 
	   AND (CASE WHEN ISNULL(EP.PRODUCT_SPECIFICATION_VERSION,'') != '' 
	             THEN CONVERT(FLOAT,ISNULL(RV.TARGET_VALUE, '')) 
	             ELSE 0 
	             END) = CONVERT(FLOAT,ISNULL(#{firstValue},''))

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,12,"<![CDATA[

	
		SELECT COUNT(*) AS CNT
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
		 WHERE EP.FACILITY_CODE = #{facilityCode}
		   AND EP.EQUIPMENT_ID = #{equipmentId} 
		   AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
		   AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
		   AND EP.RECIPE_ID = #{recipeId}
		   AND EP.RECIPE_VERSION = #{recipeVersion}
		   AND ISNULL(EP.EQUIPMENT_PARAMETER_ID, '') != ''
		   AND EP.RMS_USE_FLAG='Y'
		   AND EP.USE_FLAG = 'Y'  
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,13,"<![CDATA[
 
	
	SELECT DISTINCT 
	       EP.PARAMETER_MANAGE_USE_FLAG, EP.DATA_TYPE_CODE, EP.SPEC_TYPE_CODE, EP.EQUIPMENT_ID, EP.RECIPE_ID,
	       EP.PARAMETER_ID, EP.STEP_SEQ_NO, EP.INTERLOCK_USE_FLAG, RV.TARGET_VALUE, RV.LSL_VALUE, 
	       RV.USL_VALUE
	  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
         INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
            ON (RV.FACILITY_CODE = EP.FACILITY_CODE
           AND RV.RECIPE_ID = EP.RECIPE_ID
           AND RV.RECIPE_VERSION = EP.RECIPE_VERSION
           AND RV.PARAMETER_ID = EP.PARAMETER_ID)
 	 WHERE EP.FACILITY_CODE = #{facilityCode}
	   AND EP.EQUIPMENT_ID = #{equipmentId}
	   AND EP.USE_FLAG = 'Y'
	   AND EP.RECIPE_ID = RV.RECIPE_ID
	   AND EP.RECIPE_VERSION = RV.RECIPE_VERSION
	   AND EP.PARAMETER_ID = RV.PARAMETER_ID
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,14,"<![CDATA[
	
	SELECT DISTINCT EP.PARAMETER_MANAGE_USE_FLAG, EP.DATA_TYPE_CODE, EP.SPEC_TYPE_CODE, EP.EQUIPMENT_ID, EP.RECIPE_ID,
	   	        EP.PARAMETER_ID, EP.STEP_SEQ_NO, EP.INTERLOCK_USE_FLAG, RV.TARGET_VALUE, RV.LSL_VALUE, 
			RV.USL_VALUE
	  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
         INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
            ON (RV.FACILITY_CODE = EP.FACILITY_CODE
           AND RV.RECIPE_ID = EP.RECIPE_ID
           AND RV.RECIPE_VERSION = EP.RECIPE_VERSION
           AND RV.PARAMETER_ID = EP.PARAMETER_ID)
         WHERE EP.FACILITY_CODE = #{facilityCode}
	   AND EP.EQUIPMENT_ID = #{equipmentId}
	   AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
	   AND EP.RECIPE_ID = #{recipeId}
	   AND EP.USE_FLAG = 'Y'
	   AND EP.RECIPE_ID = RV.RECIPE_ID
	   AND EP.RECIPE_VERSION = RV.RECIPE_VERSION
	   AND EP.PARAMETER_ID = RV.PARAMETER_ID

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,15,"<![CDATA[
 
	
		SELECT DISTINCT EP.PARAMETER_MANAGE_USE_FLAG, EP.DATA_TYPE_CODE, EP.SPEC_TYPE_CODE, EP.EQUIPMENT_ID, EP.RECIPE_ID,
			   EP.PARAMETER_ID, EP.STEP_SEQ_NO, EP.INTERLOCK_USE_FLAG, RV.TARGET_VALUE, RV.LSL_VALUE, 
			   RV.USL_VALUE
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
         INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
            ON (RV.FACILITY_CODE = EP.FACILITY_CODE
                AND RV.RECIPE_ID = EP.RECIPE_ID
                AND RV.RECIPE_VERSION = EP.RECIPE_VERSION
                AND RV.PARAMETER_ID = EP.PARAMETER_ID)
 		 WHERE EP.FACILITY_CODE = #{facilityCode}
		   AND EP.EQUIPMENT_ID = #{equipmentId}
		   AND EP.USE_FLAG = 'Y'
		   AND EP.RECIPE_ID = RV.RECIPE_ID
		   AND EP.RECIPE_VERSION = RV.RECIPE_VERSION
		   AND EP.PARAMETER_ID = RV.PARAMETER_ID
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,16,"<![CDATA[

	
		SELECT DISTINCT EP.PARAMETER_MANAGE_USE_FLAG, EP.DATA_TYPE_CODE, EP.SPEC_TYPE_CODE, EP.EQUIPMENT_ID, EP.RECIPE_ID,
			   EP.PARAMETER_ID, EP.STEP_SEQ_NO, EP.INTERLOCK_USE_FLAG, RV.TARGET_VALUE, RV.LSL_VALUE, 
			   RV.USL_VALUE
		  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
         INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
            ON (RV.FACILITY_CODE = EP.FACILITY_CODE
                AND RV.RECIPE_ID = EP.RECIPE_ID
                AND RV.RECIPE_VERSION = EP.RECIPE_VERSION
                AND RV.PARAMETER_ID = EP.PARAMETER_ID)
 		 WHERE EP.FACILITY_CODE = #{facilityCode}
		   AND EP.EQUIPMENT_ID = #{equipmentId}
		   AND EP.RECIPE_ID = #{recipeId}
		   AND EP.USE_FLAG = 'Y'
		   AND EP.RECIPE_ID = RV.RECIPE_ID
		   AND EP.RECIPE_VERSION = RV.RECIPE_VERSION
		   AND EP.PARAMETER_ID = RV.PARAMETER_ID
	
	
]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,17,"<![CDATA[

	SELECT DISTINCT 
               FACILITY_CODE, 
               PROCESS_CODE, 
               EQUIPMENT_ID, 
               PRODUCT_SPECIFICATION_ID, 
               PRODUCT_SPECIFICATION_VERSION, 
               RECIPE_ID, 
               RECIPE_VERSION, 
               RECIPE_MAP_VERSION
          FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,18,"<![CDATA[

    SELECT COUNT(1) AS CHECK_COUNT
      FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
     WHERE EP.FACILITY_CODE = #{facilityCode}
       AND EP.EQUIPMENT_ID  = #{equipmentId}
       AND EP.PRODUCT_SPECIFICATION_ID      = #{productSpecificationId}
       AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
       AND EP.RMS_USE_FLAG = 'Y'
       AND EP.USE_FLAG = 'Y' 

]]>"
sqlserver_select_VW_RMS_EQUIPMENT_PARAMETER,19,"<![CDATA[

SELECT EP.EQUIPMENT_ID, 
       EP.PRODUCT_SPECIFICATION_ID, 
       EP.PRODUCT_SPECIFICATION_VERSION,
       EP.PARAMETER_ID,
       EP.EQUIPMENT_PARAMETER_ID, 
       EP.SPEC_TYPE_CODE,
       RV.LSL_VALUE, 
       RV.TARGET_VALUE, 
       RV.USL_VALUE, 
       EP.RMS_USE_FLAG
  FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
 INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK)
    ON (RV.RECIPE_ID = EP.RECIPE_ID AND RV.RECIPE_VERSION = EP.RECIPE_VERSION AND EP.PARAMETER_ID = RV.PARAMETER_ID)
 WHERE EQUIPMENT_ID  = #{equipmentId}
   AND PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
   AND PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
   AND EP.USE_FLAG = 'Y' 

]]>"
sqlserver_update_DUAL,1,"<![CDATA[

	    {
	        call RMSPLUS.RMS_BATCH_COVERAGE()
	    }
	
]]>"
sqlserver_update_TB_RMS_BATCH_JOB_INFO,1,"<![CDATA[

    UPDATE RMSPLUS.TB_RMS_BATCH_JOB_INFO 
       SET RUN_FLAG = #{runFlag} 
     WHERE FACILITY_CODE = #{facilityCode}
       AND BATCH_ID = #{batchJobId}

]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,2,"<![CDATA[

	
		UPDATE PL
		   SET PL.RMS_VALUE = #{rmsValue}
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL
		 WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo} 
		   AND PL.PARAMETER_FLAG=#{parameterFlag}
		   AND (PL.DOWNLOAD_FLAG=#{downloadFlag} OR ISNULL(PL.RMS_VALUE, '') = '') 	
	
	
]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,3,"<![CDATA[

        UPDATE PL
		   SET PL.RMS_VALUE = (SELECT UD.UPLOAD_VALUE
					 FROM RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST UD WITH(NOLOCK) 
					WHERE UD.TRANSACTION_SERIAL_NO = #{validationSeqNo}
					  AND UD.EQUIPMENT_PARAMETER_ID  = PL.EQUIPMENT_PARAMETER_ID)
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL
		 WHERE PL.FUNCTION_NAME=#{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.PARAMETER_FLAG=#{parameterFlag}
		   AND (PL.DOWNLOAD_FLAG=#{downloadFlag} OR ISNULL(PL.RMS_VALUE, '') = '')

]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,4,"<![CDATA[

 	
 		UPDATE RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO
		   SET USE_FLAG = 'N'
	  	 WHERE FUNCTION_NAME = #{functionName}
		   AND TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND ISNULL(REPLACE(EQUIPMENT_VALUE, ' ', ''), '') = ''
		   AND USE_FLAG = 'Y'
	
 	
]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,5,"<![CDATA[

 	
 		UPDATE PL
		   SET USE_FLAG = (SELECT ISNULL(MIN(EP.RMS_USE_FLAG), 'N')
	                         FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
	                        WHERE EP.EQUIPMENT_ID = #{equipmentId}
	                          AND EP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
	                          AND EP.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
	                          AND EP.PARAMETER_ID = PL.PARAMETER_ID)
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL
		 WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.USE_FLAG = 'Y'
	
 	
]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,6,"<![CDATA[

 	
 		UPDATE PL
		   SET PL.USE_FLAG = (SELECT ISNULL(MIN('N'), 'Y') 
	     			        FROM RMSPLUS.TB_RMS_PROD_EXCEPT_PARAM_INFO XP WITH(NOLOCK) 
	     		               WHERE XP.EQUIPMENT_ID = #{equipmentId}
	       		                 AND XP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
	       				 AND XP.PARAMETER_ID = PL.PARAMETER_ID
	       				 AND XP.EXCEPT_FLAG = 'Y')
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL
	     WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.USE_FLAG = 'Y'
	
 	
]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,7,"<![CDATA[

 	UPDATE PL 
           SET PL.USE_FLAG = 'N'
	  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL
	 WHERE PL.FUNCTION_NAME = #{functionName}
	   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
	   AND PL.USE_FLAG = 'Y' 
	   AND ISNULL(PL.SPEC_TYPE_CODE, 'N') = 'N'
 	
]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,8,"<![CDATA[

	
 		UPDATE PL 
		   SET PL.USE_FLAG = 'N'
	   	  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL
	 	 WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.USE_FLAG = 'Y' 
		   AND ISNULL(PL.RMS_VALUE, '') = ''
	
 	
]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,9,"<![CDATA[

		UPDATE PL 
		   SET PL.USE_FLAG = 'N'
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL
	 	 WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.USE_FLAG = 'Y' 
		   AND DOWNLOAD_FLAG = 'N'	

]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO,10,"<![CDATA[

	
		UPDATE PL 
		   SET PL.USE_FLAG = 'N'
		  FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL
	     WHERE PL.FUNCTION_NAME = #{functionName}
		   AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		   AND PL.USE_FLAG = 'Y' 
		   AND PL.DOWNLOAD_FLAG = 'N'
		   AND PL.LAST_VALUE_NO_APPLY_FLAG = 'Y'	
	
 	
]]>"
sqlserver_update_TB_RMS_EQP_REQ_PARAM_DOWN_INFO_cust,1,"<![CDATA[

        UPDATE PL
		   SET PL.RMS_VALUE = (SELECT (CASE WHEN PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId1} 
		                                    THEN (SELECT UPPER(ISNULL(MIN(MC.MATERIAL_NAME), ''))
							    FROM RMSPLUS.TB_COM_MIX_MATERIAL_INFO MM WITH(NOLOCK)
							   INNER JOIN RMSPLUS.TB_COM_MIX_MATERIAL_CODE_MST MC WITH(NOLOCK) 
							      ON (MC.MATERIAL_ID = MM.MATERIAL_ID)
							   WHERE MM.FACILITY_CODE = #{facilityCode}
						             AND MM.EQUIPMENT_ID = #{equipmentId}
						             AND MM.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
							     AND MM.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
							     AND MM.PARAMETER_ID = PD.PARAMETER_ID)
							    WHEN PL.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId2} 
							    THEN CONVERT(NVARCHAR, ROUND(CONVERT(FLOAT, ISNULL(PD.TARGET_VALUE,''))*#{batchSize}/100,2))		  
							    ELSE PD.TARGET_VALUE
							    END)
					FROM (SELECT ER.EQUIPMENT_ID, ER.RECIPE_ID, RV.PARAMETER_ID, RV.TARGET_VALUE 
					        FROM RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO ER WITH(NOLOCK)
                                               INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK) 
                                                  ON (RV.FACILITY_CODE = ER.FACILITY_CODE 
                                                 AND RV.RECIPE_ID = ER.RECIPE_ID 
                                                 AND RV.RECIPE_VERSION = ER.RECIPE_VERSION 
                                                 AND ER.USE_FLAG = 'Y')
                                             ) PD 
			                     WHERE PD.EQUIPMENT_ID = #{equipmentId} 
					       AND PD.RECIPE_ID = #{recipeId} 
					       AND PD.PARAMETER_ID = PL.PARAMETER_ID)
		 FROM RMSPLUS.TB_RMS_EQP_REQ_PARAM_DOWN_INFO PL
	    WHERE PL.FUNCTION_NAME = #{functionName}
		  AND PL.TRANSACTION_SERIAL_NO=#{transactionSerialNo}
		  AND PL.PARAMETER_FLAG = #{parameterFlag}

]]>"
sqlserver_update_TB_RMS_EQUIPMENT_RECIPE_INFO,1,"<![CDATA[

	
		UPDATE RMSPLUS.TB_RMS_EQUIPMENT_RECIPE_INFO
   		   SET RECIPE_VERSION = #{recipeVersion}, 
       		   LAST_UPDATE_USER_ID = #{lastUpdateUserId},
	   		   LAST_UPDATE_DATE = #{lastUpdateDate}
 		 WHERE FACILITY_CODE = #{facilityCode} 
   		   AND EQUIPMENT_ID = #{equipmentId}
   		   AND RECIPE_ID = #{recipeId}
   		   AND USE_FLAG = 'Y'
	
	
]]>"
sqlserver_update_TB_RMS_EQUIPMENT_STATE_HIST,1,"<![CDATA[

	
		UPDATE RMSPLUS.TB_RMS_EQUIPMENT_STATE_HIST
		   SET CURRENT_FLAG = 'H',
		       LAST_UPDATE_DATE = GETDATE()
		 WHERE CURRENT_FLAG = 'C'
		   AND FACILITY_CODE = #{facilityCode}
		   AND EQUIPMENT_ID = #{equipmentId}
		   AND TRANSACTION_SERIAL_NO <  #{transactionSerialNo}; --?íƒœë³€ê²½ì´ ì§§ì„ê²½ìš° ?„ìž¬ ?¤ë¹„?íƒœ ì²˜ë¦¬?¼ì‹œ ?´ì „???°ì´?€ë§?ë³€ê²?	
	
]]>"
sqlserver_update_TB_RMS_ID_INFO,1,"<![CDATA[

		UPDATE RMSPLUS.TB_RMS_ID_INFO WITH (ROWLOCK)
		   SET ID_DESC = ID_DESC
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND ID_TYPE_CODE = #{idTypeCode}

]]>"
sqlserver_update_TB_RMS_ID_INFO,2,"<![CDATA[

	
		UPDATE RMSPLUS.TB_RMS_ID_INFO
		   SET CURRENT_ID  = #{newId}, CURRENT_SEQ = #{currentSeq}					 
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND ID_TYPE_CODE = #{idTypeCode}
	
	
]]>"
sqlserver_update_TB_RMS_RCP_PARAM_UPLOAD_HIST,1,"<![CDATA[

		
		UPDATE DH
		   SET DH.UPLOAD_VALUE = '0', 
		       DH.LAST_UPDATE_DATE = GETDATE()
		  FROM RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST DH
		 INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_MST EQ WITH(NOLOCK) 
		    ON (EQ.FACILITY_CODE = DH.FACILITY_CODE 
		   AND EQ.EQUIPMENT_ID = DH.EQUIPMENT_ID)
		 INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST GP WITH(NOLOCK) 
		    ON (GP.FACILITY_CODE = DH.FACILITY_CODE 
		   AND GP.PARAMETER_ID = DH.PARAMETER_ID) 
		 WHERE DH.FACILITY_CODE = #{facilityCode}
		   AND DH.TRANSACTION_SERIAL_NO = #{transactionSerialNo}
		   AND DH.EQUIPMENT_ID = #{equipmentId}
		   AND DH.UPLOAD_TYPE_CODE = #{uploadTypeCode}
		   AND GP.CELL_TYPE_CODE IN ('POUCH', 'CYLINDRICAL') 
  		   AND ISNULL(GP.CELL_TYPE_CODE,'') != (SELECT CELL_TYPE_CODE 
  		                                          FROM RMSPLUS.TB_COM_PRODUCT_SPEC_MST WITH(NOLOCK)
  		                                         WHERE PRODUCT_SPECIFICATION_ID = #{productSpecificationId})
	
	
]]>"
sqlserver_update_TB_RMS_RCP_PARAM_UPLOAD_HIST,2,"<![CDATA[

		
		UPDATE DH
		   SET DH.UPLOAD_VALUE = '0'
		  FROM RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST DH 
		 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
		    ON (VE.FACILITY_CODE = DH.FACILITY_CODE 
		   AND VE.EQUIPMENT_ID = DH.EQUIPMENT_ID)
		 INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST GP WITH(NOLOCK) 
		    ON (GP.FACILITY_CODE = DH.FACILITY_CODE 
		   AND GP.PARAMETER_ID = DH.PARAMETER_ID) 
		 INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_PARAM_INFO EP WITH(NOLOCK) 
		    ON (EP.FACILITY_CODE = DH.FACILITY_CODE 
		   AND EP.EQUIPMENT_ID = DH.EQUIPMENT_ID 
		   AND EP.PARAMETER_ID = GP.PARAMETER_ID) 
		 WHERE DH.FACILITY_CODE = #{facilityCode}
		   AND DH.TRANSACTION_SERIAL_NO = #{transactionSerialNo} 
		   AND DH.EQUIPMENT_ID = #{equipmentId}
		   AND DH.UPLOAD_TYPE_CODE = #{uploadTypeCode}
		   AND ISNULL(GP.DOUBLE_LAYER_FLAG,'N') = 'Y'
		   AND ISNULL(GP.DOUBLE_LAYER_FLAG,'N') != (SELECT ISNULL(MIN(PD.DOUBLE_LAYER_FLAG),'N') 
					                      FROM RMSPLUS.TB_COM_PRODUCT_SPEC_DETAIL PD WITH(NOLOCK) 
					                     WHERE PD.FACILITY_CODE = DH.FACILITY_CODE
							       AND PD.PRODUCT_SPECIFICATION_ID = #{productSpecificationId} 
							       AND PD.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion})
	
]]>"
sqlserver_update_TB_RMS_RCP_PARAM_UPLOAD_HIST,3,"<![CDATA[

	UPDATE DH
    	    SET DH.UPLOAD_VALUE = '0',
	        DH.LAST_UPDATE_DATE = GETDATE()
	   FROM RMSPLUS.TB_RMS_RCP_PARAM_UPLOAD_HIST DH 
	  INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_MST EQ WITH(NOLOCK) 
	     ON (EQ.FACILITY_CODE = DH.FACILITY_CODE 
            AND EQ.EQUIPMENT_ID = DH.EQUIPMENT_ID)
	  INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST GP WITH(NOLOCK) 
	     ON (GP.FACILITY_CODE = DH.FACILITY_CODE 
	    AND GP.PARAMETER_ID = DH.PARAMETER_ID)
	  WHERE DH.FACILITY_CODE = #{facilityCode}
            AND DH.TRANSACTION_SERIAL_NO = #{transactionSerialNo} 
            AND DH.EQUIPMENT_ID = #{equipmentId}
	    AND DH.UPLOAD_TYPE_CODE = #{uploadTypeCode}
            AND GP.TOP_BACK_TYPE_CODE IN ('1', '2')  
	    AND ISNULL(GP.TOP_BACK_TYPE_CODE,'') != #{topBackTypeCode}

]]>"
sqlserver_update_TB_RMS_RCP_UPLOAD_FINAL_HIST,1,"<![CDATA[
	
	MERGE INTO RMSPLUS.TB_RMS_RCP_UPLOAD_FINAL_HIST T 
        USING (SELECT #{facilityCode} AS FACILITY_CODE, #{transactionSerialNo} AS TRANSACTION_SERIAL_NO, #{transactionDate} AS TRANSACTION_DATE, 
                      #{equipmentId} AS EQUIPMENT_ID, #{uploadTypeCode}	AS UPLOAD_TYPE_CODE, #{recipeId} AS RECIPE_ID, 
                      #{recipeVersion} AS RECIPE_VERSION, #{uploadLotId} AS UPLOAD_LOT_ID, #{eqpProdSpecId} AS EQP_PROD_SPEC_ID, 
                      #{eqpProdSpecVersion} AS EQP_PROD_SPEC_VERSION, #{validationModeCode}	AS VALIDATION_MODE_CODE, #{productSpecificationId} AS PRODUCT_SPECIFICATION_ID, 
                      #{productSpecificationVersion} AS PRODUCT_SPECIFICATION_VERSION, #{collectionAttribute1} AS COLLECTION_ATTRIBUTE1) S 
           ON (T.FACILITY_CODE = S.FACILITY_CODE 
          AND T.EQUIPMENT_ID = S.EQUIPMENT_ID 
          AND T.PRODUCT_SPECIFICATION_ID = S.PRODUCT_SPECIFICATION_ID 
          AND T.PRODUCT_SPECIFICATION_VERSION  = S.PRODUCT_SPECIFICATION_VERSION 
          AND ISNULL(T.COLLECTION_ATTRIBUTE1,'') = ISNULL(S.COLLECTION_ATTRIBUTE1,''))
         WHEN MATCHED THEN 
              UPDATE 
                 SET T.TRANSACTION_SERIAL_NO = S.TRANSACTION_SERIAL_NO,
                     T.TRANSACTION_DATE = S.TRANSACTION_DATE,
                     T.UPLOAD_LOT_ID = S.UPLOAD_LOT_ID,
                     T.VALIDATION_MODE_CODE = S.VALIDATION_MODE_CODE,
                     T.PRODUCT_SPECIFICATION_ID = S.PRODUCT_SPECIFICATION_ID,
                     T.PRODUCT_SPECIFICATION_VERSION = S.PRODUCT_SPECIFICATION_VERSION,
					 T.COLLECTION_ATTRIBUTE1 = S.COLLECTION_ATTRIBUTE1,
					 T.LAST_UPDATE_USER_ID = 'EIF',
					 T.LAST_UPDATE_DATE = #{transactionDate}					   
         WHEN NOT MATCHED THEN   
              INSERT (FACILITY_CODE, TRANSACTION_SERIAL_NO, TRANSACTION_DATE, EQUIPMENT_ID, UPLOAD_TYPE_CODE,
                      RECIPE_ID, RECIPE_VERSION, UPLOAD_LOT_ID, EQP_PROD_SPEC_ID, EQP_PROD_SPEC_VERSION, 
                      VALIDATION_MODE_CODE, PRODUCT_SPECIFICATION_ID, PRODUCT_SPECIFICATION_VERSION, COLLECTION_ATTRIBUTE1, LAST_UPDATE_USER_ID, 
                      LAST_UPDATE_DATE) 
              VALUES (S.FACILITY_CODE, S.TRANSACTION_SERIAL_NO, S.TRANSACTION_DATE, S.EQUIPMENT_ID, S.UPLOAD_TYPE_CODE, 
                      S.RECIPE_ID, S.RECIPE_VERSION, S.UPLOAD_LOT_ID, S.EQP_PROD_SPEC_ID, S.EQP_PROD_SPEC_VERSION, 
                      S.VALIDATION_MODE_CODE, S.PRODUCT_SPECIFICATION_ID, S.PRODUCT_SPECIFICATION_VERSION, S.COLLECTION_ATTRIBUTE1, #{lastUpdateUserId}, 
                      #{transactionDate} ); -- MERGE ë¬¸ì? ?¸ë?ì½œë¡ ?¼ë¡œ ì¢…ë£Œ?´ì•¼ë§??œë‹¤.
	
	
]]>"
sqlserver_update_TB_RMS_RECIPE_UPLOAD_HIST,1,"<![CDATA[

	
		UPDATE RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST
		   SET PRODUCT_SPECIFICATION_ID = #{productSpecificationId},
			   PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion},
			   VALIDATION_RESULT_CODE = #{validationResultCode},
			   VALIDATION_CODE = #{validationCode},
			   LAST_UPDATE_USER_ID = #{lastUpdateUserId},
			   LAST_UPDATE_DATE = GETDATE()
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND TRANSACTION_SERIAL_NO = #{transactionSerialNo}
		   AND UPLOAD_TYPE_CODE = #{uploadTypeCode}
	
	
]]>"
sqlserver_update_TB_RMS_RECIPE_UPLOAD_HIST,2,"<![CDATA[
	
	UPDATE RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST
           SET VALIDATION_CODE = #{validationCode}, -- RMS ì²˜ë¦¬ ì¤??ëŸ¬ ë°œìƒ
               VALIDATION_RESULT_CODE = #{validationResultCode} 
	WHERE FACILITY_CODE = #{facilityCode}
	  AND TRANSACTION_SERIAL_NO = #{transactionSerialNo}
	  AND UPLOAD_TYPE_CODE = #{uploadTypeCode}
	
]]>"
sqlserver_update_TB_RMS_RECIPE_UPLOAD_HIST,3,"<![CDATA[

        UPDATE RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST
           SET EQP_PROD_SPEC_ID = #{productSpecificationId},
	       EQP_PROD_SPEC_VERSION = #{productSpecificationVersion}
	 WHERE FACILITY_CODE = #{facilityCode}
	   AND TRANSACTION_SERIAL_NO = #{transactionSerialNo}

]]>"
sqlserver_update_TB_RMS_RECIPE_UPLOAD_HIST,4,"<![CDATA[

    UPDATE UP 
	   SET PROCESS_FLAG = 'P',
	       UPLOAD_LOT_ID = CASE WHEN LEN(UP.UPLOAD_LOT_ID) > '7' 
		                        THEN SUBSTRING(UP.UPLOAD_LOT_ID,1,7) 
			             	    ELSE UP.UPLOAD_LOT_ID 
				                END, 
	       PRODUCT_SPECIFICATION_ID = ML.PRODUCT_SPECIFICATION_ID, 
	       PRODUCT_SPECIFICATION_VERSION = ML.PRODUCT_SPECIFICATION_VERSION, 
	       MES_LOT_ID = ML.LOT_ID  
      FROM RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST UP
	 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
	    ON (VE.EQUIPMENT_ID = UP.EQUIPMENT_ID)
     CROSS APPLY (SELECT LOT_ID, 
                         PRODUCT_SPECIFICATION_ID, 
                         PRODUCT_SPECIFICATION_VERSION
	                FROM (SELECT MAX(ML.LOT_ID) AS LOT_ID, 
                                 MAX(ML.PRODUCT_SPECIFICATION_ID) AS PRODUCT_SPECIFICATION_ID, 
                                 MAX(ISNULL(ML.PRODUCT_SPECIFICATION_VERSION,'')) AS PRODUCT_SPECIFICATION_VERSION
			        FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK) 
			       WHERE ML.LARGE_LOT_ID = SUBSTRING(UP.UPLOAD_LOT_ID,1,7)
			         AND ISNULL(ML.PRODUCT_SPECIFICATION_ID, '') <> ''
			         AND ML.LOT_TYPE_CODE = #{lotTypeCode} ) DT
			       WHERE ISNULL(DT.PRODUCT_SPECIFICATION_VERSION, '') <> '' )ML     
 	WHERE UP.UPLOAD_TYPE_CODE IN (#{uploadTypeCode1}, #{uploadTypeCode2})
	  AND UP.PROCESS_FLAG  = 'N'
      AND VE.RECIPE_ID_PREFIX_VALUE = #{recipeIdPrefixValue}

]]>"
sqlserver_update_TB_RMS_RECIPE_UPLOAD_HIST,5,"<![CDATA[

    UPDATE UP  
	   SET PROCESS_FLAG = 'P', 
	       UPLOAD_LOT_ID = CASE WHEN LEN(UP.UPLOAD_LOT_ID) = '9' 
	                            THEN UP.UPLOAD_LOT_ID + '1' 
	            			    ELSE UP.UPLOAD_LOT_ID 
				                END, 
	       PRODUCT_SPECIFICATION_ID   = ML.PRODUCT_SPECIFICATION_ID, 
	       PRODUCT_SPECIFICATION_VERSION = CASE WHEN VE.RECIPE_TYPE_UNIT_CODE = 'B' 
	                                            THEN '000' 
	                                            ELSE ML.PRODUCT_SPECIFICATION_VERSION 
						                        END, 
	       MES_LOT_ID = ML.LOT_ID  
         FROM RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST UP
        INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
           ON (VE.EQUIPMENT_ID = UP.EQUIPMENT_ID)
	CROSS APPLY (SELECT TOP 1
	                    LOT_ID, 
                        PRODUCT_SPECIFICATION_ID, 
                        PRODUCT_SPECIFICATION_VERSION
		           FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK, INDEX([PK_TB_MES_LOT_INFO])) 
	   	          WHERE ML.LOT_ID LIKE UP.UPLOAD_LOT_ID +'%'
		            AND ISNULL(ML.PRODUCT_SPECIFICATION_ID, '') <> ''
		            AND ISNULL(ML.PRODUCT_SPECIFICATION_VERSION, '') <> '') ML      
	     WHERE UP.UPLOAD_TYPE_CODE IN (#{uploadTypeCode1}, #{uploadTypeCode2})
	       AND UP.PROCESS_FLAG = 'N'
	       AND VE.RECIPE_ID_PREFIX_VALUE = #{recipeIdPrefixValue}

]]>"
sqlserver_update_TB_RMS_RECIPE_UPLOAD_HIST,6,"<![CDATA[

        UPDATE UP  
	   SET PROCESS_FLAG = 'P', 
	       UPLOAD_LOT_ID = CASE WHEN LEN(UP.UPLOAD_LOT_ID) = '9' 
       	                            THEN UP.UPLOAD_LOT_ID + '1' 
	                            ELSE UP.UPLOAD_LOT_ID 
				    END, 
	       PRODUCT_SPECIFICATION_ID = ML.PRODUCT_SPECIFICATION_ID, 
	       PRODUCT_SPECIFICATION_VERSION = '000', 
	       MES_LOT_ID = ML.LOT_ID
	  FROM RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST UP
	 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
	    ON (VE.EQUIPMENT_ID = UP.EQUIPMENT_ID)
	 CROSS APPLY (SELECT TOP 1
	                     LOT_ID, 
                             PRODUCT_SPECIFICATION_ID
			FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK, INDEX([PK_TB_MES_LOT_INFO])) 
		       WHERE ML.LOT_ID LIKE UP.UPLOAD_LOT_ID +'%'
			 AND ISNULL(ML.PRODUCT_SPECIFICATION_ID, '') <> '' ) ML      
	WHERE UP.UPLOAD_TYPE_CODE IN (#{uploadTypeCode1}, #{uploadTypeCode2})
	  AND UP.PROCESS_FLAG = 'N'
	  AND VE.RECIPE_ID_PREFIX_VALUE = #{recipeIdPrefixValue}
	  AND VE.INPUT_LOT_TYPE_CODE = #{lotTypeCode}

]]>"
sqlserver_update_TB_RMS_RECIPE_UPLOAD_HIST,7,"<![CDATA[

        UPDATE UP
	   SET PROCESS_FLAG = 'P', 
	       UPLOAD_LOT_ID = ML.LOT_ID, 
	       PRODUCT_SPECIFICATION_ID = ML.PRODUCT_SPECIFICATION_ID, 
	       PRODUCT_SPECIFICATION_VERSION = '000', 
	       MES_LOT_ID = ML.LOT_ID
         FROM RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST UP
	INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_MST VE 
           ON (VE.EQUIPMENT_ID = UP.EQUIPMENT_ID )
		 CROSS APPLY (SELECT TOP 1
	     	          	     LOT_ID, PRODUCT_SPECIFICATION_ID
				FROM RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK, INDEX([PK_TB_MES_LOT_INFO])) 
			       WHERE ML.LOT_ID LIKE LTRIM(RTRIM(UP.UPLOAD_LOT_ID)) +'%'
				 AND ISNULL(ML.PRODUCT_SPECIFICATION_ID, '') <> '' ) ML      
	     WHERE UP.UPLOAD_TYPE_CODE IN (#{uploadTypeCode1}, #{uploadTypeCode2})
		   AND UP.PROCESS_FLAG = 'N'
	       AND VE.FACILITY_CODE LIKE #{facilityCode}

]]>"
sqlserver_update_TB_RMS_RECIPE_UPLOAD_HIST,8,"<![CDATA[

        UPDATE UP  
		   SET PROCESS_FLAG = 'P', 
		       UPLOAD_LOT_ID = ML.LOT_ID, 
			   PRODUCT_SPECIFICATION_VERSION = CASE WHEN VE.RECIPE_TYPE_UNIT_CODE = 'B' 
			                                        THEN '000' 
								ELSE ML.PRODUCT_SPECIFICATION_VERSION 
								END, 
			   MES_LOT_ID = ML.LOT_ID
		  FROM RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST UP
		 INNER JOIN RMSPLUS.TB_MES_LOT_INFO ML WITH(NOLOCK) 
		    ON (ML.LOT_ID = UP.UPLOAD_LOT_ID 
		   AND ISNULL(ML.PRODUCT_SPECIFICATION_ID, '') <> '')
		 INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK) 
		    ON (VE.EQUIPMENT_ID = UP.EQUIPMENT_ID 
		   AND ((VE.RECIPE_TYPE_UNIT_CODE = 'A' AND ISNULL(ML.PRODUCT_SPECIFICATION_VERSION, '') <> '') 
		      OR VE.RECIPE_TYPE_UNIT_CODE = 'B'))
		 WHERE UP.UPLOAD_TYPE_CODE IN (#{uploadTypeCode1}, #{uploadTypeCode2})
		   AND UP.PROCESS_FLAG = 'N' 
		   AND VE.RECIPE_ID_PREFIX_VALUE NOT IN (#{recipeIdPrefixValue1}, #{recipeIdPrefixValue2}, #{recipeIdPrefixValue3})
]]>"
sqlserver_update_TB_RMS_RECIPE_UPLOAD_HIST,9,"<![CDATA[  

    UPDATE UP         
       SET PROCESS_FLAG = 'P'      
      FROM RMSPLUS.TB_RMS_RECIPE_UPLOAD_HIST UP     
     INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_MST VE WITH(NOLOCK)         
        ON (VE.EQUIPMENT_ID = UP.EQUIPMENT_ID)     
     WHERE UP.UPLOAD_TYPE_CODE IN (#{uploadTypeCode1}, #{uploadTypeCode2})       
       AND UP.PROCESS_FLAG = 'N'  

]]>"
sqlserver_update_TB_RMS_RECIPE_VERSION_INFO,1,"<![CDATA[

	
		UPDATE RMSPLUS.TB_RMS_RECIPE_VERSION_INFO
  		   SET TARGET_VALUE = #{targetValue},
  		       SPEC_CHANGE_REASON = #{specChangeReason}, 
   			   LAST_UPDATE_USER_ID = #{lastUpdateUserId},
   			   LAST_UPDATE_DATE = #{lastUpdateDate}
		 WHERE FACILITY_CODE = #{facilityCode}
  		   AND RECIPE_ID = #{recipeId}
  		   AND RECIPE_VERSION = #{recipeVersion}
  		   AND PARAMETER_ID = #{parameterId}
	
	
]]>"
sqlserver_update_TB_RMS_SMS_SEND_INFO,1,"<![CDATA[

	
		MERGE INTO RMSPLUS.TB_RMS_SMS_SEND_INFO T
			 USING (SELECT #{smsTypeCode}     AS SMS_TYPE_CODE,
			 			   #{equipmentId} AS EQUIPMENT_ID,
						   #{lotId}       AS LOT_ID,
						   #{validationCode}   AS VALIDATION_CODE) S
				ON (T.SMS_TYPE_CODE = S.SMS_TYPE_CODE 
				    AND T.EQUIPMENT_ID = S.EQUIPMENT_ID)    
			  WHEN MATCHED THEN 
			  UPDATE  
			     SET LOT_ID = #{lotId}, 
				     VALIDATION_CODE = #{validationCode}, 
				     TRANSACTION_DATE = #{transactionDate} 
			  WHEN NOT MATCHED THEN    
			  INSERT (FACILITY_CODE, SMS_TYPE_CODE, EQUIPMENT_ID, LOT_ID, VALIDATION_CODE, 
			          TRANSACTION_DATE) 
			  VALUES (#{facilityCode}, #{smsTypeCode}, #{equipmentId}, #{lotId}, #{validationCode}, 
			          #{transactionDate}); -- MERGE ë¬¸ì? ?¸ë?ì½œë¡ ?¼ë¡œ ì¢…ë£Œ?´ì•¼ë§??œë‹¤. 
	
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_INFO,1,"<![CDATA[

	
		UPDATE RMSPLUS.TB_RMS_VALIDATION_INFO
		   SET RECIPE_ID = #{recipeId},
			   RECIPE_VERSION = #{recipeVersion},
			   RECIPE_MAP_VERSION = #{recipeMapVersion},
			   PRODUCT_SPECIFICATION_ID = #{productSpecificationId},
			   PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}, 
			   VALIDATION_RESULT_CODE = #{validationResultCode},
		       VALIDATION_CODE = #{validationCode},
			   COLLECTION_TYPE_CODE = #{collectType}
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
	
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_INFO,2,"<![CDATA[

	
	UPDATE RMSPLUS.TB_RMS_VALIDATION_INFO
           SET VALIDATION_CODE = #{validationCode},
               VALIDATION_RESULT_CODE = #{validationResultCode},
               SYSTEM_ERROR_MESSAGE_CONTENT = #{systemErrorMessageContent}
         WHERE FACILITY_CODE = #{facilityCode}
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
	
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,1,"<![CDATA[

		
		UPDATE DH 
		   SET USE_FLAG = (SELECT ISNULL(MIN('Y'), 'N')
				     FROM RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP WITH(NOLOCK) 
				    WHERE EP.FACILITY_CODE = DH.FACILITY_CODE 
				      AND EP.EQUIPMENT_ID = DH.EQUIPMENT_ID
				      AND EP.PARAMETER_ID = DH.PARAMETER_ID
				      AND EP.RMS_USE_FLAG = 'Y')
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH 
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND USE_FLAG   = 'Y'
		   
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,2,"<![CDATA[

		UPDATE DH
		   SET USE_FLAG = 'N'
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK, INDEX(PK_TB_RMS_VALIDATION_ITEM_INFO))
	     INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_MST EQ WITH(NOLOCK) 
		    ON (EQ.FACILITY_CODE = DH.FACILITY_CODE 
		   AND EQ.EQUIPMENT_ID = DH.EQUIPMENT_ID)
		 INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK) 
		    ON (PM.FACILITY_CODE = DH.FACILITY_CODE 
		   AND PM.PARAMETER_ID = DH.PARAMETER_ID
		   AND PM.EQUIPMENT_GROUP_ID = EQ.EQUIPMENT_GROUP_ID 
		   AND ISNULL(PM.ZERO_VALUE_IGNORE_FLAG, 'N') = 'Y')
		 WHERE DH.FACILITY_CODE = #{facilityCode}
		   AND DH.VALIDATION_SEQ_NO  = #{validationSeqNo}
		   AND DH.USE_FLAG = 'Y'  
		   AND DH.EQUIPMENT_VALUE = '0'

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,3,"<![CDATA[

	
		UPDATE DH
		   SET USE_FLAG = 'N',
		       EQUIPMENT_VALUE = '0'	
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH 
		 INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_MST EQ WITH(NOLOCK) 
		    ON (EQ.EQUIPMENT_ID = DH.EQUIPMENT_ID)
		 INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST PM WITH(NOLOCK) 
		    ON (PM.FACILITY_CODE = DH.FACILITY_CODE
		        AND EQ.FACILITY_CODE = DH.FACILITY_CODE
		        AND PM.EQUIPMENT_GROUP_ID = EQ.EQUIPMENT_GROUP_ID 
		        AND PM.PARAMETER_ID = DH.PARAMETER_ID
		        AND PM.TOP_BACK_TYPE_CODE IN ('1', '2')
		   		AND ISNULL(PM.TOP_BACK_TYPE_CODE, '') != #{topBackTypeCode})
		 WHERE DH.FACILITY_CODE = #{facilityCode} 
		   AND DH.VALIDATION_SEQ_NO  = #{validationSeqNo}
		   AND DH.USE_FLAG = 'Y'
		   
	
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,4,"<![CDATA[

	
		UPDATE DH 
		   SET USE_FLAG = (SELECT ISNULL(MIN('N'), 'Y') 
						   FROM RMSPLUS.TB_RMS_PROD_EXCEPT_PARAM_INFO XP WITH(NOLOCK) 
						  WHERE XP.FACILITY_CODE = #{facilityCode}
						    AND XP.EQUIPMENT_ID = DH.EQUIPMENT_ID
							AND XP.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
							AND XP.PARAMETER_ID = DH.PARAMETER_ID
							AND XP.EXCEPT_FLAG = 'Y')
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH 
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND USE_FLAG = 'Y'
    
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,5,"<![CDATA[

	
		UPDATE DH 
		   SET USE_FLAG = 'N'
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK, INDEX(PK_TB_RMS_VALIDATION_ITEM_INFO))
		 WHERE FACILITY_CODE = #{facilityCode} 
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND USE_FLAG = 'Y' 
		   AND SPEC_TYPE_CODE = 'N' 
	
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,6,"<![CDATA[

    UPDATE DH
       SET DH.USE_FLAG = 'N'
      FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH
     INNER JOIN RMSPLUS.TB_RMS_RECIPE_MAP_VERSION_INFO RMV WITH(NOLOCK)
        ON RMV.FACILITY_CODE = DH.FACILITY_CODE
       AND RMV.RECIPE_ID = DH.RECIPE_ID
       AND RMV.RECIPE_MAP_VERSION = DH.RECIPE_MAP_VERSION
       AND RMV.PARAMETER_ID = DH.PARAMETER_ID
       AND RMV.GRADE_CODE = '1'
     WHERE DH.FACILITY_CODE = #{facilityCode}
       AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
       AND DH.USE_FLAG = 'Y'

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,7,"<![CDATA[

	
	UPDATE RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO
	   SET VALIDATION_RESULT_CODE = (CASE WHEN SPEC_TYPE_CODE = 'F' AND ISNULL(TARGET_VALUE, '') = '' 
	                                      THEN '1'
	 				      WHEN SPEC_TYPE_CODE IN ('R') AND (LSL_VALUE IS NULL AND USL_VALUE IS NULL) 
					      THEN '1'
					      WHEN ISNULL(SPEC_TYPE_CODE, 'N') NOT IN ('F', 'R') 
					      THEN '1'
					      ELSE '0'
					      END)  
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND USE_FLAG = 'Y'
	 
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,8,"<![CDATA[

        UPDATE RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO
		   SET VALIDATION_RESULT_CODE = (CASE WHEN (SPEC_TYPE_CODE = 'F' AND ISNULL(EQUIPMENT_VALUE, 'X') != ISNULL(TARGET_VALUE, 'X')) 
		                                      THEN '1'
		                                      WHEN (SPEC_TYPE_CODE = 'R' 
		                                           AND #{recipeIdPrefixValue} ='MIX' 
		                                           AND (LSL_VALUE IS NULL 
		                                           AND USL_VALUE IS NULL 
		                                           AND CONVERT(FLOAT, ISNULL(EQUIPMENT_VALUE, '0.0')) > 0) ) 
		                                      THEN '1' 
							                  WHEN (SPEC_TYPE_CODE = 'R' 
							                       AND ((CONVERT(FLOAT, ISNULL(EQUIPMENT_VALUE, '0.0')) < CONVERT(FLOAT, CASE WHEN LSL_VALUE IS NULL 
							                                                                                   THEN ISNULL(EQUIPMENT_VALUE, '0.0') 
							                                                                                   ELSE ISNULL(LSL_VALUE, '0.0')  
							                                                                                   END)) 
							                            OR (CONVERT(FLOAT, ISNULL(EQUIPMENT_VALUE, '0.0')) > CONVERT(FLOAT, CASE WHEN USL_VALUE IS NULL 
							                                                                                 THEN ISNULL(EQUIPMENT_VALUE, '0.0') 
							                                                                                 ELSE ISNULL(USL_VALUE, '0.0')  
							                                                                                 END)
							                                                                                 )
							                           )
							                      ) 
							                  THEN '1' 
							                  ELSE '0'	
							                  END)
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND EQUIPMENT_PARAMETER_ID NOT LIKE #{equipmentParameterId}  
		   AND USE_FLAG = 'Y'                                           
		   AND VALIDATION_RESULT_CODE = '0'

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,9,"<![CDATA[

	UPDATE DH
	   SET DOWNLOAD_VALUE_FLAG = (SELECT TOP 1 'Y'
				        FROM (SELECT TOP 1 
						     FACILITY_CODE, EQUIPMENT_ID, TRANSACTION_SERIAL_NO
					        FROM RMSPLUS.TB_RMS_RECIPE_DOWN_HIST WITH(NOLOCK)
					       WHERE EQUIPMENT_ID = #{equipmentId}
						 AND REP_PROD_SPEC_ID = #{productSpecificationId}
						 AND REP_PROD_SPEC_VERSION = #{productSpecificationVersion}
						 AND VALIDATION_RESULT_CODE = '0'
					       ORDER BY TRANSACTION_DATE DESC) DW
					       INNER LOOP JOIN RMSPLUS.TB_RMS_RECIPE_PARAM_DOWN_HIST DD WITH(NOLOCK) 
					     	    	    ON (DD.FACILITY_CODE = DW.FACILITY_CODE
							   AND DD.EQUIPMENT_ID = DW.EQUIPMENT_ID
							   AND DD.TRANSACTION_SERIAL_NO = DW.TRANSACTION_SERIAL_NO)
					       WHERE DD.PARAMETER_ID = DH.PARAMETER_ID
					         AND DD.DOWNLOAD_VALUE = DH.EQUIPMENT_VALUE) 
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH
	    WHERE FACILITY_CODE = #{facilityCode}
	      AND VALIDATION_SEQ_NO = #{validationSeqNo}
	      AND USE_FLAG = 'Y'
	      AND VALIDATION_RESULT_CODE = '1'

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,10,"<![CDATA[

		UPDATE DH 
		   SET USE_FLAG = (SELECT TOP 1 ISNULL(MIN('N'), 'Y')
						     FROM RMSPLUS.TB_RMS_RECIPE_MAP_VERSION_INFO RMV WITH(NOLOCK)
						   WHERE (RMV.FACILITY_CODE = DH.FACILITY_CODE
						      AND RMV.RECIPE_ID = DH.RECIPE_ID
						      AND RMV.RECIPE_MAP_VERSION = DH.RECIPE_MAP_VERSION
						      AND RMV.PARAMETER_ID = DH.PARAMETER_ID)
						      AND RMV.GRADE_CODE ='3'
						      AND ISNULL(RMV.VALIDATION_FLAG, 'Y') = 'N')
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK, INDEX(PK_TB_RMS_VALIDATION_ITEM_INFO))
		 WHERE FACILITY_CODE = #{facilityCode}
	       AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND USE_FLAG = 'Y'

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,11,"<![CDATA[

	
		UPDATE DH
		   SET DH.USE_FLAG = 'N',
		       DH.EQUIPMENT_VALUE = '0'
	      FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH  
		       INNER JOIN RMSPLUS.TB_RMS_EQUIPMENT_MST EQ WITH(NOLOCK) 
		          ON (EQ.FACILITY_CODE = DH.FACILITY_CODE
		              AND EQ.EQUIPMENT_ID = DH.EQUIPMENT_ID)
		       INNER JOIN RMSPLUS.TB_RMS_PARAMETER_MST GP WITH(NOLOCK) 
		          ON (GP.FACILITY_CODE = EQ.FACILITY_CODE 
		              AND GP.PARAMETER_ID = DH.PARAMETER_ID
		              AND GP.CELL_TYPE_CODE IN ('POUCH', 'CYLINDRICAL')
		              AND ISNULL(GP.CELL_TYPE_CODE,'') <> (SELECT CELL_TYPE_CODE 
		                                                     FROM RMSPLUS.TB_COM_PRODUCT_SPEC_MST WITH(NOLOCK) 
		                                                    WHERE PRODUCT_SPECIFICATION_ID = #{productSpecificationId})) 
		 WHERE DH.FACILITY_CODE = #{facilityCode}
	       AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND DH.USE_FLAG = 'Y'
    
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,12,"<![CDATA[

	
		UPDATE DH
		   SET DH.USE_FLAG = 'N',
		       DH.EQUIPMENT_VALUE = '0'
	      FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH   
	     INNER JOIN RMSPLUS.VW_RMS_EQUIPMENT_PARAMETER EP
	        ON (EP.FACILITY_CODE = DH.FACILITY_CODE
		   AND EP.EQUIPMENT_ID = DH.EQUIPMENT_ID
		   AND EP.PARAMETER_ID = DH.PARAMETER_ID
		   AND ISNULL(EP.DOUBLE_LAYER_FLAG,'N') = 'Y'
		   AND ISNULL(EP.DOUBLE_LAYER_FLAG,'N') <>  (SELECT ISNULL(MIN(DOUBLE_LAYER_FLAG),'N') 
		                                               FROM RMSPLUS.TB_COM_PRODUCT_SPEC_DETAIL PD WITH(NOLOCK) 
		                                              WHERE PD.FACILITY_CODE = DH.FACILITY_CODE
								AND PD.PRODUCT_SPECIFICATION_ID = #{productSpecificationId} 
		  						AND PD.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}) )
		 WHERE DH.FACILITY_CODE = #{facilityCode}
           AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND DH.USE_FLAG = 'Y'
    
	
]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,13,"<![CDATA[
	
		UPDATE DH 
		   SET USE_FLAG = (SELECT ISNULL(MIN('Y'), 'N')
						     FROM RMSPLUS.TB_RMS_RECIPE_MAP_VERSION_INFO RMV WITH(NOLOCK)
						    WHERE RMV.FACILITY_CODE = DH.FACILITY_CODE 
						      AND RMV.RECIPE_ID = DH.RECIPE_ID
						      AND RMV.RECIPE_MAP_VERSION = DH.RECIPE_MAP_VERSION
							  AND RMV.RMS_USE_FLAG = 'Y')
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH 
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND USE_FLAG   = 'Y'

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,14,"<![CDATA[

		UPDATE DH 
		   SET USE_FLAG = (SELECT ISNULL(MIN('N'), 'Y')
						     FROM RMSPLUS.TB_RMS_RECIPE_MAP_VERSION_INFO RMV WITH(NOLOCK) 
						    WHERE RMV.FACILITY_CODE = DH.FACILITY_CODE 
						      AND RMV.RECIPE_ID = DH.RECIPE_ID
						      AND RMV.RECIPE_MAP_VERSION = DH.RECIPE_MAP_VERSION
						      AND RMV.PARAMETER_ID = DH.PARAMETER_ID
						      AND RMV.GRADE_CODE ='3'
						      AND ISNULL(RMV.VALIDATION_FLAG, 'Y') = 'N')
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH 
		 WHERE FACILITY_CODE = #{facilityCode}
	       AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND USE_FLAG = 'Y'

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,15,"<![CDATA[

		UPDATE DH 
		   SET USE_FLAG = 'N'
		  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH 
	     WHERE FACILITY_CODE = #{facilityCode}
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND USE_FLAG = 'Y' 
		   AND EXISTS (SELECT 1
						 FROM RMSPLUS.TB_RMS_RECIPE_MAP_VERSION_INFO RMV WITH(NOLOCK)
						WHERE RMV.FACILITY_CODE = DH.FACILITY_CODE
						  AND RMV.RECIPE_ID = DH.RECIPE_ID
						  AND RMV.RECIPE_MAP_VERSION = DH.RECIPE_MAP_VERSION
						  AND RMV.PARAMETER_ID = DH.PARAMETER_ID
						  AND RMV.GRADE_CODE = '1')

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,16,"<![CDATA[

	UPDATE VI
	   SET VI.LSL_VALUE = RV.LSL_VALUE,
	       VI.TARGET_VALUE = RV.TARGET_VALUE,      
	       VI.USL_VALUE = RV.USL_VALUE 
	  FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO VI
	 INNER JOIN RMSPLUS.TB_RMS_VALIDATION_INFO VA WITH(NOLOCK)
	    ON (VA.FACILITY_CODE = VI.FACILITY_CODE 
	   AND VA.VALIDATION_SEQ_NO = VI.VALIDATION_SEQ_NO)
     INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK) 
	    ON (RV.FACILITY_CODE = VI.FACILITY_CODE 
	   AND RV.RECIPE_ID = VI.RECIPE_ID 
	   AND RV.RECIPE_VERSION = VI.RECIPE_VERSION 
	   AND RV.PARAMETER_ID = VI.PARAMETER_ID)
	 WHERE VI.FACILITY_CODE = #{facilityCode}
	   AND VI.VALIDATION_SEQ_NO = #{validationSeqNo} 
	   AND VA.EQUIPMENT_ID = #{equipmentId}
	   AND RV.RECIPE_ID = #{recipeId}
	   AND RV.RECIPE_VERSION = #{recipeVersion}	

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO,17,"<![CDATA[

        UPDATE RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO
	   SET VALIDATION_RESULT_CODE = (CASE WHEN (SPEC_TYPE_CODE = 'F' AND ISNULL(EQUIPMENT_VALUE, 'X') != ISNULL(TARGET_VALUE, 'X')) 
	                                      THEN '1'
	                                      WHEN (SPEC_TYPE_CODE = 'R' 
			                       AND ((CONVERT(FLOAT, ISNULL(EQUIPMENT_VALUE, '0.0')) < CONVERT(FLOAT, CASE WHEN LSL_VALUE IS NULL 
    				                                                                                          THEN ISNULL(EQUIPMENT_VALUE, '0.0') 
							                                                                  ELSE ISNULL(LSL_VALUE, '0.0')  
							                                                                  END)) 
					        OR (CONVERT(FLOAT, ISNULL(EQUIPMENT_VALUE, '0.0')) > CONVERT(FLOAT, CASE WHEN USL_VALUE IS NULL 
					                                                                                 THEN ISNULL(EQUIPMENT_VALUE, '0.0') 
					                                                                                 ELSE ISNULL(USL_VALUE, '0.0')  
					                                                                                 END))
							                           )
							                      ) 
							                  THEN '1' 
							                  ELSE '0'	
							                  END)
		 WHERE FACILITY_CODE = #{facilityCode}
		   AND VALIDATION_SEQ_NO = #{validationSeqNo}
		   AND USE_FLAG = 'Y'                                           
		   AND VALIDATION_RESULT_CODE = '0'

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO_cust,1,"<![CDATA[
	
	UPDATE VI
	   SET VI.LSL_VALUE = (CASE WHEN VI.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId2} 
	                             AND #{gradeCode} = 'F' 
	                             AND RV.LSL_VALUE IS NOT NULL
	                            THEN CONVERT(NVARCHAR,ROUND(CONVERT(FLOAT,ISNULL(RV.LSL_VALUE,'0')) * #{batchSize}/100,2)) 
	                            ELSE RV.LSL_VALUE 
	                            END),
               VI.TARGET_VALUE = (CASE WHEN VI.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId1} 
		       		       THEN (SELECT SUBSTRING(ISNULL(MIN(MC.MATERIAL_NAME), '),1,20)
			 		       FROM RMSPLUS.TB_COM_MIX_MATERIAL_INFO MM WITH(NOLOCK)
			 		      INNER JOIN RMSPLUS.TB_COM_MIX_MATERIAL_CODE_MST MC WITH(NOLOCK)
			 		         ON (MC.MATERIAL_ID = MM.MATERIAL_ID)
			 		      WHERE MM.FACILITY_CODE = #{facilityCode}
			 		        AND MM.EQUIPMENT_ID = #{equipmentId}
					        AND MM.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
					        AND MM.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
					        AND MM.PARAMETER_ID = VI.PARAMETER_ID)   
			 		       WHEN VI.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId2} 
			 		        AND #{gradeCode} = 'F' 
			 		        AND ISNULL(RV.TARGET_VALUE,') <> '
			 		       THEN CONVERT(NVARCHAR, ROUND(CONVERT(FLOAT,ISNULL(RV.TARGET_VALUE,')) * #{batchSize}/100,2))
			 		       ELSE RV.TARGET_VALUE
					       END),      
	        VI.USL_VALUE = (CASE WHEN VI.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId2} 
	                         AND #{gradeCode} ='F' 
	                         AND RV.USL_VALUE IS NOT NULL 
	                        THEN CONVERT(NVARCHAR, ROUND(CONVERT(FLOAT,ISNULL(RV.USL_VALUE,'0')) * #{batchSize}/100,2)) 
	                        ELSE RV.USL_VALUE 
	                        END) 
		   FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO VI
		  INNER JOIN RMSPLUS.TB_RMS_VALIDATION_INFO VA WITH(NOLOCK)
		     ON (VA.FACILITY_CODE = VI.FACILITY_CODE 
		         AND VA.VALIDATION_SEQ_NO = VI.VALIDATION_SEQ_NO)
		  INNER JOIN RMSPLUS.TB_RMS_RECIPE_VERSION_INFO RV WITH(NOLOCK) 
		     ON (RV.FACILITY_CODE = VI.FACILITY_CODE 
		         AND RV.RECIPE_ID = VI.RECIPE_ID 
		         AND RV.RECIPE_VERSION = VI.RECIPE_VERSION 
		         AND RV.PARAMETER_ID = VI.PARAMETER_ID)
		  WHERE VI.FACILITY_CODE = #{facilityCode}
		    AND VI.VALIDATION_SEQ_NO = #{validationSeqNo} 
			AND VA.EQUIPMENT_ID = #{equipmentId}
			AND RV.RECIPE_ID = #{recipeId}
			AND RV.RECIPE_VERSION = #{recipeVersion}

]]>"
sqlserver_update_TB_RMS_VALIDATION_ITEM_INFO_cust,2,"<![CDATA[
	
	UPDATE DH
	   SET VALIDATION_RESULT_CODE = RMSPLUS.FN_GET_STRCMP(REPLACE(REPLACE(REPLACE(ISNULL(DH.EQUIPMENT_VALUE, ''), '_', ''), '-', ''), ' ', ''),
               REPLACE(REPLACE(REPLACE(ISNULL((
               SELECT DT.MTRL_NAME
		 FROM (SELECT (CASE WHEN ISNULL(DT.REP_MTRL_NAME,'') = '' 
			            THEN ISNULL(DT.MTRL_NAME, '')  
			            ELSE ISNULL(DT.MTRL_NAME, '') +', ' + ISNULL(DT.REP_MTRL_NAME,'') 
			            END) AS MTRL_NAME       
		         FROM (SELECT ISNULL(MC.MATERIAL_NAME, '') AS MTRL_NAME,
				      RMSPLUS.FN_GET_ALTERNATIVE_MTRL_NAME(#{basicLang}, 
				                                           MM.FACILITY_CODE, 
				                                           MM.EQUIPMENT_ID, 
				                                           MM.PRODUCT_SPECIFICATION_ID, 
				                                           MM.PRODUCT_SPECIFICATION_VERSION, 
				                                           MM.PARAMETER_ID,'MATERIAL_NAME') AS REP_MTRL_NAME 
			        FROM RMSPLUS.TB_COM_MIX_MATERIAL_INFO MM WITH(NOLOCK)
			        LEFT OUTER JOIN RMSPLUS.TB_COM_MIX_MATERIAL_CODE_MST MC WITH(NOLOCK) 
				  ON (MC.MATERIAL_ID = MM.MATERIAL_ID)
			       WHERE MM.FACILITY_CODE = #{facilityCode}
			         AND MM.EQUIPMENT_ID      = #{equipmentId}
				 AND MM.PRODUCT_SPECIFICATION_ID = #{productSpecificationId}
				 AND MM.PRODUCT_SPECIFICATION_VERSION = #{productSpecificationVersion}
			         AND MM.PARAMETER_ID       = DH.PARAMETER_ID ) DT ) DT ), ''), '_', ''), '-', ''), ' ', '')) 
		 FROM RMSPLUS.TB_RMS_VALIDATION_ITEM_INFO DH WITH(NOLOCK) 
		WHERE DH.FACILITY_CODE = #{facilityCode}
		  AND DH.VALIDATION_SEQ_NO = #{validationSeqNo}
		  AND DH.EQUIPMENT_ID = #{equipmentId} 
		  AND DH.EQUIPMENT_PARAMETER_ID LIKE #{equipmentParameterId} --?ë£Œëª?		  AND DH.USE_FLAG ='Y' -- ?¬ìš©?¬ë?ê°€ 'N'??ê±´ì— ?€?´ì„œ??ë¬´ì¡°ê±?'0:OK' ë¡??´ë ¤ ì¤?

]]>"
